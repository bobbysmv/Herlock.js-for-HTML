function checkGlError(){}(function(){var t=[];t.register=function(t){t.id=this.push(t)-1},t.has=function(t){return-1!==this.indexOf(t)},t.getById=function(t){return this[t]};var e=function(){this.id=-1,this.parent=null,this.isExternal=!1,Object.defineProperties(this,{root:{get:function(){return this.isExternal?this:this.parent.root}}}),t.register(this)};e.prototype={},e.prototype.getPrototypeObject=function(){return{}};var i=function(t){e.call(this),this.isExternal=!0,this.externalClassConstructor=t};i.prototype=Object.create(e.prototype),i.prototype.getProto=function(){var t=Object.create(this.externalClassConstructor.prototype,{constructor:{value:this.externalClassConstructor}});return t};var n=function(){e.call(this),this.isExternal=!1,this._implementation=null};n.prototype=new e,n.prototype.getProto=function(){return this._proto},n.prototype.inherit=function(e){this.parent=e.id&&t.getById(e.id)?t.getById(e.id):new i(e),this._inheritList=[];for(var n=this;n;)this._inheritList.unshift(n),n=n.parent},n.prototype.implement=function(t){this._implementation=t;var e=this.parent.getProto(),i={};try{this._implementation(i,e)}catch(n){throw n}var r={},s={};for(var o in i){var a=i[o];"function"==typeof a?r[o]=a:a&&a.get&&"function"==typeof a.get?(a.configurable="configurable"in a?a.configurable:!0,a.enumerable="enumerable"in a?a.enumerable:!0,Object.defineProperty(r,o,a)):s[o]=a}var h=this.parent&&this.parent.setupProperties?this.parent.setupProperties:function(){};this.setupProperties=function(){h.call(this);for(var t in s){var e=s[t];this[t]=e}},r.__proto__=e,this._proto=r,this.constructor=r.constructor},n.prototype.fix=function(){function t(t){if(1!="id"in t)throw Error("ERROR: "+this+".isInstanceOf( "+t+" );");return-1!==r.indexOf(t.id)}function e(){var t=arguments;i.setupProperties.call(this),i.constructor.apply(this,t)}var i=this,n=this._inheritList,r=[];return n.forEach(function(t){r.push(t.id)}),e.prototype=i.getProto(),e.prototype.isInstanceOf=t,e.id=i.id,e};var r=function(){var t=null,e=null;arguments.length>1?(t=arguments[0]||{},e=arguments[1]):(t=Object,e=arguments[0]);var i=new n;return this._id=i.id,i.inherit(t),i.implement(e),i.fix()};"function"==typeof herlock.define&&herlock.define.amd&&herlock.define("lib/Class",[],function(){return r})})(),herlock.define("module/NJModule",["lib/Class"],function(t){var e=t(Object,function(t){t.constructor=function(){this._njs=null},t.getName=function(){return"Abstract"},t.onRegisterTo=function(t){this._njs=t},t.installTo=function(){},t.initJs=function(){},t.start=function(){},t.reset=function(){},t.pause=function(){},t.resume=function(){},t.destroy=function(){}});return e}),herlock.define("module/common/event/Event",["lib/Class"],function(){var t=function(e,i,n){this._type=e||"event",this._bubbles=arguments.length>1?i:!1,this._cancelable=arguments.length>2?n:!1,this._defaultPrevented=!1,this._eventPhase=t.NONE,this._currentTarget=null,this._target=null,this._timeStamp=Date.now(),this._propagationStopped=!1,this._immediatePropagationStopped=!1};return t.prototype=Object.create({},{bubbles:{get:function(){return this._bubbles}},cancelable:{get:function(){return this._cancelable}},currentTarget:{get:function(){return this._currentTarget}},defaultPrevented:{get:function(){return this._defaultPrevented}},eventPhase:{get:function(){return this._eventPhase}},target:{get:function(){return this._target}},timeStamp:{get:function(){return this._timeStamp}},type:{get:function(){return this._type}},preventDefault:{value:function(){this._defaultPrevented=!0},writable:!0},stopImmediatePropagation:{value:function(){this._propagationStopped=!0,this._immediatePropagationStopped=!0},writable:!0},stopPropagation:{value:function(){this._propagationStopped=!0},writable:!0},_setEventPhase:{value:function(t){this._eventPhase=t},writable:!0},_setCurrentTarget:{value:function(t){this._currentTarget=t},writable:!0},_setTarget:{value:function(t){this._target=t},writable:!0},_getDefaultPrevented:{value:function(){return this._defaultPrevented},writable:!0},_isPropagationStopped:{value:function(){return this._propagationStopped},writable:!0},_isImmediatePropagationStopped:{value:function(){return this._immediatePropagationStopped},writable:!0},_onPropagate:{value:function(){},writable:!0}}),t.NONE=1,t.CAPTURING_PHASE=1,t.AT_TARGET=2,t.BUBBLING_PHASE=3,t}),herlock.define("module/common/event/EventDispatcher",["lib/Class","./Event"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._dictionary={}},t.addEventListener=function(t,e,i){i=!!i,this._dictionary[t]||(this._dictionary[t]=[]),this._dictionary[t].push({func:e,useCapture:i})},t.removeEventListener=function(t,e,i){if(i=!!i,this._dictionary[t])for(var n=this._dictionary[t],r=n.length-1;r>=0;r--)if(n[r].func===e&&n[r].useCapture===i)return n.splice(r,1),void 0},t.dispatchEvent=function(t){t._setEventPhase(Event.AT_TARGET),this._setEventTarget(t),this._setEventCurrentTarget(t),this._callListeners(t)},t.removeAllEventListeners=function(){this._dictionary={}},t._hasEventListener=function(t){var e=this._dictionary[t];return e?0>=e.length?!1:!0:!1},t._propagateEvent=function(t,e){var i=e.length;t._setTarget(this),t._setEventPhase(Event.CAPTURING_PHASE);for(var n=0;i-1>n;n++){var r=e[n];if(r._setEventCurrentTarget(t),t._onPropagate(e,n),r._callListeners(t,!0,r),t._isPropagationStopped())return}t._setEventPhase(Event.AT_TARGET);var r=e[i-1];if(r._setEventCurrentTarget(t),t._onPropagate(e,i-1),r._callListeners(t,!1,r),!t._isPropagationStopped()&&1==t.bubbles){t._setEventPhase(Event.BUBBLING_PHASE);for(var n=i-2;n>=0;n--){var r=e[n];if(r._setEventCurrentTarget(t),t._onPropagate(e,n),r._callListeners(t,!1,r),t._isPropagationStopped())return}}},t._callHandler=function(t,e){this[t]&&this[t](e)},t._dispatchEventAndCallHandler=function(t){this.dispatchEvent(t),this._callHandler("on"+t.type,t)},t._callListeners=function(t,e,i){var n=arguments.length;e=n>1?e:!1,i=n>2?i:this;var r=this._dictionary[t.type];if(r)for(var s=0;r.length>s;s++){var o=r[s];if(o&&(t.eventPhase==Event.AT_TARGET||!t.bubbles||o.useCapture==e)&&(o.func.call(i,t),t._isImmediatePropagationStopped()))break}},t._setEventTarget=function(t){t._setTarget(this)},t._setEventCurrentTarget=function(t){t._setCurrentTarget(this)},t._numListeners=function(t){return this._dictionary[t]?this._dictionary[t].length:0}});return e}),herlock.define("module/common/NJCommon",["lib/Class","module/NJModule","module/common/event/Event","module/common/event/EventDispatcher"],function(t,e,i,n){var r=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.installTo=function(t){t.Event=i,t.EventDispatcher=n}});return r}),herlock.define("NativeJS",["lib/Class","module/common/NJCommon"],function(Class,NJCommon){window.__herlock_ctx=null;var NativeJS=Class(Object,function(cls,parent){var State={BUILD:{},READY:{},RUNNING:{},PAUSED:{},DESTROYED:{}};cls.constructor=function(){this._currentContext=null,this._state=State.BUILD,this._modules=[],this.registerModule(new NJCommon)},cls.getState=function(){return this._state},cls.executeScript=function(t){this.evaluateScript(t,null)},cls.evaluateScript=function(script,callback){var self=this;setTimeout(function(){if((self._state==State.BUILD||self._state==State.READY)&&self._start(),self._state==State.RUNNING){window.__herlock_ctx=self;var result=eval("with( window.__herlock_ctx._currentContext ){"+script+"}");null!=callback&&callback(result)}},0)},cls.loadURL=function(t){console.log("loadURL with NJScript"),this._rootPath=t.substr(0,t.lastIndexOf("/")+1),this.executeScript("(function(){\n	var script = new Script();\n	script.onerror=function(){ console.log('load error '+script); application.sendMessage('type=error'); }\n	script.onabort=function(){ console.log('load abort '+script); }\n	script.onload=function(){\n		console.log('load complete '+script); \n	}\n	script.src = '"+t.substr(t.lastIndexOf("/")+1)+"';"+"})();")},cls.reload=function(){null!=getModuleByName("Location")&&(DebugUtil.log("loadURL with NJLocation"),executeScript("location.reload();"))},cls.registerModule=function(t){this._state==State.BUILD&&(this._modules.push(t),t.onRegisterTo(this))},cls.getModuleByName=function(t){for(var e=this._modules.length,i=0;e>i;i++)if(this._modules[i].getName()===t)return this._modules[i];return null},cls._build=function(){this._state==State.BUILD&&(this._state=State.READY)},cls.reset=function(){var t=this;setTimeout(function(){t._reset()},0)},cls._reset=function(){if(this._state!=State.BUILD){console.log("NativeJS::reset");for(var t=this._modules.length,e=0;t>e;e++){var i=this._modules[e];i.reset()}this._currentContext=null,this._state=State.READY}},cls.start=function(){var t=this;setTimeout(function(){t._start()},0)},cls._start=function(){if(this._state!=State.RUNNING&&this._state!=State.PAUSED){console.log("NativeJS::start"),this._state==State.BUILD&&this._build(),console.log("NativeJS::build"),this._currentContext=new NativeJS.JSContext(0),console.log("NativeJS::CreateJSContext");for(var t=this._modules.length,e=0;t>e;e++){var i=this._modules[e];i.installTo(window)}console.log("NativeJS::install modules"),console.log("NativeJS::BuildJSContext");for(var e=0;t>e;e++){var i=this._modules[e];i.initJs(window)}console.log("NativeJS::initJs modules");for(var e=0;t>e;e++){var i=this._modules[e];i.start()}console.log("NativeJS::start modules"),this._state=State.RUNNING}},cls.pause=function(){var t=this;setTimeout(function(){t._pause()},0)},cls._pause=function(){if(this._state==State.RUNNING){for(var t=this._modules.length,e=0;t>e;e++){var i=this._modules[e];i.pause()}this._state=State.PAUSED}},cls.resume=function(){setTimeout(function(){this._resume()},0)},cls._resume=function(){if(this._state==State.PAUSED){for(var t=this._modules.length,e=0;t>e;e++){var i=this._modules[e];i.resume()}this._state=State.RUNNING}},cls.destroy=function(){var t=this;setTimeout(function(){t._destroy()},0)},cls._destroy=function(){if(this._state!=State.DESTROYED){for(var t=this._modules.length,e=0;t>e;e++){var i=this._modules[e];i.destroy()}this._state=State.DESTROYED}},cls._rootPath=""});return NativeJS.JSContext=Class(function(t){t.constructor=function(t){this._nativePtr=t},t.getNativePtr=function(){return this._nativePtr}}),NativeJS}),herlock.define("lib/URL",[],function(){var t=function(t){this._protocol=null,this._hostname=null,this._port=null,this._pathname=null,this._search=null,this._hash=null;var e;if(e=t.indexOf("#"),-1!==e&&(this._hash=t.substr(e+1),t=t.substr(0,e)),e=t.indexOf("?"),-1!==e&&(this._search=t.substr(e+1),t=t.substr(0,e)),e=t.indexOf("://"),-1===e)return this._pathname=t,void 0;if(this._protocol=t.substr(0,e),t=t.substr(e+3),e=t.indexOf("/"),-1===e)return this._hostname=t,void 0;var i=t.substr(0,e);this._pathname=t.substr(e),e=i.indexOf(":"),-1!==e&&(this._port=i.substr(e+1),i=i.substr(0,e)),this._hostname=i};return t.prototype=Object.create({},{hash:{get:function(){return this._hash?"#"+this._hash:""},set:function(t){-1!==t.indexOf("#")&&(t=t.split("#")[1]),this._hash=t}},host:{get:function(){return this._hostname?this._hostname+(this._port?":"+this._port:""):""},set:function(t){if(-1!==t.indexOf(":")){var e=t.split(":")[0];t=e[0],this._port=e[1]}this._hostname=t}},hostname:{get:function(){return this._hostname?this._hostname:""},set:function(t){this._hostname=t}},pathname:{get:function(){return this._pathname?this._pathname:""},set:function(t){this._pathname=t}},port:{get:function(){return this._port?this._port:""},set:function(t){this._port=t}},protocol:{get:function(){return this._protocol?this._protocol+":":""},set:function(t){this._protocol=t.split(":")[0]}},search:{get:function(){return this._search?this._search:""},set:function(t){this._search=t}},clone:{value:function(){return new t(""+this)}},toString:{value:function(){var t="";return this._protocol&&(t+=this._protocol+"://"),this._hostname&&(t+=this._hostname),this._port&&(t+=":"+this._port),this._pathname&&(t+=this._pathname),this._search&&(t+="?"+this._search),this._hash&&(t+="#"+this._hash),t}}}),t}),herlock.define("module/script/object/ScriptObject",["lib/Class","module/common/event/EventDispatcher","lib/URL"],function(t,e,i){var n=t(e,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._src="",t&&(this.src=t)},t.src={get:function(){return this._src},set:function(t){this._src=t;var e=new i(t);this._script&&document.head.removeChild(this._script),this._script=document.createElement("script"),document.head.appendChild(this._script);var n=window.__herlock_ctx,r=this;this._script.onload=function(){r.onload()},this._script.src=""===e.host?n._rootPath+e:""+e}}});return n}),herlock.define("module/script/NJScript",["lib/Class","module/NJModule","module/script/object/ScriptObject"],function(t,e,i){var n=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.getName=function(){return"Script"},t.installTo=function(){},t.initJs=function(t){t.Script=i},t.start=function(){e.start.call(this)},t.reset=function(){}});return n}),herlock.define("module/app/NJApp",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(t,e,i){var n=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._messageReciever=null,this._statusBarEnabled=!0,this._sleepModeEnabled=!0},t.installTo=function(t){t.App=r},t.initJs=function(t){t.app=new r(this)},t.reset=function(){},t.pause=function(){},t.resume=function(){},t.notifyEnterForeground=function(){},t.notifyEnterBackground=function(){},t.finish_native=function(){},t.setMessageReciever=function(t){this._messageReciever=t},t.sendMessage=function(){},t.sendMessage=function(){},t.recieveMessage_native=function(){},t.openURL_native=function(){},t.notifyHandleOpenURL=function(){},t.getLanguage_native=function(){},t.getStatusBarEnabled_native=function(){return this._statusBarEnabled},t.setStatusBarEnabled_native=function(t){this._statusBarEnabled!=t&&(this._statusBarEnabled=t)},t.getSleepModeEnabled_native=function(){return this._sleepModeEnabled},t.setSleepModeEnabled_native=function(t){this._sleepModeEnabled!=t&&(this._sleepModeEnabled=t)},t.getActiveNetworkName_native=function(){return null},t.getActiveNetwork_native=function(){return-1},t.getActiveNetworkIP_native=function(){},t.notifyHardwareButtonAction=function(){},t.getMemoryInfo_native=function(){return[0,0,0]},t.getMemoryInfo_native_bk=function(){return[0,0,0]},t.getTotalMemorySize=function(){return 0},t.setClipboardText_native=function(){},t.getVersion_native=function(){},t.getBuildVersion_native=function(){},t.setScreenOrientation=function(t){console.log("deprecated. app.setScreenOrientation => window.setOrientationType"),window.setOrientationType&&window.setOrientationType(t)}}),r=t(i,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._module=t},t.statusBarEnabled={get:function(){return this._module.getStatusBarEnabled_native()},set:function(t){this._module.setStatusBarEnabled_native(t)}},t.sleepModeEnabled={get:function(){return!0},set:function(){}},t.activeNetwork={get:function(){return null}},t.activeNetworkIP={get:function(){return null}},t.language={get:function(){return navigator.language}},t.isIOS={get:function(){return!1}},t.isANDROID={get:function(){return!1}},t.isWeb={get:function(){return!0}},t.version={get:function(){return 1}},t.buildVersion={get:function(){return 1}},t.memory=function(){},t.nativeLog=function(){},t.sendMessage=function(){},t.gc=function(){},t.openURL=function(t){var e=document.createElement("a");e.href=t,e.target="_blank",document.head.appendChild(e),e.click()},t.setClipboardText=function(){console.warn("not supported.")},t.getLatestSchemeURLOnce=function(){},t.getLatestNotificationDataOnce=function(){},t.setScreenOrientation=function(t){this._module.setScreenOrientation(t)}});return n}),herlock.define("module/location/NJLocation",["lib/Class","lib/URL","module/NJModule","module/common/event/EventDispatcher"],function(t,e,i,n){var r=t(i,function(t,i){t.constructor=function(){i.constructor.apply(this,arguments)},t.getName=function(){return"Location"},t.installTo=function(t){t.Location=s},t.initJs=function(t){var e=new s(this);t.location._assign=function(){e._assign()}},t.reset=function(){},t.assign_native=function(t){console.log("NJLocation::assign_native");var i=this;setTimeout(function(){console.log("NJLocation::Starter::run");var n=i._njs;n.reset(),n.start(),setTimeout(function(){var i=new e(t),r="";r=""!==i.host?i.protocol+"//"+i.host+i.pathname:location.protocol+"//"+location.host+location.pathname+i.pathname,n._rootPath=r.substr(0,r.lastIndexOf("/")+1),n.executeScript('(function(){\n	var bootstrap = new Script();\n	bootstrap.onerror = function(e){   app.nativeLog(""+e); app.sendMessage(""+e);   setTimeout( function(){ location._assign(); }, 2000 );}\n	bootstrap.onabort = function(){}\n	bootstrap.onload = function(){}\n	bootstrap.src = \''+r.substr(r.lastIndexOf("/"))+"';"+"})();")},0)},0)}}),s=t(n,function(t,i){t.constructor=function(t){i.constructor.call(this),this._module=t,this._url=new e("")},t._assign=function(t){this._module.assign_native(t)},t.assign=function(t){this._module.assign_native(t)},t.reload=function(){this.assign(""+this._url)},t.replace=function(){},t.hash={get:function(){return this._url.hash},set:function(t){this._url.hash=t}},t.host={get:function(){return this._url.host},set:function(t){this._url.host=t,this.reload()}},t.hostname={get:function(){return this._url.hostname},set:function(t){this._url.hostname=t,this.reload()}},t.href={get:function(){return""+this._url},set:function(t){this._url=new e(t),this.reload()}},t.pathname={get:function(){return this._url.pathname},set:function(t){this._url.pathname=t,this.reload()}},t.port={get:function(){return this._url.port},set:function(t){this._url.port=t,this.reload()}},t.protocol={get:function(){return this._url.protocol},set:function(t){this._url.protocol=t,this.reload()}},t.search={get:function(){return this._url.search},set:function(t){this._url.search=t,this.reload()}}});return r}),herlock.define("module/view/window/window",[],function(){var t={installTo:function(t,e){t.addLayer=function(t){return e.addLayer(t)},t.addLayerAt=function(t,i){return e.addLayer(t,i)},t.getLayerAt=function(t){return e.getLayerAt(t)},t.getLayerIndex=function(t){return e.getLayerIndex(t)},t.removeLayer=function(t){return e.removeLayer(t)},t.removeLayerAt=function(t){return e.removeLayerAt(t)},t.innerWidth=e.getViewWidth();try{Object.defineProperties(t,{innerWidth:{get:function(){return e.getViewWidth()}},innerHeight:{get:function(){return e.getViewHeight()}}})}catch(i){console.log("SafariはinnerWidth,innerHeightが更新できません。"),t.innerWidth=e.getViewWidth(),t.innerHeight=e.getViewHeight()}t.setOrientationType=function(){};var n=onerror;onerror=function(e,i,r,s,o){t.onUncaughtError?t.onUncaughtError(o):n(o)}},initJs:function(){}};return t}),herlock.define("module/view/gl/IRenderable",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.processData=function(){},t.renderOffscreen=function(){},t.render=function(){}});return e}),herlock.define("module/view/gl/Viewport",["lib/Class"],function(t){var e=t(Object,function(t,i){t.constructor=function(t,n,r,s,o){i.constructor.apply(this,arguments),this._x=t,this._y=n,this._w=r,this._h=s,o&&(e._current=this)},t.enable=function(){(null==e._current||1!=e._current.equals(this._x,this._y,this._w,this._h))&&(gl.viewport(this._x,this._y,this._w,this._h),checkGlError("glViewport")),e._current=this},t.equals=function(t,e,i,n){return this._x==t&&this._y==e&&this._w==i&&this._h==n}}),i=new function(){var t=[];this.push=function(e){t.push(e),e.enable()},this.pop=function(){t.pop(),t.length>0&&t[t.length-1].enable()}};e._current=null;var n={unbind:function(){i.pop()}};return e.BindScope=function(t){return i.push(t),n},e.getX=function(){return null==this._current?0:this._current._x},e.getY=function(){return null==this._current?0:this._current._y},e.getWidth=function(){return null==this._current?0:this._current._w},e.getHeight=function(){return null==this._current?0:this._current._h},e}),herlock.define("module/view/touch/TouchEventInfo",["lib/Class"],function(t){var e=t(Object,function(t,i){t.constructor=function(t){i.constructor.apply(this,arguments),this._action=t,this._pointers={}},t.getAction=function(){return this._action},t.addTouchPoint=function(t,i,n,r,s){this._pointers[t]=e.Pointer.create(t,i,n,r,s)},t.getChangedPointers=function(){var t=[];for(var e in this._pointers)this._pointers[e].isChanged&&t.push(this._pointers[e]);return t},t.getPointersOnScreen=function(){var t=[];for(var e in this._pointers)this._pointers[e].isOnScreen&&t.push(this._pointers[e]);return t}});return e.Pointer={create:function(t,e,i,n,r){return{id:t,x:e,y:i,isChanged:n,isOnScreen:r}}},e.NONE=0,e.DOWN=1,e.MOVE=2,e.UP=3,e.CANCEL=4,e}),herlock.define("module/view/layer/Layer",["lib/Class","module/view/gl/IRenderable","module/view/gl/Viewport","module/view/touch/TouchEventInfo"],function(t,e,i){var n=t(Object,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._content=null,this._renderingObject=new r,this._calcRequested=!0,this._horizontalAlign=n.Align.CENTER,this._verticalAlign=n.Align.MIDDLE,this._scaleMode=n.ScaleMode.SHOW_ALL,this._colorTransform=new ColorTransform,this._backgroundColor=16777215,this._backgroundAlpha=0,this._offsetPercentX=0,this._offsetPercentY=0,this._module=null,this._matrix=new Matrix,this._contentMatrix=new Matrix,this._contentDisplayRect=new Rectangle,t&&(this.content=t)},t.content={get:function(){return this._content},set:function(t){null!=this._content&&this._content._onRemovedFrom(this),this._calcRequested=!0,this._content=t,null!=t&&this._content._onAddedTo(this)}},t.contentScaleX={get:function(){return this._getContentMatrix()._getScaleX()}},t.contentScaleY={get:function(){return this._getContentMatrix()._getScaleY()}},t.horizontalAlign={get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign=t,this._calcRequested=!0}},t.verticalAlign={get:function(){return this._verticalAlign},set:function(t){this._verticalAlign=t,this._calcRequested=!0}},t.scaleMode={get:function(){return this._scaleMode},set:function(t){this._scaleMode=t,this._calcRequested=!0}},t.offsetX={get:function(){return this._offsetPercentX},set:function(t){this._offsetPercentX=t,this._calcRequested=!0}},t.offsetY={get:function(){return this._offsetPercentY},set:function(t){this._offsetPercentY=t,this._calcRequested=!0}},t.alpha={get:function(){return this._colorTransform.getAlphaMultiplier()},set:function(t){this._colorTransform.getAlphaMultiplier(t)}},t.backgroundColor={get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t}},t.backgroundAlpha={get:function(){return this._backgroundAlpha},set:function(t){this._backgroundAlpha=t}},t._notifyDrawFrame=function(){this._content&&this._content._notifyDrawFrame()},t._addedTo=function(t){this._module=t,calcRequested=!0},t._removedFrom=function(){this._module=null},t._notifyResizeView=function(t,e){null!=this._content&&this._content._notifyResizeView(t,e),this._calcRequested=!0},t._notifyResizeContent=function(){this._calcRequested=!0},t._notifyTouch=function(t){this._content&&this._content._dispatchTouchEvent(t)},t._calculate=function(){if(null!=this._module&&null!=this._content){this._calcRequested=!1;var t=this._module.getViewWidth(),e=this._module.getViewHeight(),i=t/e,r=this._content._getContentWidth(),s=this._content._getContentHeight(),o=r/s;if(this._scaleMode==n.ScaleMode.EXACT_FIT)this._contentMatrix._setScaleX(t/r),this._contentMatrix._setScaleY(e/s);else if(this._scaleMode==n.ScaleMode.SHOW_ALL){var a;a=o>i?t/r:e/s,this._contentMatrix._setScaleX(a),this._contentMatrix._setScaleY(a)}else if(this._scaleMode==n.ScaleMode.NO_BORDER){var a;a=i>o?t/r:e/s,this._contentMatrix._setScaleX(a),this._contentMatrix._setScaleY(a)}else this._scaleMode==n.ScaleMode.NO_SCALE&&(this._contentMatrix._setScaleX(1),this._contentMatrix._setScaleY(1));this._matrix._setX(t*this._offsetPercentX),this._matrix._setY(e*this._offsetPercentY),this._contentDisplayRect.width=this._content._getContentWidth()*this._contentMatrix._getScaleX(),this._contentDisplayRect.height=this._content._getContentHeight()*this._contentMatrix._getScaleY(),this._contentDisplayRect.x=this._matrix._getX(),this._contentDisplayRect.y=this._matrix._getY();var h=0,l=0;this._horizontalAlign==n.Align.LEFT?h+=0:this._horizontalAlign==n.Align.CENTER?h+=.5*(t-this._contentDisplayRect.width):this._horizontalAlign==n.Align.RIGHT&&(h+=1*(t-this._contentDisplayRect.width)),this._verticalAlign==n.Align.TOP?l+=0:this._verticalAlign==n.Align.MIDDLE?l+=.5*(e-this._contentDisplayRect.height):this._verticalAlign==n.Align.BOTTOM&&(l+=1*(e-this._contentDisplayRect.height)),this._contentDisplayRect.x+=h,this._contentDisplayRect.y+=l,this._contentMatrix._setX(h),this._contentMatrix._setY(l)}},t._getMatrix=function(){return this._calcRequested&&this._calculate(),this._matrix.clone()},t._getContentMatrix=function(){return this._calcRequested&&this._calculate(),this._contentMatrix.clone()},t._getContentDisplayRect=function(){return this._calcRequested&&this._calculate(),this._contentDisplayRect},t._glPrepare=function(){if(null==this._module)return null;if(null==this._content)return null;this._renderingObject.viewport=new i(0,0,this._module.getViewWidth(),this._module.getViewHeight());var t=i.BindScope(this._renderingObject.viewport),e=new Matrix;return this._renderingObject.contentRenderingObject=this._content._glPrepare(e,this._colorTransform),t.unbind(),this._renderingObject}});n.Align={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",LEFT:"left",CENTER:"center",RIGHT:"right",NONE:"none"},n.ScaleMode={EXACT_FIT:"exactFit",NO_BORDER:"noBorder",NO_SCALE:"noScale",SHOW_ALL:"showAll",MODE_NONE:"none"};var r=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.viewport=null,t.contentRenderingObject=null,t.processData=function(){if(this.contentRenderingObject){var t=i.BindScope(this.viewport);this.contentRenderingObject.processData(),t.unbind()}},t.renderOffscreen=function(){},t.render=function(){if(this.contentRenderingObject){var t=i.BindScope(this.viewport);this.contentRenderingObject.render(),t.unbind()}}});return n}),herlock.define("module/graphics/CanvasProxy",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(t){if(e.constructor.apply(this,arguments),this._bitmapProxy=t,this._bitmapProxy._imageElm){var i=this._bitmapProxy._imageElm;this._bitmapProxy._imageElm=null;var n=this._bitmapProxy._canvasElm=document.createElement("canvas");n.width=i.naturalWidth,n.height=i.naturalHeight,n.getContext("2d").drawImage(i,0,0)}this._ctx=this._bitmapProxy._canvasElm.getContext("2d"),this._fontSize=12,this._letterSpacing=0},t._updateFont=function(){this._ctx.font=""+this._fontSize+"px/18px sans-serif",this._metrics=null},t.fillStyle="#ffffff",t.strokeStyle="#000000",t.setFillColor=function(t){var e=[255&t>>>16,255&t>>>8,255&t>>>0,(255&t>>>24)/255];this._ctx.fillStyle="rgba("+e.join(",")+")"},t.setStrokeColor=function(t){var e=[255&t>>>16,255&t>>>8,255&t>>>0,(255&t>>>24)/255];this._ctx.strokeStyle="rgba("+e.join(",")+")"},t.fillRect=function(t,e,i,n){this._ctx.fillRect(t,e,i,n)},t.strokeRect=function(t,e,i,n){this._ctx.strokeRect(t,e,i,n)},t.getFontSize=function(){return this._fontSize},t.setFontSize=function(t){this._fontSize=t,this._updateFont()},t.getLetterSpacing=function(){return this._letterSpacing},t.setLetterSpacing=function(t){this._letterSpacing=t},t.getFontMetrics=function(){this._metrics||(this._metrics=this._ctx.getTextMetrics("Aあa　亜"));var t={};return t.ascent=this._metrics.ascent,t.descent=this._metrics.descent,t},t.fillText=function(t,e,i,n){this._ctx.textBaseline="top",n?this._ctx.fillText(i,t,e,n):this._ctx.fillText(i,t,e)},t.strokeText=function(){},t.measureText=function(t){var e=this._ctx.measureText(t,t.length).width,i=t.length;return i>0&&(e+=this._letterSpacing*(i-1)),e},t.breakText=function(t,e){if(e>=this._ctx.measureText(t).width)return t.length;for(var i=0;t.length>i;){var n=t.substring(0,i),r=this._ctx.measureText(n).width;if(r>e)break;i++}i--;var s=i;return s},t.clear=function(){this._ctx.clearRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())}});return e}),function(){var t=!1;if(!document.defaultView.getComputedStyle)throw"ERROR: 'document.defaultView.getComputedStyle' not found. This library only works in browsers that can report computed CSS values.";CanvasRenderingContext2D.prototype.measureTextWidth=CanvasRenderingContext2D.prototype.measureText;var e=function(t,e){return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},i=function(t,e,i,n,r,s){document.body.appendChild(t),e.strokeStyle="rgba(0, 0, 0, 0.5)",e.beginPath(),e.moveTo(i,0),e.lineTo(i,r),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(i+s.bounds.maxx,0),e.lineTo(i+s.bounds.maxx,r),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(0,r/2-s.ascent),e.lineTo(n,r/2-s.ascent),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(0,r/2+s.descent),e.lineTo(n,r/2+s.descent),e.closePath(),e.stroke()};CanvasRenderingContext2D.prototype.getTextMetrics=function(n){var r=this.measureTextWidth(n),s=document.createElement("canvas"),o=100;s.style.opacity=1,s.style.font=this.font;var a=s.style.fontFamily,h=s.style.fontSize.replace("px","");s.width=r.width+o,s.height=3*h,r.fontsize=h;var l=s.getContext("2d");l.font=h+"px "+a;var c=document.createElement("div");c.style.position="absolute",c.style.opacity=0,c.style.font=h+"px "+a,c.innerHTML=n+"<br/>"+n,document.body.appendChild(c);var u=s.width,_=s.height,f=_/2;l.fillStyle="white",l.fillRect(-1,-1,u+2,_+2),l.fillStyle="black",l.fillText(n,o/2,f);for(var d=l.getImageData(0,0,u,_).data,g=0,m=4*u,p=d.length;p>++g&&255===d[g];);var v=0|g/m;for(g=p-1;--g>0&&255===d[g];);var x=0|g/m;for(g=0;p>g&&255===d[g];)g+=m,g>=p&&(g=g-p+4);var w=0|g%m/4,b=1;for(g=p-3;g>=0&&255===d[g];)g-=m,0>g&&(g=p-3-4*b++);var y=0|g%m/4+1;r.ascent=v-f,r.descent=x-f,r.bounds={minx:w-o/2,maxx:y-o/2,miny:0,maxy:x-v},r.height=1+(x-v),r.leading=1.2*h;var T=e(c,"height");return T=T.replace("px",""),T>=2*h&&(r.leading=0|T/2),document.body.removeChild(c),t&&i(s,l,50,u,_,r),r}}(),herlock.define("module/graphics/BitmapProxy",["lib/Class","./CanvasProxy"],function(t,e){var i=t(Object,function(t,i){t.constructor=function(){i.constructor.apply(this,arguments);var t=arguments,e=arguments.length;return 1==e&&t[0]instanceof HTMLImageElement?(this._imageElm=t[0],void 0):(this._canvasElm=document.createElement("canvas"),this._canvasElm.width=e>0?t[0]:100,this._canvasElm.height=e>1?t[1]:100,void 0)},t.getCanvas=function(){return null==this._canvas&&(this._canvas=new e(this)),this._canvas},t.getPixels=function(){return this._imageElm?this._imageElm:this._canvasElm},t.getData=function(){for(var t=this.getCanvas()._ctx,e=t.getImageData(0,0,this.width(),this.height()).data,i=new Uint8Array(4*this.width()*this.height()),n=4*this.width()*this.height()-1;n>=0;n--)i[n]=e[n];return i},t.width=function(){return this._imageElm?this._imageElm.naturalWidth:this._canvasElm.width},t.height=function(){return this._imageElm?this._imageElm.naturalHeight:this._canvasElm.height},t.clone=function(){}});return i.create=function(t,e){return new i(t,e)},i}),herlock.define("module/view/image/Image",["lib/Class","module/common/event/EventDispatcher","lib/URL","module/graphics/BitmapProxy"],function(t,e,i,n){var r=t(e,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._src="",this._bitmapProxy=null,t&&(this.src=t)},t.src={get:function(){this._src},set:function(t){this._src=t;var e=new i(t);this._image=null;var r=document.createElement("img"),s=window.__herlock_ctx,o=this;r.onload=function(){o._image=r,o._bitmapProxy=new n(o._image),o._dispatchEventAndCallHandler(new Event("load"))},r.src=""===e.host?s._rootPath+e:""+e
}},t.complete={get:function(){}},t.width={get:function(){return this._image?this._image.width:0}},t.height={get:function(){return this._image?this._image.height:0}},t.naturalWidth={get:function(){return this._image?this._image.width:0}},t.naturalHeight={get:function(){return this._image?this._image.height:0}},t.onload=function(){},t.onerror=function(){},t._getBitmap=function(){return this._bitmapProxy}});return r}),herlock.define("module/view/flash/display/BlendMode",[],function(){var t={NORMAL:"normal",ADD:"add"};return t}),herlock.define("module/view/geom/Point",["lib/Class"],function(){var t=function(t,e){this.x=0,this.y=0,arguments.length>=1&&(this.x=t),arguments.length>=2&&(this.y=e)};return t.prototype=Object.create({},{add:{value:function(e){return new t(this.x+e.x,this.y+e.y)},writable:!0},subtract:{value:function(e){return new t(this.x-e.x,this.y-e.y)},writable:!0},clone:{value:function(){return new t(this.x,this.y)},writable:!0},equals:{value:function(t){return this.x===t.x&&this.y===t.y},writable:!0},normalize:{value:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);this.x=this.x/e*t,this.y=this.y/e*t},writable:!0},offset:{value:function(t){this.x+=t.x,this.y+=t.y},writable:!0},toString:{value:function(){return'[object Point x="'+this.x+'" y="'+this.y+'"]'},writable:!0}}),t}),herlock.define("module/view/geom/Rectangle",["lib/Class","./Point"],function(t,e){var i=function(){this.x=0,this.y=0,this.width=0,this.height=0;var t=arguments.length;t>0&&(this.x=arguments[0]),t>1&&(this.y=arguments[1]),t>2&&(this.width=arguments[2]),t>3&&(this.height=arguments[3])};return i.prototype=Object.create({},{top:{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t}},right:{get:function(){return this.x+this.width},set:function(t){this.width+=t-this.right}},bottom:{get:function(){return this.y+this.height},set:function(t){this.height+=t-this.bottom}},left:{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t}},topLeft:{get:function(){return new e(this.left,this.top)},set:function(t){this.left=t.x,this.top=t.y}},bottomRight:{get:function(){return new e(this.right,this.bottom)},set:function(t){this.right=t.x,this.bottom=t.y}},size:{get:function(){return new e(this.width,this.height)},set:function(t){this.width=t.x,this.height=t.y}},clone:{value:function(){return new i(this.x,this.y,this.width,this.height)},writable:!0},contains:{value:function(t,e){return t>=this.left&&this.right>=t&&e>=this.top&&this.bottom>=e},writable:!0},containsPoint:{value:function(t){return this.contains(t.x,t.y)},writable:!0},containsRect:{value:function(t){return this.top<=t.top&&t.bottom<=this.bottom&&this.left<=t.left&&t.right<=this.right},writable:!0},equals:{value:function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height},writable:!0},inflate:{value:function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},writable:!0},inflatePoint:{value:function(t){this.inflate(t.x,t.y)},writable:!0},intersects:{value:function(t){return this.top>t.bottom||this.left>t.right||this.right<t.left||this.bottom<t.top?!1:!0},writable:!0},intersection:{value:function(t){if(1!=this.intersects(t))return new i;var e,n,r,s;return e=this.top>t.top?this.top:t.top,n=this.right<t.right?this.right:t.right,r=this.bottom<t.bottom?this.bottom:t.bottom,s=this.left>t.left?this.left:t.left,new i(s,e,n-s,r-e)},writable:!0},isEmpty:{value:function(){return 0>=this.width||0>=this.height},writable:!0},offset:{value:function(t,e){this.x+=t,this.y+=e},writable:!0},offsetPoint:{value:function(t){this.offset(t.x,t.y)},writable:!0},setEmpty:{value:function(){this.x=0,this.y=0,this.width=0,this.height=0},writable:!0},union:{value:function(t){if(this.isEmpty()&&t.isEmpty())return new i;if(t.isEmpty())return this.clone();if(this.isEmpty())return t.clone();var e,n,r,s;return e=this.top<t.top?this.top:t.top,n=this.right>t.right?this.right:t.right,r=this.bottom>t.bottom?this.bottom:t.bottom,s=this.left<t.left?this.left:t.left,new i(s,e,n-s,r-e)},writable:!0},_set:{value:function(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n},writable:!0},toString:{value:function(){return'[object Rectangle x="'+this.x+'" y="'+this.y+'" width="'+this.width+'" height="'+this.height+'"]'},writable:!0}}),i}),herlock.define("module/view/geom/Matrix",["lib/Class","./Point","./Rectangle"],function(t,e,i){var n=Math.PI,r=function(t,e,i,n,r,s){var o,a=arguments.length;0===a?(o=this._values=[1,0,0,1,0,0],this._isInitialValue=!0):(o=this._values=[a>0?t:1,a>1?e:0,a>2?i:0,a>3?n:1,a>4?r:0,a>5?s:0],this._isInitialValue=1===o[0]&&0===o[1]&&0===o[2]&&1===o[3]&&0===o[4]&&0===o[5]),this._version=1e7*Math.random()<<0};return r.prototype=Object.create({},{a:{get:function(){return this._values[0]},set:function(t){this._values[0]=t,this._increment()}},b:{get:function(){return this._values[1]},set:function(t){this._values[1]=t,this._increment()}},c:{get:function(){return this._values[2]},set:function(t){this._values[2]=t,this._increment()}},d:{get:function(){return this._values[3]},set:function(t){this._values[3]=t,this._increment()}},tx:{get:function(){return this._values[4]},set:function(t){this._values[4]=t,this._increment()}},ty:{get:function(){return this._values[5]},set:function(t){this._values[5]=t,this._increment()}},_increment:{value:function(){this._version++,this._isInitialValue=!1},writable:!0},_getVersion:{value:function(){return this._version},writable:!0},isInitialValue:{value:function(){return this._isInitialValue},writable:!0},clone:{value:function(){var t=new r;return t._values=this._values.slice(),t._version=this._version,t._isInitialValue=this._isInitialValue,t},writable:!0},concat:{value:function(t){t.isInitialValue()||this._concat(t._values)},writable:!0},_concat:{value:function(t){if(this.isInitialValue())this._values=t;else{var e=this._values,i=t;this._values=[e[0]*i[0]+e[1]*i[2],e[0]*i[1]+e[1]*i[3],e[2]*i[0]+e[3]*i[2],e[2]*i[1]+e[3]*i[3],e[4]*i[0]+e[5]*i[2]+i[4],e[4]*i[1]+e[5]*i[3]+i[5]]}this._increment()},writable:!0},createBox:{value:function(){},writable:!0},createGradientBox:{value:function(){},writable:!0},deltaTransformPoint:{value:function(){},writable:!0},identity:{value:function(){this._values=[1,0,0,1,0,0],this._increment(),this._isInitialValue=!0},writable:!0},invert:{value:function(){var t=this.a*this.d-this.c*this.b;if(0!==t){var e=1/t,i=this.tx;this.tx=(this.c*this.ty-i*this.d)*e,this.ty=(i*this.b-this.a*this.ty)*e,this.c=-this.c*e,this.b=-this.b*e,i=this.a,this.a=this.d*e,this.d=i*e,this._increment()}},writable:!0},rotate:{value:function(t){var e=Math.cos(t),i=Math.sin(t);this._concat([e,i,-i,e,0,0])},writable:!0},scale:{value:function(t,e){this._concat([t,0,0,e,0,0])},writable:!0},transformPoint:{value:function(t){var i=this._values;return new e(t.x*i[0]+t.y*i[2]+1*i[4],t.x*i[1]+t.y*i[3]+1*i[5])},writable:!0},translate:{value:function(t,e){this._concat([1,0,0,1,t,e])},writable:!0},_getScaleX:{value:function(){return Math.sqrt(this.a*this.a+this.b*this.b)},writable:!0},_setScaleX:{value:function(t){this._increment();var e=this._getScaleX();if(0!==e){var i=t/e;this.a*=i,this.b*=i}else{var n=this._getSkewY_();this.a=Math.cos(n)*t,this.b=Math.sin(n)*t}},writable:!0},_getScaleY:{value:function(){return Math.sqrt(this.c*this.c+this.d*this.d)},writable:!0},_setScaleY:{value:function(t){this._increment();var e=this._getScaleY();if(0!==e){var i=t/e;this.c*=i,this.d*=i}else{var n=this._getSkewX_();this.c=-Math.sin(n)*t,this.d=Math.cos(n)*t}},writable:!0},_getSkewX:{value:function(){return this._getSkewX_()*(180/n)},writable:!0},_setSkewX:{value:function(t){this._setSkewX_(t*(n/180))},writable:!0},_getSkewY:{value:function(){return this._getSkewY_()*(180/n)},writable:!0},_setSkewY:{value:function(t){this._setSkewY_(t*(n/180))},writable:!0},_getRotation:{value:function(){return this._getSkewY_()*(180/n)},writable:!0},_setRotation:{value:function(t){this._setRotation_(t*(n/180))},writable:!0},_getX:{value:function(){return this.tx},writable:!0},_setX:{value:function(t){this.tx=t,this._increment()},writable:!0},_getY:{value:function(){return this.ty},writable:!0},_setY:{value:function(t){this.ty=t,this._increment()},writable:!0},_setRotation_:{value:function(t){var e=this._getSkewY_(),i=this._getSkewX_();this._setSkewX_(i+t-e),this._setSkewY_(t)},writable:!0},_getSkewX_:{value:function(){return Math.atan2(-this.c,this.d)},writable:!0},_setSkewX_:{value:function(t){var e=this._getScaleY();this.c=-e*Math.sin(t),this.d=e*Math.cos(t),this._increment()},writable:!0},_getSkewY_:{value:function(){return Math.atan2(this.b,this.a)},writable:!0},_setSkewY_:{value:function(t){var e=this._getScaleX();this.a=e*Math.cos(t),this.b=e*Math.sin(t),this._increment()},writable:!0},_calculateBoundsRect:{value:function(t){for(var n=[this.transformPoint(t.topLeft),this.transformPoint(new e(t.right,t.top)),this.transformPoint(new e(t.left,t.bottom)),this.transformPoint(t.bottomRight)],r=n[0].y,s=n[0].y,o=n[0].x,a=n[0].x,h=1;4>h;h++){var l=n[h];r>l.y&&(r=l.y),l.y>s&&(s=l.y),o>l.x&&(o=l.x),l.x>a&&(a=l.x)}return new i(o,r,a-o,s-r)},writable:!0},_equal:{value:function(t){for(var e=0;6>e;e++)if(this._values[e]!=t._values[e])return!1;return!0},writable:!0}}),r}),herlock.define("module/view/geom/ColorTransform",["lib/Class"],function(){function t(t,e,i){return t<<16|e<<8|i<<0}function e(t){return 255&t>>16}function i(t){return 255&t>>8}function n(t){return 255&t>>0}var r=0,s=1,o=2,a=3,h=function(t,e,i,n,r,s,o,a){var h=arguments.length;return 0===h?(this._version=Math.floor(1e7*Math.random()),this.__isInitialValue=!0,this._multiplier=[1,1,1,1],this._offset=[0,0,0,0],void 0):(t=h>0?t:1,e=h>1?e:1,i=h>2?i:1,n=h>3?n:1,r=h>4?r:0,s=h>5?s:0,o=h>6?o:0,a=h>7?a:0,this._version=Math.floor(1e7*Math.random()),this.__isInitialValue=1==t&&1==e&&1==i&&1==n&&0==r&&0==s&&0==o&&0==a,this._multiplier=[t,e,i,n],this._offset=[r,s,o,a],void 0)};return h.prototype=Object.create({},{_increment:{writable:!0,value:function(){this._version++,this.__isInitialValue=!1}},_getVersion:{writable:!0,value:function(){return this._version}},_isInitialValue:{writable:!0,value:function(){return this.__isInitialValue}},color:{get:function(){return t(this._offset[r],this._offset[s],this._offset[o])},set:function(t){this._multiplier[r]=1,this._multiplier[s]=1,this._multiplier[o]=1,this._offset[r]=e(t),this._offset[s]=i(t),this._offset[o]=n(t),this._increment()}},alphaMultiplier:{get:function(){return this._multiplier[a]},set:function(t){this._multiplier[a]=t,this._increment()}},redMultiplier:{get:function(){return this._multiplier[r]},set:function(t){this._multiplier[r]=t,this._increment()}},greenMultiplier:{get:function(){return this._multiplier[s]},set:function(t){this._multiplier[s]=t,this._increment()}},blueMultiplier:{get:function(){return this._multiplier[o]},set:function(t){this._multiplier[o]=t,this._increment()}},alphaOffset:{get:function(){return this._offset[a]},set:function(t){this._offset[a]=t,this._increment()}},redOffset:{get:function(){return this._offset[r]},set:function(t){this._offset[r]=t,this._increment()}},greenOffset:{get:function(){return this._offset[s]},set:function(t){this._offset[s]=t,this._increment()}},blueOffset:{get:function(){return this._offset[o]},set:function(t){this._offset[o]=t,this._increment()}},clone:{writable:!0,value:function(){var t=new h(this._multiplier[r],this._multiplier[s],this._multiplier[o],this._multiplier[a],this._offset[r],this._offset[s],this._offset[o],this._offset[a]);return t._version=this._version,t}},concat:{writable:!0,value:function(t){if(!t._isInitialValue())if(t._isInitialValue()){var e=t._multiplier,i=t._offset;this._multiplier[r]=e[r],this._multiplier[s]=e[s],this._multiplier[o]=e[o],this._multiplier[a]=e[a],this._offset[r]=i[r],this._offset[s]=i[s],this._offset[o]=i[o],this._offset[a]=i[a],this._increment()}else this._concat(t._multiplier,t._offset)}},_concat:{writable:!0,value:function(t,e){this._multiplier[r]*=t[r],this._multiplier[s]*=t[s],this._multiplier[o]*=t[o],this._multiplier[a]*=t[a],this._offset[r]=this._offset[r]*t[r]+e[r],this._offset[s]=this._offset[s]*t[s]+e[s],this._offset[o]=this._offset[o]*t[o]+e[o],this._offset[a]=this._offset[a]*t[a]+e[a],this._increment()}},_isAlphaTransform:{writable:!0,value:function(){return 1!=this._multiplier[a]&&1==this._multiplier[r]&&1==this._multiplier[s]&&1==this._multiplier[o]&&0==this._offset[r]&&0==this._offset[s]&&0==this._offset[o]&&0==this._offset[a]}},_isColorTransform:{writable:!0,value:function(){return!this._isInitialValue()&&!this._isAlphaTransform()}},_getValueArray:{writable:!0,value:function(){var t=[];return t[0]=this._multiplier[r],t[1]=this._multiplier[s],t[2]=this._multiplier[o],t[3]=this._multiplier[a],t[4]=this._offset[r]/255,t[5]=this._offset[s]/255,t[6]=this._offset[o]/255,t[7]=this._offset[a]/255,t}}}),h}),herlock.define("module/view/flash/internal/renderer/RenderingNode",["lib/Class","module/view/flash/display/BlendMode","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(t,e,i,n){var r=t(Object,function(t,r){t._blendMode="normal",t.concatenatedBlendMode="normal",t._mask=null,t.concatenatedMask=null,t._visible=!0,t.concatenatedVisible=!0,t._matrix=null,t.concatenatedMatrix=null,t._colorTransform=null,t.concatenatedColorTransform=null,t.needUpdateRequests=!1,t.needUpdateRequestsFromChildren=!1,t.childrenIsUpdated=!1,t.matrixIsUpdated=!1,t.concatenatedMatrixIsUpdated=!1,t.colorTransformIsUpdated=!1,t.concatenatedColorTransformIsUpdated=!1,t.constructor=function(){r.constructor.apply(this,arguments),this.children=[],this._matrix=new i,this.concatenatedMatrix=new i,this._colorTransform=new n,this.concatenatedColorTransform=new n,this._requestObjectsCache=[]},t.setMatrix=function(t){this._matrix._getVersion()!=t._getVersion()&&(this._matrix=t.clone(),this.matrixIsUpdated=!0)},t.getMatrix=function(){return this._matrix.clone()},t.setColorTransform=function(t){this._colorTransform._getVersion()!=t._getVersion()&&(this._colorTransform=t.clone(),this.colorTransformIsUpdated=!0)},t.getColorTransform=function(){return this._colorTransform},t.reflectProps=function(t,e,i,n,r,s){t.parent,this.setMatrix(r),this.setColorTransform(s),(this._visible!==e||this._blendMode!==i||this._mask!==n||this.childrenIsUpdated||this.matrixIsUpdated||this.colorTransformIsUpdated)&&(this.needUpdateRequests=!0),this._visible=e,this._blendMode=i,this._mask=n},t.visit=function(t){var i=t.parent;if(!this.needUpdateRequests&&!this.needUpdateRequestsFromChildren)return this._requestObjectsCache;this.childrenIsUpdated=!1,i.concatenatedMatrixIsUpdated||this.matrixIsUpdated?(this.matrixIsUpdated=!1,this.concatenatedMatrix=this.getMatrix(),this.concatenatedMatrix.concat(i.concatenatedMatrix),this.concatenatedMatrixIsUpdated=!0):this.concatenatedMatrixIsUpdated=!1,i.concatenatedColorTransformIsUpdated||this.colorTransformIsUpdated?(this.colorTransformIsUpdated=!1,this.concatenatedColorTransform=this._colorTransform,this.concatenatedColorTransform.concat(i.concatenatedColorTransform),this.concatenatedColorTransformIsUpdated=!0):this.concatenatedColorTransformIsUpdated=!1,this.concatenatedVisible=this._visible&&i.concatenatedVisible,this.concatenatedMask=i.concatenatedMask?i.concatenatedMask:this._mask,this.concatenatedBlendMode=this._blendMode==e.NORMAL?i.concatenatedBlendMode:this._blendMode,t.parent=this,this._requestObjectsCache.length=0;for(var n=this.children.length,r=0;n>r;++r){var s=this.children[r];s.needUpdateRequests=s.needUpdateRequests||this.needUpdateRequests,Array.prototype.push.apply(this._requestObjectsCache,s.visit(t.clone()))}return this.needUpdateRequests=!1,this.needUpdateRequestsFromChildren=!1,this._requestObjectsCache},t.getBoundingBox=function(t){if(this.visible)for(var e=this.children.length,i=0;e>i;++i)this.children[i].getBoundingBox(t)}});return r}),herlock.define("module/view/flash/geom/Transform",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.colorTransform={get:function(){return this._owner?this._owner._colorTransform.clone():new ColorTransform},set:function(t){this._owner&&!this._owner._setColorTransform(t)}},t.concatenatedColorTransform={get:function(){}},t.concatenatedMatrix={get:function(){}},t.matrix={get:function(){return this._owner?this._owner._matrix.clone():new Matrix},set:function(t){this._owner&&!this._owner._setMatrix(t)}},t._initwithOwner=function(t){this._owner=t},t._getOwner=function(){return this._owner}});return e}),herlock.define("module/view/flash/display/DisplayObject",["lib/Class","module/common/event/EventDispatcher","../internal/renderer/RenderingNode","./BlendMode","../geom/Transform","module/view/geom/Point","module/view/geom/Rectangle","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(t,e,i,n,r,s,o,a,h){var l=Math.PI,c=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._colorTransform=new h,this._naturalRect=new o,this._boundsRect=new o,this._matrix=new a,this._transformationPoint=null,this._scale9Grid=new o},t._blendMode=n.NORMAL,t._cacheAsBitmap=!1,t._cacheHandle=null,t._visible=!0,t._parent=null,t._mask=null,t._containable=!1,t._interactive=!1,t._xValue=0,t._yValue=0,t._scaleXValue=1,t._scaleYValue=1,t._rotationValue=0,t._skewXValue=0,t._skewYValue=0,t._calcNaturalRectRequested=!0,t._calcBoundsRectRequested=!0,t._calcMatrixRequested=!0,t._enabledTransformationPoint=!1,t.alpha={get:function(){return this._colorTransform.alphaMultiplier},set:function(t){this._colorTransform.alphaMultiplier=t}},t.blendMode={get:function(){return this._blendMode},set:function(t){this._blendMode=t}},t.cacheAsBitmap={get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t}},t.height={get:function(){return this._getBoundsRect().height},set:function(t){this.scaleY=this.scaleY*t/this.height}},t.mask={get:function(){this._mask},set:function(t){this._mask=t}},t.name="",t.parent={get:function(){return this._parent}},t.root={get:function(){return this._parent?this._parent.root:this}},t.scale9Grid={get:function(){return this._scale9Grid.clone()},set:function(t){null===t?this._scale9Grid.setEmpty():this._scale9Grid=t}},t.rotation={get:function(){return this._rotationValue},set:function(t){if(this._enabledTransformationPoint)return this._setRotationWithTransformPoint(t,this.transformationPoint),void 0;for(;t>180;)t-=360;for(;-180>t;)t+=360;this._rotationValue=t;var e=new a;e._setSkewX(this._skewXValue),e._setSkewY(this._skewYValue),e.rotate((this._rotationValue-e._getRotation())/180*l),this._skewXValue=e._getSkewX(),this._skewYValue=e._getSkewY(),this._requestCalcNaturalRect()}},t._setRotationWithTransformPoint=function(t,e){for(var i=this._getMatrix(),n=i.transformPoint(e);t>180;)t-=360;for(;-180>t;)t+=360;this._rotationValue=t;var r=new a;r._setSkewX(this._skewXValue),r._setSkewY(this._skewYValue),r.rotate((this._rotationValue-r._getRotation())/180*l),this._skewXValue=r._getSkewX(),this._skewYValue=r._getSkewY(),this._requestCalcNaturalRect(),i=this._getMatrix();var r=i.transformPoint(e);this._xValue+=n.x-r.x,this._yValue+=n.y-r.y,this._requestCalcNaturalRect()},t.scaleX={get:function(){return this._scaleXValue},set:function(t){return this._scaleXValue!==t?this._enabledTransformationPoint?(this._setScaleXWithTransformPoint(t,this._transformationPoint),void 0):(isNaN(t)&&console.error("debug scaleX",this,t),this._scaleXValue=t,this._requestCalcNaturalRect(),void 0):void 0}},t._setScaleXWithTransformPoint=function(t,e){var i=this._getMatrix(),n=i.transformPoint(e);this._scaleXValue=t,this._requestCalcNaturalRect(),i=this._getMatrix();var r=i.transformPoint(e);this._xValue+=n.x-r.x,this._yValue+=n.y-r.y,this._requestCalcNaturalRect()},t.scaleY={get:function(){return this._scaleYValue},set:function(t){return this._scaleYValue!==t?this._enabledTransformationPoint?(this._setScaleYWithTransformPoint(t,this._transformationPoint),void 0):(this._scaleYValue=t,this._requestCalcNaturalRect(),void 0):void 0}},t._setScaleYWithTransformPoint=function(t,e){var i=this._getMatrix(),n=i.transformPoint(e);this._scaleYValue=t,this._requestCalcNaturalRect(),i=this._getMatrix();var r=i.transformPoint(e);this._xValue+=n.x-r.x,this._yValue+=n.y-r.y,this._requestCalcNaturalRect()},t.stage={get:function(){return this._parent?this._parent.stage:null}},t.transform={get:function(){var t=new r;return t._initwithOwner(this),t},set:function(t){this._setColorTransform(t.getColorTransform()),this._setMatrix(t.getMatrix()),requestCalcNaturalRect()}},t.visible={get:function(){return this._visible},set:function(t){this._visible!=t&&(this._visible=t,this._requestCalcNaturalRect())}},t.width={get:function(){return this._getBoundsRect().width},set:function(t){this.scaleX=this.scaleX*t/this.width}},t.x={get:function(){return this._xValue},set:function(t){this._xValue!==t&&(this._xValue=t,this._requestCalcNaturalRect())}},t.y={get:function(){return this._yValue},set:function(t){this._yValue!==t&&(this._yValue=t,this._requestCalcNaturalRect())}},t.getBounds=function(t){t||(t=this);var e=this._getConcatenatedMatrix(),i=t._getConcatenatedMatrix();i.invert(),e.concat(i);var n=this._getNaturalRect(),r=e._calculateBoundsRect(n);return r},t.getRect=function(t){return getBounds(t)},t.globalToLocal=function(t){var e=this._getConcatenatedMatrix();return e.invert(),e.transformPoint(t)},t.hitTestObject=function(t){var e=this._getNaturalRect(),i=this._getConcatenatedMatrix()._calculateBoundsRect(e);e=t._getNaturalRect();var n=t._getConcatenatedMatrix()._calculateBoundsRect(e),r=i.containsRect(n)||i.intersects(n);return r},t.hitTestPoint=function(t,e,i){var n=this.stage;if(!n)return!1;if(i){var r=this.getBounds(n);return r.containsPoint(new s(t,e))}var r=this.getBounds(n);return r.containsPoint(new s(t,e))},t.localToGlobal=function(t){return this._getConcatenatedMatrix().transformPoint(t)},t.transformationPoint={get:function(){return this._transformationPoint?this._transformationPoint.clone():new s(0,0)},set:function(t){this._transformationPoint=t.clone(),this._enabledTransformationPoint=!0,0==t.x&&0==t.y&&(this._enabledTransformationPoint=!1)}},t._getMatrix=function(){return this._getMatrixRef().clone()},t._getMatrixRef=function(){if(this._calcMatrixRequested){this._calcMatrixRequested=!1;var t=new a;t.scale(this._scaleXValue,this._scaleYValue),this._skewXValue!=this._skewYValue?(t._setSkewX(this._skewXValue),t._setSkewY(this._skewYValue)):t.rotate(this._rotationValue/180*l),t.translate(this._xValue,this._yValue),this._matrix._equal(t)||(this._matrix=t)}return this._matrix},t._setMatrix=function(t){this._xValue=t._getX(),this._yValue=t._getY(),this._rotationValue=t._getRotation(),this._scaleXValue=t._getScaleX(),this._scaleYValue=t._getScaleY(),this._skewXValue=t._getSkewX(),this._skewYValue=t._getSkewY(),this._requestCalcNaturalRect()},t._getColorTransform=function(){return this._colorTransform.clone()},t._getColorTransformRef=function(){return this._colorTransform},t._setColorTransform=function(t){this._colorTransform=t},t._getConcatenatedMatrix=function(){for(var t=this._getMatrix(),e=this.parent;e;){var i=e._getMatrix();t.concat(i),e=e.parent}return t},t._getConcatenatedColorTransform=function(){},t._setParent=function(t){null!=this._parent&&(this._parent=null),null!=t&&(this._parent=t)},t._notifyOnAddedToStage=function(){this._hasEventListener("addedToStage")&&this.dispatchEvent(new Event("addedToStage"))},t._notifyOnRemovedFromStage=function(){this._hasEventListener("removedFromStage")&&this.dispatchEvent(new Event("removedFromStage"))},t._notifyOnEnterFrame=function(){this._hasEventListener("enterFrame")&&this.dispatchEvent(new Event("enterFrame"))},t._notifyOnFrameConstructed=function(){},t._notifyOnExecuteFrameScript=function(){},t._notifyOnExitFrame=function(){this._hasEventListener("exitFrame")&&this.dispatchEvent(new Event("exitFrame"))},t._drawVectorGraphics=function(){},t._glPrepare=function(t){var e=this._getRenderingNode(),i=null;return null!=this._mask?i=this._mask._getRenderingNode():null==this._mask&&!!e.mask&&(i=null),e.reflectProps(t,this._visible,this._blendMode,i,this._getMatrixRef(),this._getColorTransform()),e},t._getNaturalRect=function(){return this._calcNaturalRectRequested&&(this._calcNaturalRectRequested=!1,this._calculateNaturalRect()),this._naturalRect},t._calculateNaturalRect=function(){this._naturalRect.setEmpty()},t._requestCalcNaturalRect=function(t){1!=t&&(this._calcMatrixRequested||(this._calcMatrixRequested=!0,this._calcNaturalRectRequested=!0,this._calcBoundsRectRequested=!0,null!==this._parent&&this._parent._requestCalcNaturalRect()))},t._getBoundsRect=function(){if(this._calcBoundsRectRequested){this._calcBoundsRectRequested=!1;var t=this._getNaturalRect();this._boundsRect=this._getMatrix()._calculateBoundsRect(t),isNaN(this._boundsRect.width)&&console.error("debug",this,this._boundsRect)}return this._boundsRect},t._getNodesToRoot=function(){var t=[];if(null==this._parent)return t;for(var e=this;null!=e;)t.push(e),e=e.parent;return t},t._hitTestStrictInternal=function(t){var e=this._getMatrix();e.invert();var i=e.transformPoint(t),n=this._getNaturalRect().containsPoint(i);if(n&&this.mask){var r=this.mask,s=r._getConcatenatedMatrix();s.invert(),i=this._getConcatenatedMatrix().transformPoint(i),i=s.transformPoint(i),n=r._getNaturalRect().containsPoint(i)}return n?this:null},t._renderingNode=null,t._getRenderingNode=function(){return this._renderingNode||(this._renderingNode=this._createRenderingNode()),this._renderingNode},t._createRenderingNode=function(){return new i},t.toString=function(){return'[object DisplayObject name="'+this.name+'"]'}});return c}),herlock.define("module/view/flash/display/InteractiveObject",["lib/Class","./DisplayObject"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.mouseEnabled=!0});return i}),herlock.define("module/view/flash/display/DisplayObjectContainer",["lib/Class","./InteractiveObject"],function(t,e){var i=t(e,function(t,i){t.constructor=function(){i.constructor.apply(this,arguments),this._children=[],this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},t.numChildren={get:function(){return this._children.length}},t.mouseChildren=!0,t.addChild=function(t){return this.addChildAt(t,this._children.length)},t.addChildAt=function(t,e){if(!t)return console.log("warning: "+this+".addChild child="+t);if(0>e)return console.log("warning: out of range.");if(e>this._children.length)return console.log("warning: out of range.");t._parent&&t._parent.removeChild(t),this._children.splice(e,0,t),t._setParent(this),this._requestCalcNaturalRect(),this._childrenUpdated();for(var i=[],n=t._getNodesToRoot(),r=n.length-1;r>=0;r--)i.push(n[r]);return t._propagateEvent(new Event("added"),i),t.stage&&t._notifyOnAddedToStage(),t},t.getChildIndex=function(t){return this._children.indexOf(t)},t.getChildAt=function(t){return t>=this._children.length?null:this._children[t]},t.getChildByName=function(t){for(var e=this._children.length-1;e>=0;e--)if(this._children[e].name===t)return this._children[e];return null},t.removeChild=function(t){var e=this._children.indexOf(t);return-1===e?console.log("warning: "+this+".removeChild("+t+")"):this.removeChildAt(e)},t.removeChildAt=function(t){if(0>t)return console.log("warning: out of range.");if(t>=this._children.length)return console.log("warning: out of range.");for(var e=this._children[t],i=[],n=e._getNodesToRoot(),r=n.length-1;r>=0;r--)i.push(n[r]);return this._children.splice(t,1)[0],e._setParent(null),this._requestCalcNaturalRect(),this._childrenUpdated(),e._propagateEvent(new Event("removed"),i),e.stage||e._notifyOnRemovedFromStage(),e},t.contains=function(t){if(this===t)return!0;if(-1!==this._children.indexOf(t))return!0;for(var e=this._children,i=e.length,n=0;i>n;n++)if(e[n].contains&&e[n].contains(t))return!0;return!1},t.setChildIndex=function(t,e){this.addChildAt(t,e)},t.swapChildren=function(t,e){var i=this.getChildIndex(t),n=this.getChildIndex(e);-1!=i&&-1!=n&&(this.addChildAt(t,n),this.addChildAt(e,i),this._childrenUpdated())},t.swapChildrenAt=function(t,e){var i=this.numChildren();t>=i||e>=i||0>t||0>e||this.swapChildren(this.getChildAt(t),this.getChildAt(e))},t._childrenUpdated=function(){this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},t._notifyOnAddedToStage=function(){DisplayObject.prototype._notifyOnAddedToStage.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnAddedToStage()},t._notifyOnRemovedFromStage=function(){DisplayObject.prototype._notifyOnRemovedFromStage.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnRemovedFromStage()},t._notifyOnEnterFrame=function(){DisplayObject.prototype._notifyOnEnterFrame.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnEnterFrame()},t._notifyOnFrameConstructed=function(){DisplayObject.prototype._notifyOnFrameConstructed.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnFrameConstructed()},t._notifyOnExecuteFrameScript=function(){DisplayObject.prototype._notifyOnExecuteFrameScript.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnExecuteFrameScript()},t._notifyOnExitFrame=function(){DisplayObject.prototype._notifyOnExitFrame.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnExitFrame()},t._drawVectorGraphics=function(){for(var t=this._children,e=t.length,i=0;e>i;i++)t[i]._drawVectorGraphics()},t._glPrepare=function(t){DisplayObject.prototype._glPrepare.call(this,t);var e=this._getRenderingNode(),i=this._children,n=i.length;if(this._updatedChildrenForRenderingNode){this._updatedChildrenForRenderingNode=!1,e.childrenIsUpdated=!0,e.needUpdateRequestsFromChildren=!0;var r=e.children;r.length=0;for(var s=0;n>s;s++){var o=i[s]._glPrepare(t);null!=o&&r.push(o)}}else for(var s=0;n>s;s++){var o=i[s]._glPrepare(t);e.needUpdateRequestsFromChildren=e.needUpdateRequestsFromChildren||o.needUpdateRequests||o.needUpdateRequestsFromChildren}return e},t._calculateNaturalRect=function(){this._naturalRect.setEmpty();for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i].visible&&(this._naturalRect=this._naturalRect.union(t[i]._getBoundsRect()))},t._hitTestStrictInternal=function(t){if(null==i._hitTestStrictInternal.call(this,t))return null;var n=null,r=this._getMatrix();r.invert(),t=r.transformPoint(t);for(var s=!1,o=this.numChildren-1;o>=0;o--)if(1==this.getChildAt(o).visible&&(n=this.getChildAt(o)._hitTestStrictInternal(t),null!=n)){if(1!=this.mouseChildren)return this;if(1==n.isInstanceOf(e)&&1==n.mouseEnabled)return n;s=!0}return s?this:null},t.toString=function(){return'[object DisplayObjectContainer name="'+this.name+'"]'}});return i}),herlock.define("module/view/flash/display/Sprite",["lib/Class","./DisplayObjectContainer"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.toString=function(){return'[object Sprite name="'+this.name+'"]'}});return i}),herlock.define("module/view/flash/internal/renderer/Renderer",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.accept=function(){return!1},t.render=function(){},t._getShader=function(){return null}});return e}),herlock.define("module/view/gl/Scissor",["lib/Class"],function(t){var e=t(Object,function(t,i){t.constructor=function(t,n,r,s,o){i.constructor.apply(this,arguments),this._x=t,this._y=n,this._w=r,this._h=s,o&&(e._current=this)},t.enable=function(){this.isEmpty()||(gl.enable(gl.SCISSOR_TEST),gl.scissor(this._x,this._y,this._w,this._h),checkGlError("glScissor")),e._current=this},t.disable=function(){gl.disable(gl.SCISSOR_TEST),checkGlError("glDisable"),e._current=null},t.isEmpty=function(){return 0==this._x&&0==this._y&&0==this._w&&0==this._h},t.equals=function(t,e,i,n){return this._x==t&&this._y==e&&this._w==i&&this._h==n
}}),i=new function(){var t=[];this.push=function(e){t.push(e),e.enable()},this.pop=function(){t.pop(),t.length>0?t[t.length-1].enable():gl.disable(gl.SCISSOR_TEST)}};e._current=null;var n={unbind:function(){i.pop()}};return e.BindScope=function(t){return i.push(t),n},e.getX=function(){return null==this._current?0:this._current._x},e.getY=function(){return null==this._current?0:this._current._y},e.getWidth=function(){return null==this._current?0:this._current._w},e.getHeight=function(){return null==this._current?0:this._current._h},e.getCancelScissor=function(){return this._cancelScissor||(this._cancelScissor=new e(0,0,0,0)),this._cancelScissor},e}),herlock.define("module/view/gl/TextureObject",["lib/Class"],function(t){var e,i=t(Object,function(t,n){t.constructor=function(t,e){n.constructor.apply(this,arguments),this._id,this._width=t,this._height=e,gl.activeTexture(gl.TEXTURE0),this._id=gl.createTexture(),checkGlError("gl.createTexture");var r=s(this);gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),checkGlError("gl.texParameterf"),gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),checkGlError("gl.texParameterf"),gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),checkGlError("gl.texParameterf"),gl.texParameterf(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),checkGlError("gl.texParameterf"),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,t,e,0,gl.RGBA,gl.UNSIGNED_BYTE,null),checkGlError("gl.texImage2D"),r.unbind(),i.put(this)},t.getId=function(){return this._id},t.getWidth=function(){return this._width},t.getHeight=function(){return this._height},t.bind=function(){e!=this._id&&(gl.bindTexture(gl.TEXTURE_2D,this._id),checkGlError("glBindTexture"),e=this._id)},t.unbind=function(){},t.subImage2D=function(t,e,i,n,r){var o=arguments.length,a=s(this);o>3?gl.texSubImage2D(gl.TEXTURE_2D,0,t,e,i,n,gl.RGBA,gl.UNSIGNED_BYTE,r):gl.texSubImage2D(gl.TEXTURE_2D,0,t,e,gl.RGBA,gl.UNSIGNED_BYTE,i),checkGlError("glTexSubImage2D"),a.unbind()}}),n=new function(){var t=[];this.push=function(e){t.push(e),e.bind()},this.pop=function(){t.pop(),t.length>0&&t[t.length-1].bind()}},r={unbind:function(){n.pop()}},s=i.BindScope=function(t){return n.push(t),r};return i._list=[],i.getById=function(t){for(var e=this._list.length,i=0;e>i;i++)if(this._list[i].getId()==t)return this._list[i];return null},i.put=function(t){this._list.push(t)},i.release=function(t){for(var e=this._list.length,i=0;e>i;i++)if(this._list[i]==t)return this._list.splice(i,1),void 0},i}),herlock.define("module/view/gl/Shader",["lib/Class"],function(t){function e(t,e){var i=gl.createShader(e);if(checkGlError("glCreateShader"),gl.shaderSource(i,t),checkGlError("glShaderSource"),gl.compileShader(i),checkGlError("glCompileShader"),!gl.getShaderParameter(i,gl.COMPILE_STATUS)){var n=gl.getShaderInfoLog(i);return console.error(n),-1}return i}function i(t,i){var n=e(t,gl.VERTEX_SHADER),r=e(i,gl.FRAGMENT_SHADER);-1==n&&console.error("gl Create Vertex Shaders Failed"),-1==r&&console.error("gl Create Fragment Shaders Failed");var s=gl.createProgram();checkGlError("glCreateProgram"),gl.attachShader(s,n),checkGlError("glAttachShader"),gl.attachShader(s,r),checkGlError("glAttachShader"),gl.linkProgram(s),checkGlError("glLinkProgram");var o=gl.getProgramInfoLog(s,gl.LINK_STATUS);return checkGlError("glGetProgramiv"),o?(console.error(o),-1):(gl.deleteShader(n),checkGlError("glDeleteShader"),gl.deleteShader(r),checkGlError("glDeleteShader"),s)}var n=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._built=!1,this._programId=null,this._vertexShaderCode,this._fragmentShaderCode},t.setVertexShaderCode=function(t){this.isBuilt()||(this._vertexShaderCode=t)},t.setFragmentShaderCode=function(t){this.isBuilt()||(this._fragmentShaderCode=t)},t.build=function(){this.isBuilt()||(this._programId=i(this._vertexShaderCode,this._fragmentShaderCode),-1!=this._programId&&(this._built=!0,this._onBuilt()))},t.getProgramId=function(){return this._programId},t.getAttributeLocation=function(t){if(1!=this.isBuilt())return-1;var e=-1;return e=gl.getAttribLocation(this._programId,t),checkGlError("glGetAttribLocation"),e},t.getUniformLocation=function(t){if(1!=this.isBuilt())return-1;var e=-1;return e=gl.getUniformLocation(this._programId,t),checkGlError("glGetUniformLocation"),e},t.isBuilt=function(){return this._built},t.isActive=function(){return n._current==this},t.activate=function(){this.isActive()||(1!=this.isBuilt()&&this.build(),1==this.isBuilt()&&(null!=n._current&&n._current.deactivate(),n._current=this,gl.useProgram(this._programId),checkGlError("glUseProgram"),this._onActivate()))},t.deactivate=function(){1==this.isActive()&&this._onDeactivate()},t.draw=function(){},t._onBuilt=function(){},t._onActivate=function(){},t._onDeactivate=function(){}}),r=new function(){var t=[];this.push=function(e){t.push(e),e.activate()},this.pop=function(){t.pop(),t.length>0&&t[t.length-1].activate()}};n._current=null;var s={unbind:function(){r.pop()}};return n.BindScope=function(t){return r.push(t),s},n}),herlock.define("module/view/flash/internal/renderer/SubImageRenderer",["lib/Class","./Renderer","module/view/gl/Viewport","module/view/gl/Scissor","module/view/gl/TextureObject","module/view/gl/Shader","module/view/flash/display/BlendMode"],function(t,e,i,n,r,s,o){var a="#ifdef GL_ES\nprecision highp float;\n#endif\nattribute vec4 a_positionAndTexPoint;\nvarying vec2 v_texCoords;\nvoid main() {\n   v_texCoords = a_positionAndTexPoint.zw;\n   gl_Position = vec4( a_positionAndTexPoint.xy, 0.0, 1.0 );\n}",h="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_texUnitId;\nvarying vec2 v_texCoords;\nvoid main() {\n	vec4 color = texture2D( u_texUnitId, v_texCoords );\n	gl_FragColor = vec4(color.rgb * color.a , color.a);\n}",l=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,this._objects=[]},t._getShader=function(){if(null!=this._shader)return this._shader;this._shader=new s,this._shader.setVertexShaderCode(a),this._shader.setFragmentShaderCode(h),this._shader.build();var t=s.BindScope(this._shader);return this._a_positionAndTexPoint=this._shader.getAttributeLocation("a_positionAndTexPoint"),gl.enableVertexAttribArray(this._a_positionAndTexPoint),this._u_texUnitId=this._shader.getUniformLocation("u_texUnitId"),gl.uniform1i(this._u_texUnitId,0),gl.enable(gl.BLEND),t.unbind(),this._shader},t._getVBO=function(){return null!=this._vbo?this._vbo:(this._vbo=gl.createBuffer(),this._vbo)},t.accept=function(t){return-1==this._textureId&&this._blendMode==o.NONE?(this._textureId=t.getTextureId(),this._blendMode=t.blendMode,this._maskNode=t.maskNode,this._objects.push(t),!0):t.getTextureId()!=this._textureId?!1:t.blendMode!=this._blendMode?!1:t.maskNode!=this._maskNode?!1:(this._objects.push(t),!0)},t.render=function(){var t=this._objects.length;if(!(0>=t)){for(var e=[],a=0;t>a;a++){var h=this._objects[a];Array.prototype.push.apply(e,h.vertexes)}var l=s.BindScope(this._getShader());switch(this._blendMode){case o.ADD:gl.blendFunc(gl.ONE,gl.ONE),checkGlError("glBlendFunc");break;case o.NORMAL:default:gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),checkGlError("glBlendFunc")}var c=null;if(this._maskNode){var u=new Rectangle;this._maskNode.getBoundingBox(u);var _=new Matrix;_.translate(1,1),_.scale(i.getWidth()/2,i.getHeight()/2),u=_._calculateBoundsRect(u),c=new n(Math.round(u.x),Math.round(u.y),Math.round(u.width),Math.round(u.height)),c.enable()}var f=r.BindScope(r.getById(this._textureId));gl.bindBuffer(gl.ARRAY_BUFFER,this._getVBO()),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(e),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_positionAndTexPoint,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.TRIANGLES,0,6*t),checkGlError("glDrawArrays"),null!=c&&c.disable(),this._objects=[],this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,f.unbind(),l.unbind()}}});return l}),herlock.define("module/view/flash/internal/renderer/SubImageRendererAlpha",["lib/Class","./Renderer","module/view/gl/Viewport","module/view/gl/Scissor","module/view/gl/TextureObject","module/view/gl/Shader","module/view/flash/display/BlendMode"],function(t,e,i,n,r,s,o){var a="#ifdef GL_ES\nprecision highp float;\n#endif\nattribute vec4 a_positionAndTexPoint;\nattribute lowp float a_alpha;\nvarying vec2 v_texCoords;\nvarying lowp float v_alpha;\nvoid main() {\n   v_texCoords = a_positionAndTexPoint.zw;\n   v_alpha = a_alpha;\n   gl_Position = vec4( a_positionAndTexPoint.xy, 0, 1 );\n}\n",h="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_texUnitId;\nvarying vec2 v_texCoords;\nvarying lowp float v_alpha;\nvoid main() {\n   vec4 color = texture2D( u_texUnitId, v_texCoords );\n   color.a = v_alpha * color.a;\n   color = vec4(color.rgb * color.a , color.a);\n	 gl_FragColor = color;\n}",l=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,this._objects=[]},t._getShader=function(){if(null!=this._shader)return this._shader;this._shader=new s,this._shader.setVertexShaderCode(a),this._shader.setFragmentShaderCode(h),this._shader.build();var t=s.BindScope(this._shader);return this._a_positionAndTexPoint=this._shader.getAttributeLocation("a_positionAndTexPoint"),gl.enableVertexAttribArray(this._a_positionAndTexPoint),this._a_alpha=this._shader.getAttributeLocation("a_alpha"),gl.enableVertexAttribArray(this._a_alpha),this._u_texUnitId=this._shader.getUniformLocation("u_texUnitId"),gl.uniform1i(this._u_texUnitId,0),gl.enable(gl.BLEND),t.unbind(),this._shader},t._getVBO=function(){return null!=this._vbo?this._vbo:(this._vbo=gl.createBuffer(),this._vbo)},t.accept=function(t){return-1==this._textureId&&this._blendMode==o.NONE?(this._textureId=t.getTextureId(),this._blendMode=t.blendMode,this._maskNode=t.maskNode,this._objects.push(t),!0):t.getTextureId()!=this._textureId?!1:t.blendMode!=this._blendMode?!1:t.maskNode!=this._maskNode?!1:(this._objects.push(t),!0)},t.render=function(){var t=this._objects.length;if(!(0>=t)){for(var e=[],a=[],h=0;t>h;h++){var l=this._objects[h],c=l.colorTransform.alphaMultiplier;Array.prototype.push.apply(e,l.vertexes),Array.prototype.push.apply(a,[c,c,c,c,c,c])}var u=s.BindScope(this._getShader());switch(this._blendMode){case o.ADD:gl.blendFunc(gl.ONE,gl.ONE),checkGlError("glBlendFunc");break;case o.NORMAL:default:gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),checkGlError("glBlendFunc")}var _=null;if(this._maskNode){var f=new Rectangle;this._maskNode.getBoundingBox(f);var d=new Matrix;d.translate(1,1),d.scale(i.getWidth()/2,i.getHeight()/2),f=d._calculateBoundsRect(f),_=new n(Math.round(f.x),Math.round(f.y),Math.round(f.width),Math.round(f.height)),_.enable()}var g=r.BindScope(r.getById(this._textureId));gl.bindBuffer(gl.ARRAY_BUFFER,this._getVBO()),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(e),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_positionAndTexPoint,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),this._alphaVBO||(this._alphaVBO=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._alphaVBO),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(a),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_alpha,1,gl.FLOAT,!1,4,0),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.TRIANGLES,0,6*t),checkGlError("glDrawArrays"),null!=_&&(_.disable(),delete _),this._objects=[],this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,g.unbind(),u.unbind()}}});return l}),herlock.define("module/view/flash/internal/renderer/SubImageRendererColorTransform",["lib/Class","./Renderer","module/view/gl/Viewport","module/view/gl/Scissor","module/view/gl/TextureObject","module/view/gl/Shader","module/view/flash/display/BlendMode"],function(t,e,i,n,r,s,o){var a="#ifdef GL_ES\nprecision highp float;\n#endif\nattribute vec4 a_positionAndTexPoint;\nattribute lowp vec4 a_colorMulti;\nattribute lowp vec4 a_colorOffset;\nvarying vec2 v_texCoords;\nvarying lowp vec4 v_colorMulti;\nvarying lowp vec4 v_colorOffset;\nvoid main() {\n   v_texCoords = a_positionAndTexPoint.zw;\n   v_colorMulti = a_colorMulti;\n   v_colorOffset = a_colorOffset;\n   gl_Position = vec4( a_positionAndTexPoint.xy, 0, 1 );\n}",h="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_texUnitId;\nvarying vec2 v_texCoords;\nvarying lowp vec4 v_colorMulti;\nvarying lowp vec4 v_colorOffset;\nvoid main() {\n   vec4 color = texture2D( u_texUnitId, v_texCoords );\n   color = color * v_colorMulti + v_colorOffset;\n   gl_FragColor = vec4( color.rgb * color.a, color.a );\n}",l=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,this._objects=[]},t._getShader=function(){if(null!=this._shader)return this._shader;this._shader=new s,this._shader.setVertexShaderCode(a),this._shader.setFragmentShaderCode(h),this._shader.build();var t=s.BindScope(this._shader);return this._a_positionAndTexPoint=this._shader.getAttributeLocation("a_positionAndTexPoint"),gl.enableVertexAttribArray(this._a_positionAndTexPoint),this._a_colorMulti=this._shader.getAttributeLocation("a_colorMulti"),gl.enableVertexAttribArray(this._a_colorMulti),this._a_colorOffset=this._shader.getAttributeLocation("a_colorOffset"),gl.enableVertexAttribArray(this._a_colorOffset),this._u_texUnitId=this._shader.getUniformLocation("u_texUnitId"),gl.uniform1i(this._u_texUnitId,0),gl.enable(gl.BLEND),t.unbind(),this._shader},t._getVBO=function(){return null!=this._vbo?this._vbo:(this._vbo=gl.createBuffer(),this._vbo)},t.accept=function(t){return-1==this._textureId&&this._blendMode==o.NONE?(this._textureId=t.getTextureId(),this._blendMode=t.blendMode,this._maskNode=t.maskNode,this._objects.push(t),!0):t.getTextureId()!=this._textureId?!1:t.blendMode!=this._blendMode?!1:t.maskNode!=this._maskNode?!1:(this._objects.push(t),!0)},t.render=function(){var t=this._objects.length;if(!(0>=t)){for(var e=[],a=[],h=[],l=0;t>l;l++){var c=this._objects[l];Array.prototype.push.apply(e,c.vertexes);var u=c.colorTransform._getValueArray(),_=4*6*l;a[_+0+0]=a[_+0+4]=a[_+0+8]=a[_+0+12]=a[_+0+16]=a[_+0+20]=u[0],a[_+1+0]=a[_+1+4]=a[_+1+8]=a[_+1+12]=a[_+1+16]=a[_+1+20]=u[1],a[_+2+0]=a[_+2+4]=a[_+2+8]=a[_+2+12]=a[_+2+16]=a[_+2+20]=u[2],a[_+3+0]=a[_+3+4]=a[_+3+8]=a[_+3+12]=a[_+3+16]=a[_+3+20]=u[3],h[_+0+0]=h[_+0+4]=h[_+0+8]=h[_+0+12]=h[_+0+16]=h[_+0+20]=u[4],h[_+1+0]=h[_+1+4]=h[_+1+8]=h[_+1+12]=h[_+1+16]=h[_+1+20]=u[5],h[_+2+0]=h[_+2+4]=h[_+2+8]=h[_+2+12]=h[_+2+16]=h[_+2+20]=u[6],h[_+3+0]=h[_+3+4]=h[_+3+8]=h[_+3+12]=h[_+3+16]=h[_+3+20]=u[7]}var f=s.BindScope(this._getShader());switch(this._blendMode){case o.ADD:gl.blendFunc(gl.ONE,gl.ONE),checkGlError("glBlendFunc");break;case o.NORMAL:default:gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),checkGlError("glBlendFunc")}var d=null;if(this._maskNode){var g=new Rectangle;this._maskNode.getBoundingBox(g);var m=new Matrix;m.translate(1,1),m.scale(i.getWidth()/2,i.getHeight()/2),g=m._calculateBoundsRect(g),d=new n(Math.round(g.x),Math.round(g.y),Math.round(g.width),Math.round(g.height)),d.enable()}var p=r.BindScope(r.getById(this._textureId));gl.bindBuffer(gl.ARRAY_BUFFER,this._getVBO()),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(e),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_positionAndTexPoint,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),this._cmVBO||(this._cmVBO=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._cmVBO),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(a),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_colorMulti,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),this._coVBO||(this._coVBO=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,this._coVBO),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(h),gl.STATIC_DRAW),gl.vertexAttribPointer(this._a_colorOffset,4,gl.FLOAT,!1,16,0),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.TRIANGLES,0,6*t),checkGlError("glDrawArrays"),null!=d&&(d.disable(),delete d),this._objects=[],this._textureId=-1,this._blendMode=o.NONE,this._maskNode=null,p.unbind(),f.unbind()}}});return l}),herlock.define("module/view/flash/internal/renderer/RenderingSystem",["lib/Class","./SubImageRenderer","./SubImageRendererAlpha","./SubImageRendererColorTransform"],function(t,e,i,n){var r=t(Object,function(t,r){t.constructor=function(){r.constructor.apply(this,arguments),this._subImage=new e,this._subImageAlpha=new i,this._subImageColorTransform=new n,this._currentRenderer=this._subImage},t.begin=function(){},t.render=function(t){var e,i=t.colorTransform;e=i._isColorTransform()?this._subImageColorTransform:i._isAlphaTransform()?this._subImageAlpha:this._currentRenderer==this._subImageColorTransform?this._subImage:this._currentRenderer,this._currentRenderer!=e&&(this._currentRenderer.render(),this._currentRenderer=e);var n=this._currentRenderer.accept(t);n||(this._currentRenderer.render(),this._currentRenderer.accept(t))},t.end=function(){null!=this._currentRenderer&&this._currentRenderer.render()}});return r.getInstance=function(){return this._instance||(this._instance=new r),this._instance},r}),herlock.define("module/view/flash/events/InteractiveObjectTouchEvent",["lib/Class","module/common/event/Event"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments);var t=arguments.length,i=arguments;this._touchPointID=t>3?i[3]:0,this._isPrimaryTouchPoint=t>4?i[4]:!1,this._localX=t>5?i[5]:0,this._localY=t>6?i[6]:0},t.isPrimaryTouchPoint={get:function(){return this._isPrimaryTouchPoint},set:function(t){this._isPrimaryTouchPoint=t}},t.localX={get:function(){return this._localX},set:function(t){this._localX=t}},t.localY={get:function(){return this._localY},set:function(t){this._localY=t}},t.touchPointID={get:function(){return this._touchPointID},set:function(t){this._touchPointID=t}},t.stageX={get:function(){if(this._hasStagePoint)return this._stagePoint.x;var t=this.target;return t.localToGlobal(new Point(this.localX,this.localY)).x}},t.stageY={get:function(){if(this._hasStagePoint)return this._stagePoint.y;var t=this.target;return t.localToGlobal(new Point(this.localX,this.localY)).y}},t._setStagePoint=function(t){return this._stagePoint=t,this._hasStagePoint=!0,this}});return i}),herlock.define("module/view/flash/display/Stage",["lib/Class","module/view/gl/IRenderable","module/view/gl/Viewport","./Sprite","../internal/renderer/RenderingNode","../internal/renderer/RenderingSystem","module/view/touch/TouchEventInfo","../events/InteractiveObjectTouchEvent"],function(t,e,i,n,r,s,o,a){var h=t(n,function(t,e){t.constructor=function(t,i){e.constructor.apply(this,arguments),this._stageWidth=t||100,this._stageHeight=i||100,this._layer=null,this._frameRate=60,this._quality=null,this._offscreenHandle=null,this._primaryTouchId=-1,this._touchPointerStateDictionary={},this._layerContentRenderObject=null},t.frameRate={get:function(){return this._frameRate},set:function(){}},t.stageWidth={get:function(){return this._stageWidth},set:function(t){this._stageWidth=t,null!=this._layer&&this._layer._notifyResizeContent()}},t.stageHeight={get:function(){return this._stageHeight},set:function(t){this._stageHeight=t,null!=this._layer&&this._layer._notifyResizeContent()}},t.stage={get:function(){return this}},t.layer={get:function(){return this._layer}},t._getContentWidth=function(){return this.stageWidth},t._getContentHeight=function(){return this.stageHeight},t.getLayer=function(){return this._layer},t._onAddedTo=function(t){this._layer=t},t._onRemovedFrom=function(){this._layer=NULL},t._glPrepare=function(t,e){this._layerContentRenderObject||(this._layerContentRenderObject=new c);var i={};this._layerContentRenderObject.root=DisplayObjectContainer.prototype._glPrepare.call(this,i);var n=new Matrix;return n.concat(this.getLayer()._getContentMatrix()),n.concat(this.getLayer()._getMatrix()),this._layerContentRenderObject.matrix._equal(n)||(this._layerContentRenderObject.matrix=n),this._layerContentRenderObject.colorTransform=e,this._layerContentRenderObject},t._notifyDrawFrame=function(){this._notifyOnEnterFrame(),this._drawVectorGraphics()},t._notifyResizeView=function(){},t._dispatchTouchEvent=function(t){for(var e=t,i=e.getChangedPointers(),n=i.length,r=0;n>r;r++)this._dispatchTouchEventWithChangedTouchPointer(e,i[r])},t._dispatchTouchEventWithChangedTouchPointer=function(t,e){var i=this._layer._getMatrix(),n=this._layer._getContentMatrix();n.concat(i),n.invert();var r=n.transformPoint(new Point(e.x,e.y)),s=this,h=s._hitTestStrictInternal(r);h||(h=this);var l=h,c=l.globalToLocal(r),_=[];_.push(l);for(var f=l.parent;f;)_.unshift(f),f=f.parent;var d="";switch(t.getAction()){case o.DOWN:d="touchBegin";break;case o.MOVE:d="touchMove";break;case o.UP:d="touchEnd";break;case o.CANCEL:default:d="touchEnd"}0>=Object.keys(this._touchPointerStateDictionary).length&&(this._primaryTouchId=e.id);var g=this._primaryTouchId==e.id,m=new a(d,!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var p=null,h=this._touchPointerStateDictionary[e.id];switch(h&&(p=h,delete this._touchPointerStateDictionary[e.id]),t.getAction()){case o.DOWN:var v=u.create(e.id,l,l);this._touchPointerStateDictionary[e.id]=v;var m=new a("touchOver",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);for(var x=_.length,w=0;x>w;w++){var m=new a("touchRollOver",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);_[w].dispatchEvent(m)}break;case o.MOVE:var v=u.create(e.id,p&&p.beganFrom?p.beganFrom:null,l);if(this._touchPointerStateDictionary[e.id]=v,p&&p.overNow==l)break;var m=new a("touchOut",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var m=new a("touchOver",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var b=-1,s=l,y=[],T=[];if(p&&p.overNow){T=p.overNow._getNodesToRoot();for(var R=T.length;-1==b;){y.push(s);for(var w=0;R>w;w++)if(T[w]==s){b=w;break}if(s=s.parent,!s)break}}if(-1==b)break;for(var w=b-1;w>=0;w--){var m=new a("touchRollOut",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);T[w].dispatchEvent(m)}for(var C=y.length,w=0;C>w;w++){var m=new a("touchRollOver",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);y[w].dispatchEvent(m)}break;case o.UP:case o.CANCEL:default:var m=new a("touchOut",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r),S=[];if(p&&p.overNow){S.push(p.overNow);for(var f=p.overNow.parent;f;)S.unshift(f),f=f.parent;m._setTarget(p.overNow)}for(var x=S.length,w=0;x>w;w++){var m=new a("touchRollOut",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);S[w].dispatchEvent(m)}if(t.getAction()!=o.CANCEL&&p&&p.beganFrom&&p.beganFrom===l){var m=new a("touchTap",!0,!0,e.id,g,c.x,c.y)._setStagePoint(r);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_)}this._primaryTouchId==e.id&&(this._primaryTouchId=-1)}},t.toString=function(){return'[object Stage stageWidth="'+this.stageWidth+'" stageHeight="'+this.stageHeight+'"]'}}),l=function(t){t=t||{},this.parent=t.parent||new r,this.offScreenRenderingRequests=t.offScreenRenderingRequests||[],this.renderingRequests=t.renderingRequests||[]};l.prototype={clone:function(){return new l(this)}};var c=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this.visitor=this.visitor=new l,this.visitor.parent=new r,this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.matrix=new Matrix,this.colorTransform=new ColorTransform,this.root=null},t.processData=function(){var t=new Matrix(1/i.getWidth(),0,0,1/i.getHeight(),0,0);t.scale(2,-2),t.translate(-1,1);var e=this.matrix.clone();e.concat(t),this.visitor.parent._matrix._getVersion()!==e._getVersion()?(this.visitor.parent.setMatrix(e),this.visitor.parent.concatenatedMatrix=this.visitor.parent.getMatrix(),this.visitor.parent.concatenatedMatrixIsUpdated=!0):(this.visitor.parent.setMatrix(e),this.visitor.parent.matrixIsUpdated=!1,this.visitor.parent.concatenatedMatrixIsUpdated=!1),this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=this.root.visit(this.visitor.clone())},t.renderOffscreen=function(){},t.render=function(){var t=s.getInstance();t.begin();for(var e=this.visitor.renderingRequests,i=e.length,n=0;i>n;n++)t.render(e[n]);t.end()}}),u={create:function(t,e,i){return{pointerId:t,beganFrom:e,overNow:i}}};return h}),herlock.define("module/view/gl/tile/TextureImageInfo",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this.area=new Rectangle,this.reset()},t.textureObject=null,t.area=null,t.tiles=null,t.numOfTiles=null,t.resetTiles=function(t){this.numOfTiles=t,null!=this.tiles&&delete this.tiles,this.tiles=Array(t)},t.clearTiles=function(){null!=this.tiles&&delete this.tiles,this.tiles=null,this.numOfTiles=0},t.reset=function(){for(var t=this.numOfTiles-1;t>=0;t--)this.tiles[t].client==this&&this.tiles[t].reset();this.textureObject=null,this.area.setEmpty(),this.clearTiles()},t.checkTileClients=function(){if(null==this.textureObject)return!1;for(var t=this.numOfTiles;--t>-1;)if(this.tiles[t].client!=this)return!1;return!0},t.isEmpty=function(){return null==this.textureObject},t.getTextureObject=function(){return this.textureObject},t.onUse=function(){for(var t=this.numOfTiles-1;t>-1;--t)this.tiles[t].setDemand(1e4)}});return e}),herlock.define("module/view/gl/GLUtil",[],function(){function t(){checkGlError("- before"),this._maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE),checkGlError("a getParameter"),this._maxVertexAttribs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS),checkGlError("b getParameter"),this._maxVertexUniformVectors=gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS),checkGlError("c getParameter"),this._maxFragmentUniformVectors=gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS),checkGlError("d getParameter"),this._maxVaryingVectors=gl.getParameter(gl.MAX_VARYING_VECTORS),checkGlError("e getParameter"),this._maxVertexTextureImageUnits=gl.getParameter(gl.MAX_VARYING_VECTORS),checkGlError("f getParameter"),this._maxTextureImageUnits=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),checkGlError("g getParameter"),this._maxRenderBufferSize=gl.getParameter(gl.MAX_RENDERBUFFER_SIZE),checkGlError("h getParameter"),this._shaderVersion=gl.getParameter(gl.SHADING_LANGUAGE_VERSION),checkGlError("i getParameter"),this._vendor=gl.getParameter(gl.VENDOR),checkGlError("j getParameter"),this._renderer=gl.getParameter(gl.RENDERER),checkGlError("k getParameter"),this._version=gl.getParameter(gl.VERSION),checkGlError("l getParameter")}var e={getInfo:function(){return this._info||(this._info=new t),this._info},checkGlError:function(t){for(var e=gl.getError();e;e=gl.getError())console.error("ndk_gl after "+t+"() glError"),console.error("ndk_gl       error:"+e)}};return t.prototype=Object.create({},{maxTextureSize:{get:function(){return this._maxTextureSize}},maxVertexAttribs:{get:function(){return this._maxVertexAttribs}},maxVertexUniformVectors:{get:function(){return this._maxVertexUniformVectors}},maxFragmentUniformVectors:{get:function(){return this._maxFragmentUniformVectors}},maxVaryingVectors:{get:function(){return this._maxVaryingVectors}},maxVertexTextureImageUnits:{get:function(){return this._maxVertexTextureImageUnits}},maxTextureImageUnits:{get:function(){return this._maxTextureImageUnits}},maxRenderBufferSize:{get:function(){return this._maxRenderBufferSize}},shaderVersion:{get:function(){return this._shaderVersion}},vendor:{get:function(){return this._vendor}},renderer:{get:function(){return this._renderer}},version:{get:function(){return this._version}},getOptimumTextureSize:{value:function(){return this.maxTextureSize>=4096?2048:this.maxTextureSize}}}),e}),herlock.define("module/view/gl/tile/Tile",["lib/Class"],function(){function t(t){this.texture._setTileDemand(this.offsetX,this.offsetY,t)}function e(){this.setDemand(0),this.client=null}var i={create:function(i){return{texture:i,index:-1,offsetX:0,offsetY:0,setDemand:t,client:null,reset:e}}};return i}),herlock.define("module/view/gl/tile/TileTextureObject",["lib/Class","../TextureObject","./Tile"],function(t,e,i){var n=64,r=1,s=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._tiles=Array(n*n),this._demands=Array(n*n);for(var t=n*n,r=0;t>r;r++)this._demands[r]=0;for(var r=0;t>r;r++){var s=this._tiles[r]=i.create(this);s.index=r,s.offsetX=r%n,s.offsetY=Math.floor(r/n)}this._workspace=new Uint8Array(4*Math.max(this.getWidth(),this.getHeight()))},t._search=function(t,e,i){for(var r=t*e,s=0;n-(e-1)>s;s++)for(var o=0;n-(t-1)>o;o++)if(!(this._getTileDemand(o,s)>=i)){for(var a=!0,h=0;r>h;h++){var l=h%t,c=Math.floor(h/t);if(a=a&&i>this._getTileDemand(o+l,s+c),1!=a)break}if(a)return o+s*n}return-1},t.allocate=function(t,e,i){var s=this._coordToOffsetTileX(t.width+2*r),o=this._coordToOffsetTileY(t.height+2*r),a=this._search(s,o,i);if(0>a)return!1;e.textureObject=this,e.area.x=this._tileIndexToCoordX(a)+r,e.area.y=this._tileIndexToCoordY(a)+r,e.area.width=t.width,e.area.height=t.height;var h=a%n,l=Math.floor(a/n),c=s*o;e.resetTiles(c);for(var u=0;c>u;u++){var _=u%s,f=Math.floor(u/s),d=this._getTileByOffset(h+_,l+f);d.client=e,this._setTileDemand(h+_,l+f,1),e.tiles[u]=d}return!0},t.putImage=function(t,e,i,n,r){this.subImage2D(t,e-1,i,1,r.subarray(0,4*i)),this.subImage2D(t,e+n,i,1,r.subarray(4*i*(n-1)));var s=this._workspace,o=r,a=0;s[0]=o[0+a],s[1]=o[1+a],s[2]=o[2+a],s[3]=o[3+a];for(var h=n-1;h>=0;h--){var l=4*(h+1),c=4*h;s[l+0]=o[0+i*c+a],s[l+1]=o[1+i*c+a],s[l+2]=o[2+i*c+a],s[l+3]=o[3+i*c+a]}s[4*(n+1)+0]=o[0+4*i*(n-1)+a],s[4*(n+1)+1]=o[1+4*i*(n-1)+a],s[4*(n+1)+2]=o[2+4*i*(n-1)+a],s[4*(n+1)+3]=o[3+4*i*(n-1)+a],this.subImage2D(t-1,e-1,1,n+2,s.subarray(0,4*(n+2))),a=4*(i-1),s[0]=o[0+a],s[1]=o[1+a],s[2]=o[2+a],s[3]=o[3+a];for(var h=n-1;h>=0;h--){var l=4*(h+1),c=4*h;s[l+0]=o[0+i*c+a],s[l+1]=o[1+i*c+a],s[l+2]=o[2+i*c+a],s[l+3]=o[3+i*c+a]}s[4*(n+1)+0]=o[0+4*i*(n-1)+a],s[4*(n+1)+1]=o[1+4*i*(n-1)+a],s[4*(n+1)+2]=o[2+4*i*(n-1)+a],s[4*(n+1)+3]=o[3+4*i*(n-1)+a],this.subImage2D(t+i,e-1,1,n+2,s.subarray(0,4*(n+2))),this.subImage2D(t,e,i,n,r)},t.onNextFrame=function(){for(var t=n*n,e=0;t>e;e++)this._demands[e]-=25},t._tileIndexToCoordX=function(t){return t%n/n*this.getWidth()},t._tileIndexToCoordY=function(t){return Math.floor(t/n)/n*this.getHeight()},t._coordToOffsetTileX=function(t){return Math.ceil(t/this.getWidth()*n)},t._coordToOffsetTileY=function(t){return Math.ceil(t/this.getWidth()*n)},t._getTileByCoords=function(t,e){return this._tiles[this._coordToOffsetTileX(t)+this._coordToOffsetTileY(e)*n]},t._getTileByOffset=function(t,e){return this._tiles[t+e*n]},t._getTileDemand=function(t,e){return this._demands[t+e*n]},t._setTileDemand=function(t,e,i){this._demands[t+e*n]=i}});return s}),herlock.define("module/view/gl/tile/TileTextureManager",["lib/Class","../GLUtil","./TileTextureObject"],function(t,e,i){var n=t(Object,function(t,n){t.constructor=function(){n.constructor.apply(this,arguments),this._textureSize=e.getInfo().getOptimumTextureSize(),this._textures=[],this._imageTextures=[]},t.getTextureObjectById=function(t){for(var e=0;this._textures.length>e;e++)if(this._textures[e].getId()==t)return this._textures[e];return null},t.getTextureObjectByIndex=function(t){return t>=this._textures.length?null:this._textures[t]},t.getNumOfTixtures=function(){return this._textures.length},t.onNextFrame=function(){for(var t=this._textures.length,e=0;t>e;e++)this._textures[e].onNextFrame()},t.allocateImageArea=function(t,e){if(t.width>this._textureSize||t.height>this._textureSize)return console.error("max image size: "+textureSize);for(var n=1e3,r=1e3,s=7e3,o=n,a=!1;e.area.isEmpty();){for(var h=this._imageTextures.length,l=h-1;l>=0;l--){var c=this._imageTextures[l];if(a=c.allocate(t,e,o))break}if(a)break;if(o+=r,o>=s){console.log("nj alloc texture.");var c=new i(this._textureSize,this._textureSize);this._textures.push(c),this._imageTextures.push(c),o=n
}}},t.reset=function(){for(var t=this._textures.size(),e=0;t>e;e++){var i=this._textures[e];delete i}this._textures.clear(),this._imageTextures.clear()}});return n.getInstance=function(){return this._singleton||(this._singleton=new n),this._singleton},n}),herlock.define("module/view/gl/tile/SubImageHandle",["lib/Class","module/view/geom/Rectangle","./TextureImageInfo","./TileTextureManager"],function(t,e,i,n){var r=t(Object,function(t,r){t.constructor=function(){r.constructor.apply(this,arguments),this._client=null,this._renderingInfo=new i,this._rect=new e},t.set=function(t){this._free(),this._client=t,this._client&&(this._rect.width=this._client.width(),this._rect.height=this._client.height())},t.getTextureImageInfo=function(){return 1!=this._check()&&(this._allocate(),this._renderingInfo.isEmpty()&&console.error("getTextureImageInfo.allocate texture failed")),this._renderingInfo.onUse(),this._renderingInfo},t.refTextureImageInfo=function(){return this._renderingInfo},t.isEmpty=function(){return this._rect.isEmpty()},t.isNotEmpty=function(){return 1!=this._rect.isEmpty()},t.reset=function(){this._rect.setEmpty(),this._renderingInfo.reset()},t._check=function(){return this._renderingInfo.checkTileClients()},t._free=function(){this._renderingInfo.reset()},t._allocate=function(){if(this._free(),n.getInstance().allocateImageArea(this._rect,this._renderingInfo),null==this._renderingInfo.getTextureObject()&&console.error("ImageTextureHandle::allocate texture failed"),this._client){var t=this._renderingInfo.area;this._renderingInfo.textureObject.putImage(t.x,t.y,t.width,t.height,this._client.getData())}}});return r}),herlock.define("module/view/flash/display/BitmapData",["lib/Class","module/graphics/BitmapProxy","module/view/gl/tile/SubImageHandle"],function(t,e,i){function n(t){return"number"==typeof t}function r(t){return"boolean"==typeof t}var s=t(Object,function(t,s){t.constructor=function(){s.constructor.apply(this,arguments);var t=arguments,o=arguments.length,a=null;if(o>=2&&n(t[0])&&n(t[1])){var h=t[0],l=t[1],c=2046;if(h>=c||l>=c)throw Error("Argument Error. over limit size!! please 2046 > size.");a=e.create(h,l);var u=!0,_=4294967295;o>=3&&r(t[2])&&(u=t[2]),o>=4&&n(t[3])&&(_=t[3]);var f=a.getCanvas();f.setFillColor(_),f.fillRect(0,0,h,l)}else{if(!(o>=1&&t[0].isInstanceOf&&t[0].isInstanceOf(Image)))throw Error("Argument Error");a=t[0]._getBitmap()}this._bitmapProxy=a,this._textureImageHandle=new i,this._textureImageHandle.set(a)},t.width={get:function(){return this._bitmapProxy?this._bitmapProxy.width():0}},t.height={get:function(){return this._bitmapProxy?this._bitmapProxy.height():0}},t.transparent={get:function(){return!0}},t.rect={get:function(){return new Rectangle(0,0,this.width,this.height)}},t.dispose=function(){this._bitmapProxy=null,this._textureImageHandle.reset()},t._notifyEnterFrame=function(){},t._notifyFrameConstructed=function(){},t._notifyExecuteFrameScript=function(){},t._notifyExitFrame=function(){},t._notifyDrawVectorGraphics=function(){},t._glPrepare=function(){this._textureImageHandle.isEmpty()||this._textureImageHandle.isEmpty()||this._textureImageHandle.getTextureImageInfo()},t._notifyUpdateForBitmap=function(){},t._getTextureImageInfo=function(){return this._textureImageHandle.getTextureImageInfo()},t._getTextureImageHandle=function(){return this._textureImageHandle},t.toString=function(){return'[object BitmapData width="'+this.width+'" height="'+this.height+'"]'}});return s}),herlock.define("module/view/flash/internal/renderer/SubImageRenderingObject",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this.vertexes=Array(24)},t.textureId=-1,t.textureHandle=null,t.colorTransform=null,t.blendMode=null,t.maskNode=null,t.vertexes=null,t.getTextureId=function(){return this.textureId}});return e}),herlock.define("module/view/flash/display/Bitmap",["lib/Class","./DisplayObject","module/view/flash/internal/renderer/RenderingNode","module/view/flash/internal/renderer/SubImageRenderingObject","module/view/gl/TextureObject"],function(t,e,i,n,r){var s=t(e,function(t,i){t.constructor=function(t,e,n,r){i.constructor.apply(this,arguments);var s=arguments.length;this._bitmapData=t,this._pixelSnapping=s>1?e:!1,this._smoothing=s>2?n:!1,this._clippingRect=s>3?r:new Rectangle},t.bitmapData={get:function(){return this._bitmapData},set:function(t){null!=this._bitmapData&&(this._bitmapData=null),null!=t&&(this._bitmapData=t),this._requestCalcNaturalRect()}},t.setClippingRect=function(t){this._clippingRect=t,this._requestCalcNaturalRect()},t._calculateNaturalRect=function(){return null==this.bitmapData?(this._naturalRect.setEmpty(),void 0):this._clippingRect.isEmpty()?(this._naturalRect.width=this.bitmapData.width,this._naturalRect.height=this.bitmapData.height,void 0):(this._naturalRect.width=this._clippingRect.width,this._naturalRect.height=this._clippingRect.height,void 0)},t._glPrepare=function(t){var i=this._getRenderingNode();if(i.children=[],null==this.bitmapData)return e.prototype._glPrepare.call(this,t);this.bitmapData._glPrepare(),i.scale9Grid=this.scale9Grid,i.clippingRect=this._clippingRect,i.textureImageHandle=this.bitmapData._getTextureImageHandle();var n=i.textureImageHandle.getTextureImageInfo();return i.textureId=n.getTextureObject().getId(),e.prototype._glPrepare.call(this,t)},t._createRenderingNode=function(){return new o},t.toString=function(){return'[object Bitmap name="'+this.name+'"]'}}),o=t(i,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._renderingObjects=[new n,new n,new n,new n,new n,new n,new n,new n,new n]},t.clippingRect=null,t.textureImageHandle=null,t.textureId=null,t.scale9Grid=null,t.setMatrix=function(t){e.setMatrix.call(this,t)},t.visit=function(t){if(this.textureImageHandle&&!this.textureImageHandle.isEmpty()){if(!this._visible||!t.parent.concatenatedVisible)return i.prototype.visit.call(this,t),void 0;this.scale9Grid.isEmpty()&&i.prototype.visit.call(this,t);var e=this.textureImageHandle.getTextureImageInfo(),n=r.getById(this.textureId),s=this.concatenatedMatrix.clone(),o=n.getWidth(),a=n.getHeight();if(this.scale9Grid.isEmpty()){var h=this._renderingObjects[0],l=e.area.clone();h.textureHandle=this.textureImageHandle,h.textureId=this.textureId,h.blendMode=this.concatenatedBlendMode,h.maskNode=this.concatenatedMask,h.colorTransform=this.concatenatedColorTransform,this.clippingRect.isEmpty()!==!0&&(l.x+=this.clippingRect.x,l.y+=this.clippingRect.y,l.width=this.clippingRect.width,l.height=this.clippingRect.height);var c=[s.transformPoint(new Point(0,0)),s.transformPoint(new Point(0,l.height)),s.transformPoint(new Point(l.width,0)),s.transformPoint(new Point(l.width,l.height))];return h.vertexes[0]=c[0].x,h.vertexes[1]=c[0].y,h.vertexes[2]=l.left/o,h.vertexes[3]=l.top/a,h.vertexes[4]=c[1].x,h.vertexes[5]=c[1].y,h.vertexes[6]=l.left/o,h.vertexes[7]=l.bottom/a,h.vertexes[8]=c[2].x,h.vertexes[9]=c[2].y,h.vertexes[10]=l.right/o,h.vertexes[11]=l.top/a,h.vertexes[12]=c[1].x,h.vertexes[13]=c[1].y,h.vertexes[14]=l.left/o,h.vertexes[15]=l.bottom/a,h.vertexes[16]=c[3].x,h.vertexes[17]=c[3].y,h.vertexes[18]=l.right/o,h.vertexes[19]=l.bottom/a,h.vertexes[20]=c[2].x,h.vertexes[21]=c[2].y,h.vertexes[22]=l.right/o,h.vertexes[23]=l.top/a,[h]}var u=0,_=e.area.width,f=e.area.height,d=0;1!=this.clippingRect.isEmpty()&&(u=0,_=this.clippingRect.width,f=this.clippingRect.height,d=0);var g=this.scale9Grid.top,m=this.scale9Grid.right,p=this.scale9Grid.bottom,v=this.scale9Grid.left,x=(_-d)*this.getMatrix()._getScaleX()-(v-d)-(_-m),w=(f-u)*this.getMatrix()._getScaleY()-(g-u)-(f-p),b=new Matrix,y=new Matrix;b.scale(x/this.scale9Grid.width,1),y.scale(1,w/this.scale9Grid.height);var T=[new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle,new Rectangle],R=[new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix,new Matrix],C=T[0],S=T[1],E=T[2],M=T[3],P=T[4],O=T[5],k=T[6],I=T[7],A=T[8];C._set(d,u,v-d,g-u),S._set(v,u,m-v,g-u),E._set(m,u,_-m,g-u),M._set(d,g,v-d,p-g),P._set(v,g,m-v,p-g),O._set(m,g,_-m,p-g),k._set(d,p,v-d,f-p),I._set(v,p,m-v,f-p),A._set(m,p,_-m,f-p);var F=this.getMatrix().clone();F._setScaleX(1),F._setScaleY(1),F.concat(t.parent.concatenatedMatrix);var N=F,V=R[0];V.concat(N);var D=R[1];D.concat(b),D.translate(S.x,S.y),D.concat(N);var L=R[2];L.translate(S.x+x,E.y),L.concat(N);var q=R[3];q.concat(y),q.translate(M.x,M.y),q.concat(N);var B=R[4];B.concat(b),B.concat(y),B.translate(P.x,P.y),B.concat(N);var j=R[5];j.concat(y),j.translate(P.x+x,O.y),j.concat(N);var Y=R[6];Y.translate(M.x,M.y+w),Y.concat(N);var X=R[7];X.concat(b),X.translate(I.x,P.y+w),X.concat(N);var U=R[8];if(U.translate(I.x+x,O.y+w),U.concat(N),!this.clippingRect.isEmpty()){var H=new Point(this.clippingRect.x,this.clippingRect.y);C.offsetPoint(H),S.offsetPoint(H),E.offsetPoint(H),M.offsetPoint(H),P.offsetPoint(H),O.offsetPoint(H),k.offsetPoint(H),I.offsetPoint(H),A.offsetPoint(H)}i.prototype.visit.call(this,t);for(var G=[],W=0;9>W;W++){var h=this._renderingObjects[W],s=R[W],z=T[W];if(!z.isEmpty()){var l=e.area.clone();h.textureHandle=this.textureImageHandle,h.textureId=this.textureId,h.blendMode=this.blendMode,h.maskNode=this.mask,h.colorTransform=this.concatenatedColorTransform,1!=z.isEmpty()&&(l.x+=z.x,l.y+=z.y,l.width=z.width,l.height=z.height);var c=[s.transformPoint(new Point(0,0)),s.transformPoint(new Point(0,l.height)),s.transformPoint(new Point(l.width,0)),s.transformPoint(new Point(l.width,l.height))];h.vertexes[0]=c[0].x,h.vertexes[1]=c[0].y,h.vertexes[2]=l.left/o,h.vertexes[3]=l.top/a,h.vertexes[4]=c[1].x,h.vertexes[5]=c[1].y,h.vertexes[6]=l.left/o,h.vertexes[7]=l.bottom/a,h.vertexes[8]=c[2].x,h.vertexes[9]=c[2].y,h.vertexes[10]=l.right/o,h.vertexes[11]=l.top/a,h.vertexes[12]=c[1].x,h.vertexes[13]=c[1].y,h.vertexes[14]=l.left/o,h.vertexes[15]=l.bottom/a,h.vertexes[16]=c[3].x,h.vertexes[17]=c[3].y,h.vertexes[18]=l.right/o,h.vertexes[19]=l.bottom/a,h.vertexes[20]=c[2].x,h.vertexes[21]=c[2].y,h.vertexes[22]=l.right/o,h.vertexes[23]=l.top/a,G.push(h)}}return G}},t.getBoundingBox=function(t){var e=this.textureImageHandle.getTextureImageInfo(),i=this.concatenatedMatrix,n=e.area.clone();this.clippingRect.isEmpty()!==!0&&(n.width=this.clippingRect.width,n.height=this.clippingRect.height),n.x=0,n.y=0;var r=i._calculateBoundsRect(n),s=t.union(r);t._set(s.x,s.y,s.width,s.height)}});return s}),herlock.define("module/view/flash/text/TextFormat",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(t,i,n,r,s,o,a,h,l,c,u,_,f){e.constructor.apply(this,arguments);var d=arguments.length;d>=1&&(this.font=t),d>=2&&(this.size=i),d>=3&&(this.color=n),d>=4&&(this.bold=r),d>=5&&(this.italic=s),d>=6&&(this.underline=o),d>=7&&(this.url=a),d>=8&&(this.target=h),d>=9&&(this.align=l),d>=10&&(this.leftMargin=c),d>=11&&(this.rightMargin=u),d>=12&&(this.indent=_),d>=13&&(this.leading=f)},t.align="left",t.blockIndent=0,t.bold=!1,t.color=0,t.font="",t.indent=0,t.italic=!1,t.kerning=!1,t.leading=0,t.leftMargin=0,t.letterSpacing=0,t.rightMargin=0,t.size=12,t.underline=!1,t.toString=function(){return"[object TextFormat]"}});return e}),herlock.define("module/view/flash/text/TextFieldAutoSize",[],function(){var t={NONE:"none",CENTER:"center",LEFT:"left",RIGHT:"right"};return t}),herlock.define("module/view/flash/text/TextFormatAlign",[],function(){var t={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"};return t}),herlock.define("module/view/flash/text/TextField",["lib/Class","../display/InteractiveObject","./TextFormat","./TextFieldAutoSize","./TextFormatAlign","module/graphics/BitmapProxy","module/view/flash/internal/renderer/RenderingNode","module/view/flash/internal/renderer/SubImageRenderingObject","module/view/gl/TextureObject","module/view/gl/tile/SubImageHandle"],function(t,e,i,n,r,s,o,a,h,l){function c(t,e){return 16777216*parseInt(255*e)+t}var u=2,_=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._text="",this._drawTextRequested=!0,this._calcTextRequested=!0,this._bitmapProxy=null,this._textureImageHandle=null,this._autoSize=n.NONE,this._background=!1,this._backgroundColor=16777215,this._border=!1,this._borderColor=0,this._defaultTextFormat=null,this._multiline=!1,this._wordWrap=!1,this._scrollH=0,this._scrollV=0,this._maxScrollH=0,this._maxScrollV=0,this._maxChars=0,this._bottomScrollV=0,this._naturalRect.height=100,this._naturalRect.width=100,this._defaultTextFormat=new i,this._bitmapProxy=s.create(10,10),this._textureImageHandle=new l},t.autoSize={get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this._requestCalcNaturalRect())}},t.background={get:function(){return this._background},set:function(t){this._background!=t&&(this._background=t,this._requestCalcAndDrawText())}},t.backgroundColor={get:function(){return this._backgroundColor},set:function(t){this._backgroundColor!=t&&(this._backgroundColor=t,this._requestCalcAndDrawText())}},t.border={get:function(){return this._border},set:function(t){this._border!=t&&(this._border=t,this._requestCalcAndDrawText())}},t.borderColor={get:function(){return this._borderColor},set:function(t){this._borderColor!=t&&(this._borderColor=t,this._requestCalcAndDrawText())}},t.bottomScrollV={get:function(){return this._bottomScrollV}},t.defaultTextFormat={get:function(){return this._defaultTextFormat},set:function(t){null!=this._defaultTextFormat&&(delete this._defaultTextFormat,this._defaultTextFormat=null),this._defaultTextFormat=t,this._requestCalcAndDrawText()}},t.length={get:function(){return this._text.length}},t.maxChars={get:function(){return this._maxChars},set:function(t){this._=t}},t.maxScrollH={get:function(){return this._maxScrollH}},t.maxScrollV={get:function(){return this._maxScrollV}},t.multiline={get:function(){return this._multiline},set:function(t){this._multiline!=t&&(this._multiline=t,this._requestCalcAndDrawText())}},t.numLines={get:function(){return this._calcTextRequested&&this._calcText(),this._numOfLines}},t.scrollH={get:function(){return this._scrollH},set:function(t){this._scrollH=t,this._requestCalcAndDrawText()}},t.scrollV={get:function(){return this._scrollV},set:function(t){this._scrollV=t,this._requestCalcAndDrawText()}},t.text={get:function(){return this._text},set:function(t){this._text!==t&&(this._text=t,this._requestCalcAndDrawText(),this._requestCalcNaturalRect())}},t.textColor={get:function(){return this._defaultTextFormat.color},set:function(t){this._defaultTextFormat.color=t,this._requestCalcAndDrawText()}},t.textHeight={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.h}},t.textWidth={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.w}},t.type={get:function(){return this._type},set:function(t){this._type=t}},t.wordWrap={get:function(){return this._wordWrap},set:function(t){this._wordWrap=t,this._requestCalcAndDrawText()}},t.appendText=function(t){this._text+=t,this._requestCalcAndDrawText()},t.getTextFormat=function(){return this._defaultTextFormat},t.setTextFormat=function(t){this._defaultTextFormat&&(this._defaultTextFormat=null),this._defaultTextFormat=t,this._requestCalcAndDrawText()},t.height={get:function(){return this._getBoundsRect().height},set:function(t){this._naturalRect.height!=t&&(this._naturalRect.height=t,this._requestCalcNaturalRect())}},t.width={get:function(){return this._getBoundsRect().width},set:function(t){this._naturalRect.width!=t&&(this._naturalRect.width=t,this._requestCalcNaturalRect())}},t._requestCalcAndDrawText=function(){this._drawTextRequested=!0,this._calcTextRequested=!0},t._drawVectorGraphics=function(){},t._glPrepare=function(t){if(this._drawTextRequested&&(this._drawText(),this._textureImageHandle.set(this._bitmapProxy)),this._textureImageHandle.isEmpty())return null;var i=this._getRenderingNode(),n=this._textureImageHandle.getTextureImageInfo();return i.textureImageHandle=this._textureImageHandle,i.textureId=n.getTextureObject().getId(),e._glPrepare.call(this,t)},t._calculateNaturalRect=function(){switch(this._calcTextRequested&&this._calcText(),this._defaultTextFormat,this._autoSize){case n.NONE:break;case n.LEFT:var t=new Rectangle;t.width=this._textRect.width+2*u+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*u,this._naturalRect=t;break;case n.CENTER:var e=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+2*u+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*u,this._naturalRect=t,this.x=this.x+(e-t.width)/2;break;case n.RIGHT:var e=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+2*u+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*u,this._naturalRect=t,this.x=this.x+(e-t.width)}},t._requestCalcNaturalRect=function(t){t||(this._requestCalcAndDrawText(),e._requestCalcNaturalRect.call(this,t))},t._drawText=function(){var t=this._getMatrix();if(0!=t._getScaleX()&&0!=t._getScaleY()){var e=this._getNaturalRect(),i=new Rectangle(0,0,t._getScaleX()*e.width,t._getScaleY()*e.height);this._drawTextRequested=!1,this._bitmapProxy&&i.width==this._bitmapProxy.width()&&i.height==this._bitmapProxy.height()||(this._bitmapProxy=s.create(i.width,i.height));var n=this._bitmapProxy.getCanvas();this._background?(n.setFillColor(c(this._backgroundColor,1)),n.fillRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())):n.clear(),this._border&&(n.setStrokeColor(c(this._borderColor,1)),n.strokeRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())),n.setFillColor(c(this._defaultTextFormat.color,1)),n.setFontSize(this._defaultTextFormat.size*t._getScaleY()),n.setLetterSpacing(this._defaultTextFormat.letterSpacing);for(var o=this._calcTextLinePositions(),a=n.getFontMetrics(),h=a.ascent,l=a.descent,_=this._defaultTextFormat.leading,f=u+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,d=u,g=o.length,m=0;g>m;m+=2){var p=o[m],v=o[m+1];if(!(0>p)){var x=this.text.substring(p,v+1);switch(f=u+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,(0==m||o[m-1]+1!=p)&&(f+=this._defaultTextFormat.indent),this._defaultTextFormat.align){case r.LEFT:break;case r.CENTER:var w=n.measureText(x);f+=(i.width-f-this._defaultTextFormat.rightMargin-w)/2;break;case r.RIGHT:var w=n.measureText(x);f+=i.width-f-this._defaultTextFormat.rightMargin-w;break;case r.JUSTIFY:}d=m/2*(-h+l+_),n.fillText(f,d,x)}}}},t._calcText=function(){calcTextRequested=!1;var t=this._getMatrix(),e=this._calcTextLinePositions(),i=this._bitmapProxy.getCanvas();if(i.setFontSize(this._defaultTextFormat.size*t._getScaleY()),i.setLetterSpacing(this._defaultTextFormat.letterSpacing),this._textRect=new Rectangle,this._wordWrap)this._textRect.width=this._naturalRect.width-(2*u+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin);else for(var n=e.length,r=0;n>r;r+=2){var s=e[r],o=e[r+1];if(!(0>s)){var a=this._text.substring(s,o+1),h=i.measureText(a);h>this._textRect.width&&(this._textRect.width=h)}}var l=i.getFontMetrics(),c=l.ascent,_=l.descent,f=this._defaultTextFormat.leading,d=e.length/2;this._textRect.height=(-c+_)*d+f*(d-1)},t._calcTextLinePositions=function(){var t=this._text,e=[];e.push(0);var i;for(i=0;;){var n=t.indexOf("\r",i);if(-1==n)break;var r=n;t.length>r+1&&"\n"==t.charAt(r+1)?(e.push(r-1),e.push(r+2)):(e.push(r-1),e.push(r+1)),i=n+1}for(i=0;;){var n=t.indexOf("\n",i);if(-1==n)break;var r=n;r-1>=0&&"\r"!=t.charAt(r-1)&&(e.push(r-1),e.push(r+1)),i=n+1}if(e.push(t.length-1),e.sort(function(t,e){return t-e}),1!=this._wordWrap)return e;var s=this._getConcatenatedMatrix(),o=new Rectangle(u,u,2*-u+s._getScaleX()*this._naturalRect.width-this._defaultTextFormat.leftMargin-this._defaultTextFormat.blockIndent-this._defaultTextFormat.rightMargin,2*-u+s._getScaleY()*this._naturalRect.height),a=this._bitmapProxy.getCanvas();a.setFontSize(this._defaultTextFormat.size*s._getScaleY()),a.setLetterSpacing(this._defaultTextFormat.letterSpacing);for(var h=e.slice(),l=0;h.length>l;){var c=h[l];l++,-1==c&&(c=0);var _=h[l];h.length>l&&l++;for(var f=_-c+1,d=t.substring(c,_+1),g=a.breakText(d,o.width-this._defaultTextFormat.indent);f>g;){e.push(c+g-1),e.push(c+g),c+=g,f=_-c+1;var d=t.substring(c,_+1);if(g=a.breakText(d,o.width),g==f)break}}return e.sort(function(t,e){return t-e}),e},t._createRenderingNode=function(){return new f},t.toString=function(){return'[object TextField name="'+this.name+'"]'}}),f=t(o,function(t,e){t.textureImageHandle,t.textureId,t.object,t.constructor=function(){e.constructor.call(this),this.object=new a},t.visit=function(t){if(!this.textureImageHandle.isEmpty()&&(o.prototype.visit.call(this,t),this.concatenatedVisible)){var e=this.object;e.textureHandle=this.textureImageHandle,e.textureId=this.textureId,e.blendMode=this.concatenatedBlendMode,e.colorTransform=this.concatenatedColorTransform,e.maskNode=this.concatenatedMask;var i=this.textureImageHandle.getTextureImageInfo(),n=h.getById(this.textureId),r=this.concatenatedMatrix,s=n.getWidth(),a=n.getHeight(),l=i.area;return points=[r.transformPoint(new Point(0,0)),r.transformPoint(new Point(0,l.height)),r.transformPoint(new Point(l.width,0)),r.transformPoint(new Point(l.width,l.height))],e.vertexes[0]=points[0].x,e.vertexes[1]=points[0].y,e.vertexes[2]=l.left/s,e.vertexes[3]=l.top/a,e.vertexes[4]=points[1].x,e.vertexes[5]=points[1].y,e.vertexes[6]=l.left/s,e.vertexes[7]=l.bottom/a,e.vertexes[8]=points[2].x,e.vertexes[9]=points[2].y,e.vertexes[10]=l.right/s,e.vertexes[11]=l.top/a,e.vertexes[12]=points[1].x,e.vertexes[13]=points[1].y,e.vertexes[14]=l.left/s,e.vertexes[15]=l.bottom/a,e.vertexes[16]=points[2].x,e.vertexes[17]=points[2].y,e.vertexes[18]=l.right/s,e.vertexes[19]=l.top/a,e.vertexes[20]=points[3].x,e.vertexes[21]=points[3].y,e.vertexes[22]=l.right/s,e.vertexes[23]=l.bottom/a,[e]}}});return _}),herlock.define("module/view/flash/flash",["./display/DisplayObject","./display/InteractiveObject","./display/DisplayObjectContainer","./display/Sprite","./display/Stage","./display/BitmapData","./display/Bitmap","./text/TextField","./text/TextFieldAutoSize","./text/TextFormat","./geom/Transform","./events/InteractiveObjectTouchEvent"],function(t,e,i,n,r,s,o,a,h,l,c,u){var _={installTo:function(_){_.DisplayObject=t,_.InteractiveObject=e,_.DisplayObjectContainer=i,_.Sprite=n,_.Stage=r,_.BitmapData=s,_.Bitmap=o,_.TextField=a,_.TextFieldAutoSize=h,_.TextFormat=l,_.Transform=c,_.InteractiveObjectTouchEvent=u},initJs:function(t){t.Event.ENTER_FRAME="enterFrame",t.Event.EXIT_FRAME="exitFrame"}};return _}),herlock.define("module/view/geom/geom",["./Point","./Rectangle","./Matrix","./ColorTransform"],function(t,e,i,n){var r={installTo:function(r){r.Point=t,r.Rectangle=e,r.Matrix=i,r.ColorTransform=n},initJs:function(){}};return r});var gl;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,function(){var t=document.createElement("div").style,e={transform:"webkitTransform"in t?"webkitTransform":"MozTransform"in t?"MozTransform":"transform",transformOrigin:"webkitTransformOrigin"in t?"webkitTransformOrigin":"MozTransformOrigin"in t?"MozTransformOrigin":"transformOrigin"};if(!("transformOrigin"in t)){var i={};for(var n in e)(function(t,e){i[t]={get:function(){return this[e]},set:function(t){this[e]=t}}})(n,e[n]);Object.defineProperties(CSSStyleDeclaration.prototype,i)}}(),herlock.define("module/view/NJView",["lib/Class","module/NJModule","./window/window","./layer/Layer","./image/Image","./flash/flash","./geom/geom","module/view/gl/Viewport","./geom/Rectangle","module/view/gl/Shader","module/view/touch/TouchEventInfo"],function(t,e,i,n,r,s,o,a,h,l,c){function u(t){f=new h(t.getViewLeft(),t.getViewTop(),t.getViewWidth(),t.getViewHeight()),d=Math.min(t.getViewWidth(),t.getViewHeight())}function _(){null==p&&(p=new l,p.setVertexShaderCode("attribute highp vec4 a_pos;attribute vec4 a_col;varying vec4 v_col;void main(void) {  gl_Position = a_pos;  v_col = a_col;  gl_PointSize = 50.0;}"),p.setFragmentShaderCode("varying mediump vec4 v_col;void main (void) {  gl_FragColor = v_col;}"),p.build(),v=p.getAttributeLocation("a_pos"),x=p.getAttributeLocation("a_col"),p.activate(),gl.enableVertexAttribArray(v),checkGlError("glEnableVertexAttribArray"),gl.enableVertexAttribArray(x),checkGlError("glEnableVertexAttribArray")),gl.disable(gl.SCISSOR_TEST),checkGlError("glDisable"),gl.clear(gl.COLOR_BUFFER_BIT);for(var t=new a(f.x+(f.width-d)/2,f.y+(f.height-d)/2,d,d),e=a.BindScope(t),i=12,n=Array(7*i),r=0;i>r;r++){n[7*r+0]=.5*Math.cos(2*(r-w)*m/i),n[7*r+1]=.5*Math.sin(2*(r-w)*m/i),n[7*r+2]=0;var s=(i-r)/i*((i-r)/i);n[7*r+3]=s,n[7*r+4]=s,n[7*r+5]=s,n[7*r+6]=1}b||(b=gl.createBuffer()),gl.bindBuffer(gl.ARRAY_BUFFER,b),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(n),gl.STATIC_DRAW),p.activate(),gl.vertexAttribPointer(v,3,gl.FLOAT,!1,28,0),checkGlError("glVertexAttribPointer"),gl.vertexAttribPointer(x,4,gl.FLOAT,!1,28,12),checkGlError("glVertexAttribPointer"),gl.drawArrays(gl.POINTS,0,i),w++,e.unbind()}var f,d,g=t(e,function(t,e){t.constructor=function(t,i,n){e.constructor.apply(this,arguments),this._container=t,this._width=i,this._height=n,this._layers=[],this._canvas=document.createElement("canvas"),this._container.appendChild(this._canvas),this._canvas.width=i,this._canvas.height=n,gl=this._canvas.getContext("experimental-webgl",{alpha:!1}),gl.clearColor(0,0,0,1);var r=this;requestAnimationFrame(function(){r._onDrawFrame(),requestAnimationFrame(arguments.callee)});var s=!1,o=function(t){var e,i=!0;switch(t.type){case"mousedown":s=!0,e=c.DOWN;break;case"mousemove":if(!s)return;e=c.MOVE;break;case"mouseup":s=!1,e=c.UP,i=!1;break;case"mouseleave":if(!s)return;s=!1,e=c.CANCEL,i=!1}var n=new c(e);if(-1!==t.type.indexOf("mouse")){var o=t.offsetX,a=t.offsetY;if(1!="offsetX"in t&&(o=t.layerX-t.currentTarget.offsetLeft,a=t.layerY-t.currentTarget.offsetTop,""!==this.style.transform)){var h={x:o,y:a},l=this.style.transform,u=[];l.split(",").forEach(function(t){u.push(parseFloat(t))}),o=h.x*u[0]+h.y*u[2]+1*u[4],a=h.x*u[1]+h.y*u[3]+1*u[5]}n.addTouchPoint("mouse",o,a,!0,i)}r._notifyTouch(n)};this._canvas.addEventListener("mousemove",o),this._canvas.addEventListener("mouseup",o),this._canvas.addEventListener("mousedown",o),this._canvas.addEventListener("mouseleave",o)},t.getName=function(){return"View"},t.installTo=function(t){i.installTo(t,this),t.Layer=n,t.Image=r,s.installTo(t),o.installTo(t)},t.initJs=function(t){i.initJs(t),s.initJs(t),o.initJs(t)},t.start=function(){},t.reset=function(){},t.addLayer=function(t){return this.addLayerAt(t,this._layers.length)},t.addLayerAt=function(t,e){var i=t.isInstanceOf(n)?t:new n(t);return-1!=this.getLayerIndex(i)&&this.removeLayer(i),this._layers.splice(e,0,i),i._addedTo(this),i},t.getLayerAt=function(t){return this._layers[t]},t.getLayerIndex=function(t){return this._layers.indexOf(t)},t.removeLayer=function(t){return this.removeLayerAt(this._layers.indexOf(t))},t.removeLayerAt=function(t){var e=this.getLayerAt(t);return this._layers.splice(t,1),e},t.getViewWidth=function(){return this._width},t.getViewHeight=function(){return this._height},t.getViewTop=function(){return 0},t.getViewLeft=function(){return 0},t._onDrawFrame=function(){var t=this._glPrepare();gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),checkGlError("glClear"),this._glRender(t),this._notifyDrawFrame()},t._glPrepare=function(){if(0>=this._layers.length)return u(this);for(var t=this._layers.length,e=[],i=0;t>i;i++){var n=this._layers[i]._glPrepare();n&&e.push(n)}return e},t._glRender=function(t){if(0>=this._layers.length)return _(this);for(var e=t.length,i=0;e>i;i++)t[i].processData();for(var i=0;e>i;i++){var n=t[i];n.render()}},t._notifyDrawFrame=function(){for(var t in this._layers)this._layers[t]._notifyDrawFrame()},t._notifyTouch=function(t){for(var e=this._layers.slice(),i=e.length,n=0;i>n;n++)e[n]._notifyTouch(t)}}),m=Math.PI,p=null,v=-1,x=-1,w=0,b=null;return g}),herlock.define("module/view_css/window/window",[],function(){var t={installTo:function(t,e){t.addLayer=function(t){return e.addLayer(t)},t.addLayerAt=function(t,i){return e.addLayer(t,i)},t.getLayerAt=function(t){return e.getLayerAt(t)},t.getLayerIndex=function(t){return e.getLayerIndex(t)},t.removeLayer=function(t){return e.removeLayer(t)},t.removeLayerAt=function(t){return e.removeLayerAt(t)},t.innerWidth=e.getViewWidth();try{Object.defineProperties(t,{innerWidth:{get:function(){return e.getViewWidth()}},innerHeight:{get:function(){return e.getViewHeight()}}})}catch(i){console.log("SafariはinnerWidth,innerHeightが更新できません。"),t.innerWidth=e.getViewWidth(),t.innerHeight=e.getViewHeight()}t.setOrientationType=function(){}},initJs:function(){}};return t}),herlock.define("module/view_css/layer/Layer",["lib/Class","module/view/touch/TouchEventInfo"],function(t){var e=t(Object,function(t,n){t.constructor=function(t){n.constructor.apply(this,arguments),this._content=null,this._renderingObject=new i,this._calcRequested=!0,this._horizontalAlign=e.Align.CENTER,this._verticalAlign=e.Align.MIDDLE,this._scaleMode=e.ScaleMode.SHOW_ALL,this._colorTransform=new ColorTransform,this._backgroundColor=16777215,this._backgroundAlpha=0,this._offsetPercentX=0,this._offsetPercentY=0,this._module=null,this._matrix=new Matrix,this._contentMatrix=new Matrix,this._contentDisplayRect=new Rectangle,t&&(this.content=t)},t.content={get:function(){return this._content},set:function(t){null!=this._content&&this._content._onRemovedFrom(this),this._calcRequested=!0,this._content=t,null!=t&&this._content._onAddedTo(this)}},t.contentScaleX={get:function(){return this._getContentMatrix()._getScaleX()}},t.contentScaleY={get:function(){return this._getContentMatrix()._getScaleY()}},t.horizontalAlign={get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign=t,this._calcRequested=!0}},t.verticalAlign={get:function(){return this._verticalAlign},set:function(t){this._verticalAlign=t,this._calcRequested=!0}},t.scaleMode={get:function(){return this._scaleMode},set:function(t){this._scaleMode=t,this._calcRequested=!0}},t.offsetX={get:function(){return this._offsetPercentX},set:function(t){this._offsetPercentX=t,this._calcRequested=!0}},t.offsetY={get:function(){return this._offsetPercentY},set:function(t){this._offsetPercentY=t,this._calcRequested=!0}},t.alpha={get:function(){return this._colorTransform.getAlphaMultiplier()},set:function(t){this._colorTransform.getAlphaMultiplier(t)}},t.backgroundColor={get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t}},t.backgroundAlpha={get:function(){return this._backgroundAlpha},set:function(t){this._backgroundAlpha=t}},t._notifyDrawFrame=function(){this._content&&this._content._notifyDrawFrame()},t._addedTo=function(t){this._module=t,calcRequested=!0},t._removedFrom=function(){this._module=null},t._notifyResizeView=function(t,e){null!=this._content&&this._content._notifyResizeView(t,e),this._calcRequested=!0},t._notifyResizeContent=function(){this._calcRequested=!0},t._notifyTouch=function(t){this._content&&this._content._dispatchTouchEvent(t)},t._calculate=function(){if(null!=this._module&&null!=this._content){this._calcRequested=!1;var t=this._module.getViewWidth(),i=this._module.getViewHeight(),n=t/i,r=this._content._getContentWidth(),s=this._content._getContentHeight(),o=r/s;if(this._scaleMode==e.ScaleMode.EXACT_FIT)this._contentMatrix._setScaleX(t/r),this._contentMatrix._setScaleY(i/s);else if(this._scaleMode==e.ScaleMode.SHOW_ALL){var a;a=o>n?t/r:i/s,this._contentMatrix._setScaleX(a),this._contentMatrix._setScaleY(a)}else if(this._scaleMode==e.ScaleMode.NO_BORDER){var a;a=n>o?t/r:i/s,this._contentMatrix._setScaleX(a),this._contentMatrix._setScaleY(a)
}else this._scaleMode==e.ScaleMode.NO_SCALE&&(this._contentMatrix._setScaleX(1),this._contentMatrix._setScaleY(1));this._matrix._setX(t*this._offsetPercentX),this._matrix._setY(i*this._offsetPercentY),this._contentDisplayRect.width=this._content._getContentWidth()*this._contentMatrix._getScaleX(),this._contentDisplayRect.height=this._content._getContentHeight()*this._contentMatrix._getScaleY(),this._contentDisplayRect.x=this._matrix._getX(),this._contentDisplayRect.y=this._matrix._getY();var h=0,l=0;this._horizontalAlign==e.Align.LEFT?h+=0:this._horizontalAlign==e.Align.CENTER?h+=.5*(t-this._contentDisplayRect.width):this._horizontalAlign==e.Align.RIGHT&&(h+=1*(t-this._contentDisplayRect.width)),this._verticalAlign==e.Align.TOP?l+=0:this._verticalAlign==e.Align.MIDDLE?l+=.5*(i-this._contentDisplayRect.height):this._verticalAlign==e.Align.BOTTOM&&(l+=1*(i-this._contentDisplayRect.height)),this._contentDisplayRect.x+=h,this._contentDisplayRect.y+=l,this._contentMatrix._setX(h),this._contentMatrix._setY(l)}},t._getMatrix=function(){return this._calcRequested&&this._calculate(),this._matrix.clone()},t._getContentMatrix=function(){return this._calcRequested&&this._calculate(),this._contentMatrix.clone()},t._getContentDisplayRect=function(){return this._calcRequested&&this._calculate(),this._contentDisplayRect},t._glPrepare=function(){if(null==this._module)return null;if(null==this._content)return null;var t=new Matrix;return this._renderingObject.contentRenderingObject=this._content._glPrepare(t,this._colorTransform),this._renderingObject}});e.Align={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",LEFT:"left",CENTER:"center",RIGHT:"right",NONE:"none"},e.ScaleMode={EXACT_FIT:"exactFit",NO_BORDER:"noBorder",NO_SCALE:"noScale",SHOW_ALL:"showAll",MODE_NONE:"none"};var i=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.viewport=null,t.contentRenderingObject=null,t.processData=function(){this.contentRenderingObject&&this.contentRenderingObject.processData()},t.renderOffscreen=function(){},t.render=function(){this.contentRenderingObject&&this.contentRenderingObject.render()}});return e}),herlock.define("module/view_css/image/Image",["lib/Class","module/common/event/EventDispatcher","lib/URL","module/graphics/BitmapProxy"],function(t,e,i,n){var r=t(e,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._src="",this._bitmapProxy=null,t&&(this.src=t)},t.src={get:function(){this._src},set:function(t){this._src=t;var e=new i(t);this._image=null;var r=document.createElement("img"),s=window.__herlock_ctx,o=this;r.onload=function(){o._image=r,o._bitmapProxy=new n(o._image),o._dispatchEventAndCallHandler(new Event("load"))},r.src=""===e.host?s._rootPath+e:""+e}},t.complete={get:function(){}},t.width={get:function(){return this._image?this._image.width:0}},t.height={get:function(){return this._image?this._image.height:0}},t.naturalWidth={get:function(){return this._image?this._image.width:0}},t.naturalHeight={get:function(){return this._image?this._image.height:0}},t.onload=function(){},t.onerror=function(){},t._getBitmap=function(){return this._bitmapProxy}});return r}),herlock.define("module/view_css/flash/internal/renderer/RenderingNode",["lib/Class","module/view/flash/display/BlendMode","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(t,e,i,n){var r=t(Object,function(t,r){t.constructor=function(){r.constructor.apply(this,arguments),this._matrix=new i,this._colorTransform=new n,this.children=[],this.concatenatedMatrix=new i,this.concatenatedColorTransform=new n,this.concatenatedBlendMode="normal"},t.mask=null,t.visible=!0,t.cacheAsBitmap=!1,t.matrixIsUpdated=!1,t.concatenatedMatrixIsUpdated=!1,t.colorTransformIsUpdated=!1,t.concatenatedColorTransformIsUpdated=!1,t.blendMode="normal",t.setMatrix=function(t){return this._matrix._getVersion()==t._getVersion()?(this.matrixIsUpdated=!1,void 0):(this._matrix=t.clone(),this.matrixIsUpdated=!0,void 0)},t.getMatrix=function(){return this._matrix.clone()},t.setColorTransform=function(t){return this._colorTransform._getVersion()==t._getVersion()?(this.colorTransformIsUpdated=!1,void 0):(this._colorTransform=t.clone(),this.colorTransformIsUpdated=!0,void 0)},t.getColorTransform=function(){return this._colorTransform},t.visit=function(t){var i=t.parent;i.concatenatedMatrixIsUpdated||this.matrixIsUpdated?(this.concatenatedMatrix=this.getMatrix(),this.concatenatedMatrix.concat(i.concatenatedMatrix),this.concatenatedMatrixIsUpdated=!0):this.concatenatedMatrixIsUpdated=!1,i.concatenatedColorTransformIsUpdated||this.colorTransformIsUpdated?(this.concatenatedColorTransform=this._colorTransform,this.concatenatedColorTransform.concat(i.concatenatedColorTransform),this.concatenatedColorTransformIsUpdated=!0):this.concatenatedColorTransformIsUpdated=!1,this.visible=this.visible&&i.visible,this.mask=i.mask?i.mask:this.mask,this.blendMode=this.blendMode==e.NORMAL?i.blendMode:this.blendMode,t.parent=this;for(var n=this.children.length,r=0;n>r;++r)this.children[r].visit(t.clone())},t.getBoundingBox=function(t){if(this.visible)for(var e=this.children.length,i=0;e>i;++i)this.children[i].getBoundingBox(t)}});return r}),herlock.define("module/view_css/flash/display/BlendMode",[],function(){var t={NORMAL:"normal",ADD:"add"};return t}),herlock.define("module/view_css/flash/geom/Transform",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.colorTransform={get:function(){return this._owner?this._owner._colorTransform.clone():new ColorTransform},set:function(t){this._owner&&!this._owner._setColorTransform(t)}},t.concatenatedColorTransform={get:function(){}},t.concatenatedMatrix={get:function(){}},t.matrix={get:function(){return this._owner?this._owner._matrix.clone():new Matrix},set:function(t){this._owner&&!this._owner._setMatrix(t)}},t._initwithOwner=function(t){this._owner=t},t._getOwner=function(){return this._owner}});return e}),herlock.define("module/view_css/flash/display/DisplayObject",["lib/Class","module/common/event/EventDispatcher","../internal/renderer/RenderingNode","./BlendMode","../geom/Transform","module/view/geom/Point","module/view/geom/Rectangle","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(t,e,i,n,r,s,o,a,h){var l=Math.PI,c=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._colorTransform=new h,this._naturalRect=new o,this._boundsRect=new o,this._matrix=new a,this._transformationPoint=null,this._scale9Grid=new o},t._blendMode=n.NORMAL,t._cacheAsBitmap=!1,t._cacheHandle=null,t._visible=!0,t._parent=null,t._mask=null,t._containable=!1,t._interactive=!1,t._xValue=0,t._yValue=0,t._scaleXValue=1,t._scaleYValue=1,t._rotationValue=0,t._skewXValue=0,t._skewYValue=0,t._calcNaturalRectRequested=!0,t._calcBoundsRectRequested=!0,t._calcMatrixRequested=!0,t._enabledTransformationPoint=!1,t.alpha={get:function(){return this._colorTransform.alphaMultiplier},set:function(t){this._colorTransform.alphaMultiplier=t}},t.blendMode={get:function(){return this._blendMode},set:function(t){this._blendMode=t}},t.cacheAsBitmap={get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t}},t.height={get:function(){return this._getBoundsRect().height},set:function(t){this.scaleY=this.scaleY*t/this.height}},t.mask={get:function(){this._mask},set:function(t){this._mask=t}},t.name="",t.parent={get:function(){return this._parent}},t.root={get:function(){return this._parent?this._parent.root:this}},t.scale9Grid={get:function(){return this._scale9Grid.clone()},set:function(t){null===t?this._scale9Grid.setEmpty():this._scale9Grid=t}},t.rotation={get:function(){return this._rotationValue},set:function(t){if(this._enabledTransformationPoint)return this._setRotationWithTransformPoint(t,this.transformationPoint),void 0;for(;t>180;)t-=360;for(;-180>t;)t+=360;this._rotationValue=t;var e=new a;e._setSkewX(this._skewXValue),e._setSkewY(this._skewYValue),e.rotate((this._rotationValue-e._getRotation())/180*l),this._skewXValue=e._getSkewX(),this._skewYValue=e._getSkewY(),this._requestCalcNaturalRect()}},t.scaleX={get:function(){return this._scaleXValue},set:function(t){return this._scaleXValue!==t?this._enabledTransformationPoint?(this._setScaleXWithTransformPoint(t,this._transformationPoint),void 0):(isNaN(t)&&console.error("debug scaleX",this,t),this._scaleXValue=t,this._requestCalcNaturalRect(),void 0):void 0}},t.scaleY={get:function(){return this._scaleYValue},set:function(t){return this._scaleYValue!==t?this._enabledTransformationPoint?(this._setScaleYWithTransformPoint(t,this._transformationPoint),void 0):(this._scaleYValue=t,this._requestCalcNaturalRect(),void 0):void 0}},t.stage={get:function(){return this._parent?this._parent.stage:null}},t.transform={get:function(){var t=new r;return t._initwithOwner(this),t},set:function(t){this._setColorTransform(t.getColorTransform()),this._setMatrix(t.getMatrix()),requestCalcNaturalRect()}},t.visible={get:function(){return this._visible},set:function(t){this._visible!=t&&(this._visible=t,this._requestCalcNaturalRect())}},t.width={get:function(){return this._getBoundsRect().width},set:function(t){this.scaleX=this.scaleX*t/this.width}},t.x={get:function(){return this._xValue},set:function(t){this._xValue!==t&&(this._xValue=t,this._requestCalcNaturalRect())}},t.y={get:function(){return this._yValue},set:function(t){this._yValue!==t&&(this._yValue=t,this._requestCalcNaturalRect())}},t.getBounds=function(t){t||(t=this);var e=this._getConcatenatedMatrix(),i=t._getConcatenatedMatrix();i.invert(),e.concat(i);var n=this._getNaturalRect(),r=e._calculateBoundsRect(n);return r},t.getRect=function(t){return getBounds(t)},t.globalToLocal=function(t){var e=this._getConcatenatedMatrix();return e.invert(),e.transformPoint(t)},t.hitTestObject=function(t){var e=this._getNaturalRect(),i=this._getConcatenatedMatrix()._calculateBoundsRect(e);e=t._getNaturalRect();var n=t._getConcatenatedMatrix()._calculateBoundsRect(e),r=i.containsRect(n)||i.intersects(n);return r},t.hitTestPoint=function(t,e,i){var n=this.stage;if(!n)return!1;if(i){var r=this.getBounds(n);return r.containsPoint(new s(t,e))}var r=this.getBounds(n);return r.containsPoint(new s(t,e))},t.localToGlobal=function(t){return this._getConcatenatedMatrix().transformPoint(t)},t.transformationPoint={get:function(){},set:function(){}},t._getMatrix=function(){return this._getMatrixRef().clone()},t._getMatrixRef=function(){return this._calcMatrixRequested&&(this._calcMatrixRequested=!1,this._matrix.identity(),this._matrix.scale(this._scaleXValue,this._scaleYValue),this._skewXValue!=this._skewYValue?(this._matrix._setSkewX(this._skewXValue),this._matrix._setSkewY(this._skewYValue)):this._matrix.rotate(this._rotationValue/180*l),this._matrix.translate(this._xValue,this._yValue)),this._matrix},t._setMatrix=function(t){this._xValue=t._getX(),this._yValue=t._getY(),this._rotationValue=t._getRotation(),this._scaleXValue=t._getScaleX(),this._scaleYValue=t._getScaleY(),this._skewXValue=t._getSkewX(),this._skewYValue=t._getSkewY(),this._requestCalcNaturalRect()},t._getColorTransform=function(){return this._colorTransform.clone()},t._getColorTransformRef=function(){return this._colorTransform},t._setColorTransform=function(t){this._colorTransform=t},t._getConcatenatedMatrix=function(){for(var t=this._getMatrix(),e=this.parent;e;){var i=e._getMatrix();t.concat(i),e=e.parent}return t},t._getConcatenatedColorTransform=function(){},t._setParent=function(t){null!=this._parent&&(this._parent=null),null!=t&&(this._parent=t)},t._notifyOnAddedToStage=function(){this._hasEventListener("addedToStage")&&this.dispatchEvent(new Event("addedToStage"))},t._notifyOnRemovedFromStage=function(){this._hasEventListener("removedFromStage")&&this.dispatchEvent(new Event("removedFromStage"))},t._notifyOnEnterFrame=function(){this._hasEventListener("enterFrame")&&this.dispatchEvent(new Event("enterFrame"))},t._notifyOnFrameConstructed=function(){},t._notifyOnExecuteFrameScript=function(){},t._notifyOnExitFrame=function(){this._hasEventListener("exitFrame")&&this.dispatchEvent(new Event("exitFrame"))},t._drawVectorGraphics=function(){},t._glPrepare=function(){var t=this._getRenderingNode();return t.visible=this.visible,t.setMatrix(this._getMatrixRef()),t.setColorTransform(this._getColorTransform()),t.blendMode=this._blendMode,null!=this._mask?t.mask=this._mask._getRenderingNode():null==this._mask&&!!t.mask&&(t.mask=null),t},t._getNaturalRect=function(){return this._calcNaturalRectRequested&&(this._calcNaturalRectRequested=!1,this._calculateNaturalRect()),this._naturalRect},t._calculateNaturalRect=function(){this._naturalRect.setEmpty()},t._requestCalcNaturalRect=function(t){1!=t&&(this._calcMatrixRequested||(this._calcMatrixRequested=!0,this._calcNaturalRectRequested=!0,this._calcBoundsRectRequested=!0,null!==this._parent&&this._parent._requestCalcNaturalRect()))},t._getBoundsRect=function(){if(this._calcBoundsRectRequested){this._calcBoundsRectRequested=!1;var t=this._getNaturalRect();this._boundsRect=this._getMatrix()._calculateBoundsRect(t),isNaN(this._boundsRect.width)&&console.error("debug",this,this._boundsRect)}return this._boundsRect},t._getNodesToRoot=function(){var t=[];if(null==this._parent)return t;for(var e=this;null!=e;)t.push(e),e=e.parent;return t},t._hitTestStrictInternal=function(t){var e=this._getMatrix();e.invert();var i=e.transformPoint(t),n=this._getNaturalRect().containsPoint(i);if(n&&this.mask){var r=this.mask,s=r._getConcatenatedMatrix();s.invert(),i=this._getConcatenatedMatrix().transformPoint(i),i=s.transformPoint(i),n=r._getNaturalRect().containsPoint(i)}return n?this:null},t._renderingNode=null,t._getRenderingNode=function(){return this._renderingNode||(this._renderingNode=this._createRenderingNode()),this._renderingNode},t._createRenderingNode=function(){return new i},t.toString=function(){return'[object DisplayObject name="'+this.name+'"]'}});return c}),herlock.define("module/view_css/flash/display/InteractiveObject",["lib/Class","./DisplayObject"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.mouseEnabled=!0});return i}),herlock.define("module/view_css/flash/display/DisplayObjectContainer",["lib/Class","./InteractiveObject"],function(t,e){var i=t(e,function(t,i){t.constructor=function(){i.constructor.apply(this,arguments),this._children=[],this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},t.numChildren={get:function(){return this._children.length}},t.mouseChildren=!0,t.addChild=function(t){return this.addChildAt(t,this._children.length)},t.addChildAt=function(t,e){if(!t)return console.log("warning: "+this+".addChild child="+t);if(0>e)return console.log("warning: out of range.");if(e>this._children.length)return console.log("warning: out of range.");t._parent&&t._parent.removeChild(t),this._children.splice(e,0,t),t._setParent(this),this._requestCalcNaturalRect(),this._childrenUpdated();for(var i=[],n=t._getNodesToRoot(),r=n.length-1;r>=0;r--)i.push(n[r]);return t._propagateEvent(new Event("added"),i),t.stage&&t._notifyOnAddedToStage(),t},t.getChildIndex=function(t){return this._children.indexOf(t)},t.getChildAt=function(t){return t>=this._children.length?null:this._children[t]},t.getChildByName=function(t){for(var e=this._children.length-1;e>=0;e--)if(this._children[e].name===t)return this._children[e];return null},t.removeChild=function(t){var e=this._children.indexOf(t);return-1===e?console.log("warning: "+this+".removeChild("+t+")"):this.removeChildAt(e)},t.removeChildAt=function(t){if(0>t)return console.log("warning: out of range.");if(t>=this._children.length)return console.log("warning: out of range.");for(var e=this._children[t],i=[],n=e._getNodesToRoot(),r=n.length-1;r>=0;r--)i.push(n[r]);return this._children.splice(t,1)[0],e._setParent(null),this._requestCalcNaturalRect(),this._childrenUpdated(),e._propagateEvent(new Event("removed"),i),e.stage||e._notifyOnRemovedFromStage(),e},t.contains=function(t){if(this===t)return!0;if(-1!==this._children.indexOf(t))return!0;for(var e=this._children,i=e.length,n=0;i>n;n++)if(e[n].contains(t))return!0;return!1},t.setChildIndex=function(t,e){this.addChildAt(t,e)},t.swapChildren=function(t,e){var i=this.getChildIndex(t),n=this.getChildIndex(e);-1!=i&&-1!=n&&(this.addChildAt(t,n),this.addChildAt(e,i),this._childrenUpdated())},t.swapChildrenAt=function(t,e){var i=this.numChildren();t>=i||e>=i||0>t||0>e||this.swapChildren(this.getChildAt(t),this.getChildAt(e))},t._childrenUpdated=function(){this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},t._notifyOnAddedToStage=function(){DisplayObject.prototype._notifyOnAddedToStage.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnAddedToStage()},t._notifyOnRemovedFromStage=function(){DisplayObject.prototype._notifyOnRemovedFromStage.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnRemovedFromStage()},t._notifyOnEnterFrame=function(){DisplayObject.prototype._notifyOnEnterFrame.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnEnterFrame()},t._notifyOnFrameConstructed=function(){DisplayObject.prototype._notifyOnFrameConstructed.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnFrameConstructed()},t._notifyOnExecuteFrameScript=function(){DisplayObject.prototype._notifyOnExecuteFrameScript.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnExecuteFrameScript()},t._notifyOnExitFrame=function(){DisplayObject.prototype._notifyOnExitFrame.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnExitFrame()},t._drawVectorGraphics=function(){DisplayObject.prototype._drawVectorGraphics.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._drawVectorGraphics()},t._glPrepare=function(t){var e=this._getRenderingNode(),i=this._children,n=i.length;if(this._updatedChildrenForRenderingNode){this._updatedChildrenForRenderingNode=!1;var r=e.children;r.length=0;for(var s=0;n>s;s++){var o=i[s]._glPrepare(t);null!=o&&r.push(o)}}else for(var s=0;n>s;s++)i[s]._glPrepare(t);return DisplayObject.prototype._glPrepare.call(this,t)},t._calculateNaturalRect=function(){this._naturalRect.setEmpty();for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i].visible&&(this._naturalRect=this._naturalRect.union(t[i]._getBoundsRect()))},t._hitTestStrictInternal=function(t){if(null==i._hitTestStrictInternal.call(this,t))return null;var n=null,r=this._getMatrix();r.invert(),t=r.transformPoint(t);for(var s=!1,o=this.numChildren-1;o>=0;o--)if(1==this.getChildAt(o).visible&&(n=this.getChildAt(o)._hitTestStrictInternal(t),null!=n)){if(1!=this.mouseChildren)return this;if(1==n.isInstanceOf(e)&&1==n.mouseEnabled)return n;s=!0}return s?this:null},t.toString=function(){return'[object DisplayObjectContainer name="'+this.name+'"]'}});return i}),herlock.define("module/view_css/flash/display/Sprite",["lib/Class","./DisplayObjectContainer"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.toString=function(){return'[object Sprite name="'+this.name+'"]'}});return i}),herlock.define("module/view_css/geom/Point",["lib/Class"],function(){var t=function(t,e){this.x=0,this.y=0,arguments.length>=1&&(this.x=t),arguments.length>=2&&(this.y=e)};return t.prototype=Object.create({},{add:{value:function(e){return new t(this.x+e.x,this.y+e.y)},writable:!0},subtract:{value:function(e){return new t(this.x-e.x,this.y-e.y)},writable:!0},clone:{value:function(e){return new t(e.x,e.y)},writable:!0},equals:{value:function(t){return this.x===t.x&&this.y===t.y},writable:!0},normalize:{value:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);this.x=this.x/e*t,this.y=this.y/e*t},writable:!0},offset:{value:function(t){this.x+=t.x,this.y+=t.y},writable:!0},toString:{value:function(){return'[object Point x="'+this.x+'" y="'+this.y+'"]'},writable:!0}}),t}),herlock.define("module/view_css/geom/Rectangle",["lib/Class","./Point"],function(t,e){var i=function(){this.x=0,this.y=0,this.width=0,this.height=0;var t=arguments.length;t>0&&(this.x=arguments[0]),t>1&&(this.y=arguments[1]),t>2&&(this.width=arguments[2]),t>3&&(this.height=arguments[3])};return i.prototype=Object.create({},{top:{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t}},right:{get:function(){return this.x+this.width},set:function(t){this.width+=t-this.right}},bottom:{get:function(){return this.y+this.height},set:function(t){this.height+=t-this.bottom}},left:{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t}},topLeft:{get:function(){return new e(this.left,this.top)},set:function(t){this.left=t.x,this.top=t.y}},bottomRight:{get:function(){return new e(this.right,this.bottom)},set:function(t){this.right=t.x,this.bottom=t.y}},size:{get:function(){return new e(this.width,this.height)},set:function(t){this.width=t.x,this.height=t.y}},clone:{value:function(){return new i(this.x,this.y,this.width,this.height)},writable:!0},contains:{value:function(t,e){return t>=this.left&&this.right>=t&&e>=this.top&&this.bottom>=e},writable:!0},containsPoint:{value:function(t){return this.contains(t.x,t.y)},writable:!0},containsRect:{value:function(t){return this.top<=t.top&&t.bottom<=this.bottom&&this.left<=t.left&&t.right<=this.right},writable:!0},equals:{value:function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height},writable:!0},inflate:{value:function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},writable:!0},inflatePoint:{value:function(t){this.inflate(t.x,t.y)},writable:!0},intersects:{value:function(t){return this.top>t.bottom||this.left>t.right||this.right<t.left||this.bottom<t.top?!1:!0},writable:!0},intersection:{value:function(t){if(1!=this.intersects(t))return new i;var e,n,r,s;return e=this.top>t.top?this.top:t.top,n=this.right<t.right?this.right:t.right,r=this.bottom<t.bottom?this.bottom:t.bottom,s=this.left>t.left?this.left:t.left,new i(s,e,n-s,r-e)},writable:!0},isEmpty:{value:function(){return 0>=this.width||0>=this.height},writable:!0},offset:{value:function(t,e){this.x+=t,this.y+=e},writable:!0},offsetPoint:{value:function(t){this.offset(t.x,t.y)},writable:!0},setEmpty:{value:function(){this.x=0,this.y=0,this.width=0,this.height=0},writable:!0},union:{value:function(t){if(this.isEmpty()&&t.isEmpty())return new i;if(t.isEmpty())return this.clone();if(this.isEmpty())return t.clone();var e,n,r,s;return e=this.top<t.top?this.top:t.top,n=this.right>t.right?this.right:t.right,r=this.bottom>t.bottom?this.bottom:t.bottom,s=this.left<t.left?this.left:t.left,new i(s,e,n-s,r-e)},writable:!0},_set:{value:function(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n},writable:!0},toString:{value:function(){return'[object Rectangle x="'+this.x+'" y="'+this.y+'" width="'+this.width+'" height="'+this.height+'"]'},writable:!0}}),i}),herlock.define("module/view_css/geom/Matrix",["lib/Class","./Point","./Rectangle"],function(t,e,i){var n=Math.PI,r=function(t,e,i,n,r,s){var o=arguments.length;if(0===o)this._values=[1,0,0,1,0,0],this._isInitialValue=!0;else{var a=this._values=[o>0?t:1,o>1?e:0,o>2?i:0,o>3?n:1,o>4?r:0,o>5?s:0];this._isInitialValue=1===a[0]&&0===a[1]&&0===a[2]&&1===a[3]&&0===a[4]&&0===a[5]}this._version=1e7*Math.random()<<0};return r.prototype=Object.create({},{a:{get:function(){return this._values[0]},set:function(t){this._values[0]=t,this._increment()}},b:{get:function(){return this._values[1]},set:function(t){this._values[1]=t,this._increment()}},c:{get:function(){return this._values[2]},set:function(t){this._values[2]=t,this._increment()}},d:{get:function(){return this._values[3]},set:function(t){this._values[3]=t,this._increment()}},tx:{get:function(){return this._values[4]},set:function(t){this._values[4]=t,this._increment()}},ty:{get:function(){return this._values[5]},set:function(t){this._values[5]=t,this._increment()}},_increment:{value:function(){this._version++,this._isInitialValue=!1},writable:!0},_getVersion:{value:function(){return this._version},writable:!0},isInitialValue:{value:function(){return this._isInitialValue},writable:!0},clone:{value:function(){var t=new r;return t._values=this._values.slice(),t._version=this._version,t._isInitialValue=this._isInitialValue,t},writable:!0},concat:{value:function(t){t.isInitialValue()||this._concat(t._values)},writable:!0},_concat:{value:function(t){if(this.isInitialValue())this._values=t;else{var e=this._values,i=t;this._values=[e[0]*i[0]+e[1]*i[2],e[0]*i[1]+e[1]*i[3],e[2]*i[0]+e[3]*i[2],e[2]*i[1]+e[3]*i[3],e[4]*i[0]+e[5]*i[2]+i[4],e[4]*i[1]+e[5]*i[3]+i[5]]}this._increment()},writable:!0},createBox:{value:function(){},writable:!0},createGradientBox:{value:function(){},writable:!0},deltaTransformPoint:{value:function(){},writable:!0},identity:{value:function(){this._values=[1,0,0,1,0,0],this._increment(),this._isInitialValue=!0},writable:!0},invert:{value:function(){var t=this.a*this.d-this.c*this.b;if(0!==t){var e=1/t,i=this.tx;this.tx=(this.c*this.ty-i*this.d)*e,this.ty=(i*this.b-this.a*this.ty)*e,this.c=-this.c*e,this.b=-this.b*e,i=this.a,this.a=this.d*e,this.d=i*e,this._increment()}},writable:!0},rotate:{value:function(t){var e=Math.cos(t),i=Math.sin(t);this._concat([e,i,-i,e,0,0])},writable:!0},scale:{value:function(t,e){this._concat([t,0,0,e,0,0])},writable:!0},transformPoint:{value:function(t){var i=this._values;return new e(t.x*i[0]+t.y*i[2]+1*i[4],t.x*i[1]+t.y*i[3]+1*i[5])},writable:!0},translate:{value:function(t,e){this._concat([1,0,0,1,t,e])},writable:!0},_getScaleX:{value:function(){return Math.sqrt(this.a*this.a+this.b*this.b)},writable:!0},_setScaleX:{value:function(t){this._increment();var e=this._getScaleX();if(e>0){var i=t/e;this.a*=i,this.b*=i}else{var n=this._getSkewY_();this.a=Math.cos(n)*t,this.b=Math.sin(n)*t}},writable:!0},_getScaleY:{value:function(){return Math.sqrt(this.c*this.c+this.d*this.d)},writable:!0},_setScaleY:{value:function(t){this._increment();var e=this._getScaleY();if(e>0){var i=t/e;this.c*=i,this.d*=i}else{var n=this._getSkewX_();this.c=-Math.sin(n)*t,this.d=Math.cos(n)*t}},writable:!0},_getSkewX:{value:function(){return this._getSkewX_()*(180/n)},writable:!0},_setSkewX:{value:function(t){this._setSkewX_(t*(n/180))},writable:!0},_getSkewY:{value:function(){return this._getSkewY_()*(180/n)},writable:!0},_setSkewY:{value:function(t){this._setSkewY_(t*(n/180))},writable:!0},_getRotation:{value:function(){return this._getSkewY_()*(180/n)},writable:!0},_setRotation:{value:function(t){this._setRotation_(t*(n/180))},writable:!0},_getX:{value:function(){return this.tx},writable:!0},_setX:{value:function(t){this.tx=t,this._increment()},writable:!0},_getY:{value:function(){return this.ty},writable:!0},_setY:{value:function(t){this.ty=t,this._increment()},writable:!0},_setRotation_:{value:function(t){var e=this._getSkewY_(),i=this._getSkewX_();this._setSkewX_(i+t-e),this._setSkewY_(t)},writable:!0},_getSkewX_:{value:function(){return Math.atan2(-this.c,this.d)},writable:!0},_setSkewX_:{value:function(t){var e=this._getScaleY();this.c=-e*Math.sin(t),this.d=e*Math.cos(t),this._increment()},writable:!0},_getSkewY_:{value:function(){return Math.atan2(this.b,this.a)},writable:!0},_setSkewY_:{value:function(t){var e=this._getScaleX();this.a=e*Math.cos(t),this.b=e*Math.sin(t),this._increment()},writable:!0},_calculateBoundsRect:{value:function(t){for(var n=[this.transformPoint(t.topLeft),this.transformPoint(new e(t.right,t.top)),this.transformPoint(new e(t.left,t.bottom)),this.transformPoint(t.bottomRight)],r=n[0].y,s=n[0].y,o=n[0].x,a=n[0].x,h=1;4>h;h++){var l=n[h];r>l.y&&(r=l.y),l.y>s&&(s=l.y),o>l.x&&(o=l.x),l.x>a&&(a=l.x)}return new i(o,r,a-o,s-r)},writable:!0},_equal:{value:function(t){for(var e=0;6>e;e++)if(this._values[e]!=t._values[e])return!1;return!0},writable:!0}}),r}),herlock.define("module/view_css/flash/internal/renderer/CSSRenderingSystem",["lib/Class","../../../geom/Matrix"],function(t,e){function i(t,e){var i=t+"{";for(var n in e)i+=""+n+":"+e[n]+";";return i+="}"}var n=t(Object,function(t){t.container=null,t.width=null,t.height=null,t.constructor=function(){var t=document.createElement("style");document.head.appendChild(t),this._sheet=t.sheet,this._matrixSheet=document.createElement("style"),document.head.appendChild(this._matrixSheet),this._idIncrementor=0,this._fragment=document.createDocumentFragment(),this._curr=[],this._prev=[]},t.putBitmapProxy=function(t){var e=this._sheet.cssRules.length,n="texture_"+this._idIncrementor++;this._sheet.insertRule(i("."+n,{background:"url("+(t._imageElm?t._imageElm.src:t._canvasElm.toDataURL())+")",position:"absolute",display:"block !important",top:"0",left:"0",width:t.width()+"px",height:t.height()+"px"}),e);var r={id:n,index:e};return r};var n=new e(-1,0,0,1,-100,0);t.render=function(t){var e=t.element,i=t.matrix,r=t.style;t.visible||(i=n);var s=i._values,o=t.__matrix_values||[],a=o[0]!==s[0]||o[1]!==s[1]||o[2]!==s[2]||o[3]!==s[3]||o[4]!==s[4]||o[5]!==s[5];if(a&&(__setTransform(r,"matrix3d( "+s[0].toFixed(8)+", "+s[1].toFixed(8)+", 0, 0, "+s[2].toFixed(8)+", "+s[3].toFixed(8)+", 0, 0, 0, 0, 1, 0, "+s[4].toFixed(8)+", "+s[5].toFixed(8)+", 0, 1 )"),t.__matrix_values=s.slice()),!e.__clippingRect||!e.__clippingRect.equals(t.clippingRect)){if(t.clippingRect.isEmpty())r.width=null,r.height=null,r.backgroundPosition=null;else{var h=t.clippingRect;r.width=h.width+"px",r.height=h.height+"px",r.backgroundPosition=-h.x+"px "+-h.y+"px"}e.__clippingRect=t.clippingRect}var l=t.colorTransform.alphaMultiplier;e.__alpha!==l&&(r.opacity=l,e.__alpha=l),this._curr.push(t.element)},t.render_bk=function(t){var e=t.element,i=t.matrix,r=t.style;if(t.visible||(i=n),e.__matrix&&e.__matrix._equal(i)||(__setTransform(r,"matrix3d( "+i.a.toFixed(8)+", "+i.b.toFixed(8)+", 0, 0, "+i.c.toFixed(8)+", "+i.d.toFixed(8)+", 0, 0, 0, 0, 1, 0, "+i.tx.toFixed(8)+", "+i.ty.toFixed(8)+", 0, 1 )"),e.__matrix=i.clone()),!e.__clippingRect||!e.__clippingRect.equals(t.clippingRect)){if(t.clippingRect.isEmpty())r.width=null,r.height=null,r.backgroundPosition=null;else{var s=t.clippingRect;r.width=s.width+"px",r.height=s.height+"px",r.backgroundPosition=-s.x+"px "+-s.y+"px"}e.__clippingRect=t.clippingRect}var o=t.colorTransform.alphaMultiplier;e.__alpha!==o&&(r.opacity=o,e.__alpha=o),this._curr.push(t.element)},t.begin=function(){this._matrixSheetTexts=[]},t.end=function(){if(this._curr.length===this._prev.length){for(var t=!0,e=0;this._curr.length>e;e++)t=t&&this._curr[e]===this._prev[e];if(t)return this._prev=this._curr,this._curr=[],void 0}for(var e in this._curr)this._fragment.appendChild(this._curr[e]);this.container.innerHTML="",this.container.appendChild(this._fragment),this._prev=this._curr,this._curr=[]}}),r=new n;return r}),herlock.define("module/view_css/flash/events/InteractiveObjectTouchEvent",["lib/Class","module/common/event/Event"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments);var t=arguments.length,i=arguments;this._touchPointID=t>3?i[3]:0,this._isPrimaryTouchPoint=t>4?i[4]:!1,this._localX=t>5?i[5]:0,this._localY=t>6?i[6]:0},t.isPrimaryTouchPoint={get:function(){return this._isPrimaryTouchPoint},set:function(t){this._isPrimaryTouchPoint=t}},t.localX={get:function(){return this._localX},set:function(t){this._localX=t}},t.localY={get:function(){return this._localY},set:function(t){this._localY=t}},t.touchPointID={get:function(){return this._touchPointID},set:function(t){this._touchPointID=t}},t.stageX={get:function(){if(this._hasStagePoint)return this._stagePoint.x;var t=this.target;return t.localToGlobal(new Point(this.localX,this.localY)).x}},t.stageY={get:function(){if(this._hasStagePoint)return this._stagePoint.y;var t=this.target;return t.localToGlobal(new Point(this.localX,this.localY)).y}},t._setStagePoint=function(t){return this._stagePoint=t,this._hasStagePoint=!0,this
}});return i}),herlock.define("module/view_css/flash/display/Stage",["lib/Class","./Sprite","../internal/renderer/RenderingNode","../internal/renderer/CSSRenderingSystem","module/view/touch/TouchEventInfo","../events/InteractiveObjectTouchEvent"],function(t,e,i,n,r,s){var o=t(e,function(t,e){t.constructor=function(t,i){e.constructor.apply(this,arguments),this._stageWidth=t||100,this._stageHeight=i||100,this._layer=null,this._frameRate=60,this._quality=null,this._offscreenHandle=null,this._primaryTouchId=-1,this._touchPointerStateDictionary={},this._layerContentRenderObject=null},t.frameRate={get:function(){return this._frameRate},set:function(){}},t.stageWidth={get:function(){return this._stageWidth},set:function(t){this._stageWidth=t,null!=this._layer&&this._layer._notifyResizeContent()}},t.stageHeight={get:function(){return this._stageHeight},set:function(t){this._stageHeight=t,null!=this._layer&&this._layer._notifyResizeContent()}},t.stage={get:function(){return this}},t.height={get:function(){}},t.width={get:function(){}},t.layer={get:function(){}},t._getContentWidth=function(){return this.stageWidth},t._getContentHeight=function(){return this.stageHeight},t.getLayer=function(){return this._layer},t._onAddedTo=function(t){this._layer=t},t._onRemovedFrom=function(){this._layer=NULL},t._glPrepare=function(t,e){this._layerContentRenderObject||(this._layerContentRenderObject=new h);var i={};this._layerContentRenderObject.root=DisplayObjectContainer.prototype._glPrepare.call(this,i);var n=new Matrix;return n.concat(this.getLayer()._getContentMatrix()),n.concat(this.getLayer()._getMatrix()),this._layerContentRenderObject.matrix._equal(n)||(this._layerContentRenderObject.matrix=n),this._layerContentRenderObject.colorTransform=e,this._layerContentRenderObject},t._notifyDrawFrame=function(){this._notifyOnEnterFrame(),this._drawVectorGraphics()},t._notifyResizeView=function(){},t._dispatchTouchEvent=function(t){for(var e=t,i=e.getChangedPointers(),n=i.length,r=0;n>r;r++)this._dispatchTouchEventWithChangedTouchPointer(e,i[r])},t._dispatchTouchEventWithChangedTouchPointer=function(t,e){var i=this._layer._getMatrix(),n=this._layer._getContentMatrix();n.concat(i),n.invert();var o=n.transformPoint(new Point(e.x,e.y)),a=this,h=a._hitTestStrictInternal(o);h||(h=this);var c=h,u=c.globalToLocal(o),_=[];_.push(c);for(var f=c.parent;f;)_.unshift(f),f=f.parent;var d="";switch(t.getAction()){case r.DOWN:d="touchBegin";break;case r.MOVE:d="touchMove";break;case r.UP:d="touchEnd";break;case r.CANCEL:default:d="touchEnd"}0>=Object.keys(this._touchPointerStateDictionary).length&&(this._primaryTouchId=e.id);var g=this._primaryTouchId==e.id,m=new s(d,!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var p=null,h=this._touchPointerStateDictionary[e.id];switch(h&&(p=h,delete this._touchPointerStateDictionary[e.id]),t.getAction()){case r.DOWN:var v=l.create(e.id,c,c);this._touchPointerStateDictionary[e.id]=v;var m=new s("touchOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);for(var x=_.length,w=0;x>w;w++){var m=new s("touchRollOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);_[w].dispatchEvent(m)}break;case r.MOVE:var v=l.create(e.id,p&&p.beganFrom?p.beganFrom:null,c);if(this._touchPointerStateDictionary[e.id]=v,p&&p.overNow==c)break;var m=new s("touchOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var m=new s("touchOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var b=-1,a=c,y=[],T=[];if(p&&p.overNow){T=p.overNow._getNodesToRoot();for(var R=T.length;-1==b;){y.push(a);for(var w=0;R>w;w++)if(T[w]==a){b=w;break}if(a=a.parent,!a)break}}if(-1==b)break;for(var w=b-1;w>=0;w--){var m=new s("touchRollOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);T[w].dispatchEvent(m)}for(var C=y.length,w=0;C>w;w++){var m=new s("touchRollOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);y[w].dispatchEvent(m)}break;case r.UP:case r.CANCEL:default:var m=new s("touchOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o),S=[];if(p&&p.overNow){S.push(p.overNow);for(var f=p.overNow.parent;f;)S.unshift(f),f=f.parent;m._setTarget(p.overNow)}for(var x=S.length,w=0;x>w;w++){var m=new s("touchRollOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);S[w].dispatchEvent(m)}if(t.getAction()!=r.CANCEL&&p&&p.beganFrom&&p.beganFrom===c){var m=new s("touchTap",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_)}this._primaryTouchId==e.id&&(this._primaryTouchId=-1)}},t.toString=function(){return'[object Stage stageWidth="'+this.stageWidth+'" stageHeight="'+this.stageHeight+'"]'}}),a=function(t){t=t||{},this.parent=t.parent||new i,this.offScreenRenderingRequests=t.offScreenRenderingRequests||[],this.renderingRequests=t.renderingRequests||[]};a.prototype={clone:function(){return new a(this)}};var h=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this.visitor=new a,this.visitor.parent=new i,this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.matrix=new Matrix,this.colorTransform=new ColorTransform,this.root=null},t.processData=function(){var t=new Matrix,e=this.matrix.clone();e.concat(t),this.visitor.parent._matrix._getVersion()!==e._getVersion()?(this.visitor.parent.setMatrix(e),this.visitor.parent.concatenatedMatrix=this.visitor.parent.getMatrix(),this.visitor.parent.concatenatedMatrixIsUpdated=!0):(this.visitor.parent.setMatrix(e),this.visitor.parent.matrixIsUpdated=!1,this.visitor.parent.concatenatedMatrixIsUpdated=!1),this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.root.visit(this.visitor.clone())},t.renderOffscreen=function(){},t.render=function(){n.begin();for(var t=this.visitor.renderingRequests,e=t.length,i=0;e>i;i++)n.render(t[i]);n.end()}}),l={create:function(t,e,i){return{pointerId:t,beganFrom:e,overNow:i}}};return o}),herlock.define("module/view_css/flash/display/BitmapData",["lib/Class","module/graphics/BitmapProxy","../internal/renderer/CSSRenderingSystem"],function(t,e,i){function n(t){return"number"==typeof t}function r(t){return"boolean"==typeof t}var s=t(Object,function(t,s){t.constructor=function(){s.constructor.apply(this,arguments);var t=arguments,i=arguments.length,o=null;if(i>=2&&n(t[0])&&n(t[1])){var a=t[0],h=t[1],l=2046;if(a>=l||h>=l)throw Error("Argument Error. over limit size!! please 2046 > size.");o=e.create(a,h);var c=!0,u=4294967295;i>=3&&r(t[2])&&(c=t[2]),i>=4&&n(t[3])&&(u=t[3]);var _=o.getCanvas();_.setFillColor(u),_.fillRect(0,0,a,h)}else{if(!(i>=1&&t[0].isInstanceOf&&t[0].isInstanceOf(Image)))throw Error("Argument Error");o=t[0]._getBitmap()}this._bitmapProxy=o,this._sheetRow=null},t.width={get:function(){return this._bitmapProxy?this._bitmapProxy.width():0}},t.height={get:function(){return this._bitmapProxy?this._bitmapProxy.height():0}},t.transparent={get:function(){return!0}},t.rect={get:function(){return new Rectangle(0,0,this.width,this.height)}},t.dispose=function(){this._bitmapProxy=null},t._notifyEnterFrame=function(){},t._notifyFrameConstructed=function(){},t._notifyExecuteFrameScript=function(){},t._notifyExitFrame=function(){},t._notifyDrawVectorGraphics=function(){},t._glPrepare=function(){this._bitmapProxy&&(this._sheetRow||(this._sheetRow=i.putBitmapProxy(this._bitmapProxy)))},t._notifyUpdateForBitmap=function(){},t._getCSSId=function(){return this._sheetRow.id},t.toString=function(){return'[object BitmapData width="'+this.width+'" height="'+this.height+'"]'}});return s}),herlock.define("module/view_css/flash/internal/renderer/CSSRenderingObject",["lib/Class"],function(t){var e=0,i=t(Object,function(t,i){t.constructor=function(){i.constructor.apply(this,arguments),this.element=document.createElement("div"),this.element.style.transformOrigin="0 0",this.element.style.position="absolute",this.element.style.top=0,this.element.style.left=0,this.element.id="CSSRO_"+e++,this.style=this.element.style,this._cssId=null},t.cssId={get:function(){return this._cssId},set:function(t){this._cssId!==t&&(this._cssId=t,this.element.className=t)}},t.width=null,t.height=null,t.colorTransform=null,t.blendMode=null,t.maskNode=null,t.clippingRect=null,t.getTextureId=function(){return this.textureId}});return i}),herlock.define("module/view_css/flash/display/Bitmap",["lib/Class","./DisplayObject","../internal/renderer/RenderingNode","../internal/renderer/CSSRenderingObject"],function(t,e,i,n){var r=t(e,function(t,i){t.constructor=function(t,e,n,r){i.constructor.apply(this,arguments);var s=arguments.length;this._bitmapData=t,this._pixelSnapping=s>1?e:!1,this._smoothing=s>2?n:!1,this._clippingRect=s>3?r:new Rectangle},t.bitmapData={get:function(){return this._bitmapData},set:function(t){null!=this._bitmapData&&(this._bitmapData=null),null!=t&&(this._bitmapData=t),this._requestCalcNaturalRect()}},t.setClippingRect=function(t){this._clippingRect=t,this._requestCalcNaturalRect()},t._calculateNaturalRect=function(){return null==this.bitmapData?(this._naturalRect.setEmpty(),void 0):this._clippingRect.isEmpty()?(this._naturalRect.width=this.bitmapData.width,this._naturalRect.height=this.bitmapData.height,void 0):(this._naturalRect.width=this._clippingRect.width,this._naturalRect.height=this._clippingRect.height,void 0)},t._glPrepare=function(t){var i=this._getRenderingNode();return i.children=[],null==this.bitmapData?e.prototype._glPrepare.call(this,t):(this.bitmapData._glPrepare(),i.scale9Grid=this.scale9Grid,i.clippingRect=this._clippingRect,i.width=this.bitmapData.width,i.height=this.bitmapData.height,i.cssId=this.bitmapData._getCSSId(),e.prototype._glPrepare.call(this,t))},t._createRenderingNode=function(){return new s},t.toString=function(){return'[object Bitmap name="'+this.name+'"]'}}),s=t(i,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._renderingObjects=[new n,new n,new n,new n,new n,new n,new n,new n,new n]},t.clippingRect=null,t.cssId=null,t.scale9Grid=null,t.width,t.height,t.setMatrix=function(t){e.setMatrix.call(this,t)},t.visit=function(t){if(this.cssId){this.scale9Grid.isEmpty()&&i.prototype.visit.call(this,t);var e=this.concatenatedMatrix.clone(),n=this._renderingObjects[0];n.visible=this.visible&&t.parent.visible,n.cssId=this.cssId,n.blendMode=this.blendMode,n.maskNode=this.mask,n.colorTransform=this.concatenatedColorTransform,n.matrix=e,n.offsetX=0,n.offsetY=0,n.width=this.width,n.height=this.height,n.clippingRect=this.clippingRect,1!=this.clippingRect.isEmpty()&&(n.offsetX+=this.clippingRect.x,n.offsetY+=this.clippingRect.y,n.width=this.clippingRect.w,n.height=this.clippingRect.h),t.renderingRequests.push(n)}},t.getBoundingBox=function(t){var e=this.textureImageHandle.getTextureImageInfo(),i=this.concatenatedMatrix,n=e.area.clone();this.clippingRect.isEmpty()!==!0&&(n.width=this.clippingRect.width,n.height=this.clippingRect.height),n.x=0,n.y=0;var r=i._calculateBoundsRect(n),s=t.union(r);t._set(s.x,s.y,s.width,s.height)}});return r}),herlock.define("module/view_css/flash/text/TextFormat",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(t,i,n,r,s,o,a,h,l,c,u,_,f){e.constructor.apply(this,arguments);var d=arguments.length;d>=1&&(this.font=t),d>=2&&(this.size=i),d>=3&&(this.color=n),d>=4&&(this.bold=r),d>=5&&(this.italic=s),d>=6&&(this.underline=o),d>=7&&(this.url=a),d>=8&&(this.target=h),d>=9&&(this.align=l),d>=10&&(this.leftMargin=c),d>=11&&(this.rightMargin=u),d>=12&&(this.indent=_),d>=13&&(this.leading=f)},t.align="left",t.blockIndent=0,t.bold=!1,t.color=0,t.font="",t.indent=0,t.italic=!1,t.kerning=!1,t.leading=0,t.leftMargin=0,t.letterSpacing=0,t.rightMargin=0,t.size=12,t.underline=!1,t.toString=function(){return"[object TextFormat]"}});return e}),herlock.define("module/view_css/flash/text/TextFieldAutoSize",[],function(){var t={NONE:"none",CENTER:"center",LEFT:"left",RIGHT:"right"};return t}),herlock.define("module/view_css/flash/text/TextFormatAlign",[],function(){var t={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"};return t}),herlock.define("module/view_css/flash/text/TextField",["lib/Class","../display/InteractiveObject","./TextFormat","./TextFieldAutoSize","./TextFormatAlign","module/graphics/BitmapProxy","../internal/renderer/RenderingNode","../internal/renderer/CSSRenderingObject"],function(t,e,i,n,r,s,o,a){function h(t,e){return 16777216*parseInt(255*e)+t}var l=2,c=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._text="",this._drawTextRequested=!0,this._calcTextRequested=!0,this._bitmapProxy=null,this._textureImageHandle=null,this._autoSize=n.NONE,this._background=!1,this._backgroundColor=16777215,this._border=!1,this._borderColor=0,this._defaultTextFormat=null,this._multiline=!1,this._wordWrap=!1,this._scrollH=0,this._scrollV=0,this._maxScrollH=0,this._maxScrollV=0,this._maxChars=0,this._bottomScrollV=0,this._naturalRect.height=100,this._naturalRect.width=100,this._defaultTextFormat=new i,this._bitmapProxy=s.create(10,10)},t.autoSize={get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this._requestCalcNaturalRect())}},t.background={get:function(){return this._background},set:function(t){this._background!=t&&(this._background=t,this._requestCalcAndDrawText())}},t.backgroundColor={get:function(){return this._backgroundColor},set:function(t){this._backgroundColor!=t&&(this._backgroundColor=t,this._requestCalcAndDrawText())}},t.border={get:function(){return this._border},set:function(t){this._border!=t&&(this._border=t,this._requestCalcAndDrawText())}},t.borderColor={get:function(){return this._borderColor},set:function(t){this._borderColor!=t&&(this._borderColor=t,this._requestCalcAndDrawText())}},t.bottomScrollV={get:function(){return this._bottomScrollV}},t.defaultTextFormat={get:function(){return this._defaultTextFormat},set:function(t){null!=this._defaultTextFormat&&(delete this._defaultTextFormat,this._defaultTextFormat=null),this._defaultTextFormat=t,this._requestCalcAndDrawText()}},t.length={get:function(){return this._text.length}},t.maxChars={get:function(){return this._maxChars},set:function(t){this._=t}},t.maxScrollH={get:function(){return this._maxScrollH}},t.maxScrollV={get:function(){return this._maxScrollV}},t.multiline={get:function(){return this._multiline},set:function(t){this._multiline!=t&&(this._multiline=t,this._requestCalcAndDrawText())}},t.numLines={get:function(){return this._calcTextRequested&&this._calcText(),this._numOfLines}},t.scrollH={get:function(){return this._scrollH},set:function(t){this._scrollH=t,this._requestCalcAndDrawText()}},t.scrollV={get:function(){return this._scrollV},set:function(t){this._scrollV=t,this._requestCalcAndDrawText()}},t.text={get:function(){return this._text},set:function(t){this._text=t,this._requestCalcAndDrawText(),this._requestCalcNaturalRect()}},t.textColor={get:function(){return this._defaultTextFormat.color},set:function(t){this._defaultTextFormat.color=t,this._requestCalcAndDrawText()}},t.textHeight={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.h}},t.textWidth={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.w}},t.type={get:function(){return this._type},set:function(t){this._type=t}},t.wordWrap={get:function(){return this._wordWrap},set:function(t){this._wordWrap=t,this._requestCalcAndDrawText()}},t.appendText=function(t){this._text+=t,this._requestCalcAndDrawText()},t.getTextFormat=function(){return this._defaultTextFormat},t.setTextFormat=function(t){this._defaultTextFormat&&(this._defaultTextFormat=null),this._defaultTextFormat=t,this._requestCalcAndDrawText()},t.height={get:function(){return this._getBoundsRect().height},set:function(t){this._naturalRect.height!=t&&(this._naturalRect.height=t,this._requestCalcNaturalRect())}},t.width={get:function(){return this._getBoundsRect().width},set:function(t){this._naturalRect.width!=t&&(this._naturalRect.width=t,this._requestCalcNaturalRect())}},t._requestCalcAndDrawText=function(){this._drawTextRequested=!0,this._calcTextRequested=!0},t._drawVectorGraphics=function(){},t._glPrepare=function(t){this._drawTextRequested&&this._drawText();var i=this._getRenderingNode();return i.bitmapProxy=this._bitmapProxy,e._glPrepare.call(this,t)},t._calculateNaturalRect=function(){switch(this._calcTextRequested&&this._calcText(),this._defaultTextFormat,this._autoSize){case n.NONE:break;case n.LEFT:var t=new Rectangle;t.width=this._textRect.width+2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*l,this._naturalRect=t;break;case n.CENTER:var e=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*l,this._naturalRect=t,this.x=this.x+(e-t.width)/2;break;case n.RIGHT:var e=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*l,this._naturalRect=t,this.x=this.x+(e-t.width)}},t._requestCalcNaturalRect=function(t){t||(this._requestCalcAndDrawText(),e._requestCalcNaturalRect.call(this,t))},t._drawText=function(){var t=this._getMatrix();if(0!=t._getScaleX()&&0!=t._getScaleY()){var e=this._getNaturalRect(),i=new Rectangle(0,0,t._getScaleX()*e.width,t._getScaleY()*e.height);this._drawTextRequested=!1,this._bitmapProxy&&i.width==this._bitmapProxy.width()&&i.height==this._bitmapProxy.height()||(this._bitmapProxy=s.create(i.width,i.height));var n=this._bitmapProxy.getCanvas();this._background?(n.setFillColor(h(this._backgroundColor,1)),n.fillRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())):n.clear(),this._border&&(n.setStrokeColor(h(this._borderColor,1)),n.strokeRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())),n.setFillColor(h(this._defaultTextFormat.color,1)),n.setFontSize(this._defaultTextFormat.size*t._getScaleY()),n.setLetterSpacing(this._defaultTextFormat.letterSpacing);for(var o=this._calcTextLinePositions(),a=n.getFontMetrics(),c=a.ascent,u=a.descent,_=this._defaultTextFormat.leading,f=l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,d=l,g=o.length,m=0;g>m;m+=2){var p=o[m],v=o[m+1];if(!(0>p)){var x=this.text.substring(p,v+1);switch(f=l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,(0==m||o[m-1]+1!=p)&&(f+=this._defaultTextFormat.indent),this._defaultTextFormat.align){case r.LEFT:break;case r.CENTER:var w=n.measureText(x);f+=(i.width-f-this._defaultTextFormat.rightMargin-w)/2;break;case r.RIGHT:var w=n.measureText(x);f+=i.width-f-this._defaultTextFormat.rightMargin-w;break;case r.JUSTIFY:}d=m/2*(-c+u+_),n.fillText(f,d,x)}}}},t._calcText=function(){calcTextRequested=!1;var t=this._getMatrix(),e=this._calcTextLinePositions(),i=this._bitmapProxy.getCanvas();if(i.setFontSize(this._defaultTextFormat.size*t._getScaleY()),i.setLetterSpacing(this._defaultTextFormat.letterSpacing),this._textRect=new Rectangle,this._wordWrap)this._textRect.width=this._naturalRect.width-(2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin);else for(var n=e.length,r=0;n>r;r+=2){var s=e[r],o=e[r+1];if(!(0>s)){var a=this._text.substring(s,o+1),h=i.measureText(a);h>this._textRect.width&&(this._textRect.width=h)}}var c=i.getFontMetrics(),u=c.ascent,_=c.descent,f=this._defaultTextFormat.leading,d=e.length/2;this._textRect.height=(-u+_)*d+f*(d-1)},t._calcTextLinePositions=function(){var t=this._text,e=[];e.push(0);var i;for(i=0;;){var n=t.indexOf("\r",i);if(-1==n)break;var r=n;t.length>r+1&&"\n"==t.charAt(r+1)?(e.push(r-1),e.push(r+2)):(e.push(r-1),e.push(r+1)),i=n+1}for(i=0;;){var n=t.indexOf("\n",i);if(-1==n)break;var r=n;r-1>=0&&"\r"!=t.charAt(r-1)&&(e.push(r-1),e.push(r+1)),i=n+1}if(e.push(t.length-1),e.sort(function(t,e){return t-e}),1!=this._wordWrap)return e;var s=this._getConcatenatedMatrix(),o=new Rectangle(l,l,2*-l+s._getScaleX()*this._naturalRect.width-this._defaultTextFormat.leftMargin-this._defaultTextFormat.blockIndent-this._defaultTextFormat.rightMargin,2*-l+s._getScaleY()*this._naturalRect.height),a=this._bitmapProxy.getCanvas();a.setFontSize(this._defaultTextFormat.size*s._getScaleY()),a.setLetterSpacing(this._defaultTextFormat.letterSpacing);for(var h=e.slice(),c=0;h.length>c;){var u=h[c];c++,-1==u&&(u=0);var _=h[c];h.length>c&&c++;for(var f=_-u+1,d=t.substring(u,_+1),g=a.breakText(d,o.width-this._defaultTextFormat.indent);f>g;){e.push(u+g-1),e.push(u+g),u+=g,f=_-u+1;var d=t.substring(u,_+1);if(g=a.breakText(d,o.width),g==f)break}}return e.sort(function(t,e){return t-e}),e},t._createRenderingNode=function(){return new u},t.toString=function(){return'[object TextField name="'+this.name+'"]'}}),u=t(o,function(t,e){t.object,t.width,t.height,t.clippingRect=null,t.bitmapProxy=null,t.scale9Grid=null,t.constructor=function(){e.constructor.call(this),this.object=new a,this.clippingRect=new Rectangle,this.scale9Grid=new Rectangle},t.visit=function(t){if(this.bitmapProxy){if(!this.visible||!t.parent.visible)return e.visit.call(this,t),void 0;this.scale9Grid.isEmpty()&&e.visit.call(this,t);var i=this.concatenatedMatrix.clone(),n=this.object;n.bitmapProxy=this.bitmapProxy,n.blendMode=this.blendMode,n.maskNode=this.mask,n.colorTransform=this.concatenatedColorTransform,n.matrix=i,n.offsetX=0,n.offsetY=0,n.width=this.width,n.height=this.height,n.clippingRect=this.clippingRect,1!=this.clippingRect.isEmpty()&&(n.offsetX+=this.clippingRect.x,n.offsetY+=this.clippingRect.y,n.width=this.clippingRect.w,n.height=this.clippingRect.h),t.renderingRequests.push(n)}}});return c}),herlock.define("module/view_css/flash/flash",["./display/DisplayObject","./display/InteractiveObject","./display/DisplayObjectContainer","./display/Sprite","./display/Stage","./display/BitmapData","./display/Bitmap","./text/TextField","./text/TextFieldAutoSize","./text/TextFormat","./geom/Transform","./events/InteractiveObjectTouchEvent"],function(t,e,i,n,r,s,o,a,h,l,c,u){var _={installTo:function(_){_.DisplayObject=t,_.InteractiveObject=e,_.DisplayObjectContainer=i,_.Sprite=n,_.Stage=r,_.BitmapData=s,_.Bitmap=o,_.TextField=a,_.TextFieldAutoSize=h,_.TextFormat=l,_.Transform=c,_.InteractiveObjectTouchEvent=u},initJs:function(t){t.Event.ENTER_FRAME="enterFrame",t.Event.EXIT_FRAME="exitFrame"}};return _}),herlock.define("module/view_css/geom/ColorTransform",["lib/Class"],function(){function t(t,e,i){return t<<16|e<<8|i<<0}function e(t){return 255&t>>16}function i(t){return 255&t>>8}function n(t){return 255&t>>0}var r=0,s=1,o=2,a=3,h=function(t,e,i,n,r,s,o,a){var h=arguments.length;return 0===h?(this._version=Math.floor(1e7*Math.random()),this.__isInitialValue=!0,this._multiplier=[1,1,1,1],this._offset=[0,0,0,0],void 0):(t=h>0?t:1,e=h>1?e:1,i=h>2?i:1,n=h>3?n:1,r=h>4?r:0,s=h>5?s:0,o=h>6?o:0,a=h>7?a:0,this._version=Math.floor(1e7*Math.random()),this.__isInitialValue=1==t&&1==e&&1==i&&1==n&&0==r&&0==s&&0==o&&0==a,this._multiplier=[t,e,i,n],this._offset=[r,s,o,a],void 0)};return h.prototype=Object.create({},{_increment:{writable:!0,value:function(){this._version++,this.__isInitialValue=!1}},_getVersion:{writable:!0,value:function(){return this._version}},_isInitialValue:{writable:!0,value:function(){return this.__isInitialValue}},color:{get:function(){return t(this._offset[r],this._offset[s],this._offset[o])},set:function(t){this._multiplier[r]=1,this._multiplier[s]=1,this._multiplier[o]=1,this._offset[r]=e(t),this._offset[s]=i(t),this._offset[o]=n(t),this._increment()}},alphaMultiplier:{get:function(){return this._multiplier[a]},set:function(t){this._multiplier[a]=t,this._increment()}},redMultiplier:{get:function(){return this._multiplier[r]},set:function(t){this._multiplier[r]=t,this._increment()}},greenMultiplier:{get:function(){return this._multiplier[s]},set:function(t){this._multiplier[s]=t,this._increment()}},blueMultiplier:{get:function(){return this._multiplier[o]},set:function(t){this._multiplier[o]=t,this._increment()}},alphaOffset:{get:function(){return this._offset[a]},set:function(t){this._offset[a]=t,this._increment()}},redOffset:{get:function(){return this._offset[r]},set:function(t){this._offset[r]=t,this._increment()}},greenOffset:{get:function(){return this._offset[s]},set:function(t){this._offset[s]=t,this._increment()}},blueOffset:{get:function(){return this._offset[o]},set:function(t){this._offset[o]=t,this._increment()}},clone:{writable:!0,value:function(){var t=new h(this._multiplier[r],this._multiplier[s],this._multiplier[o],this._multiplier[a],this._offset[r],this._offset[s],this._offset[o],this._offset[a]);return t._version=this._version,t}},concat:{writable:!0,value:function(t){if(!t._isInitialValue())if(t._isInitialValue()){var e=t._multiplier,i=t._offset;this._multiplier[r]=e[r],this._multiplier[s]=e[s],this._multiplier[o]=e[o],this._multiplier[a]=e[a],this._offset[r]=i[r],this._offset[s]=i[s],this._offset[o]=i[o],this._offset[a]=i[a],this._increment()}else this._concat(t._multiplier,t._offset)}},_concat:{writable:!0,value:function(t,e){this._multiplier[r]*=t[r],this._multiplier[s]*=t[s],this._multiplier[o]*=t[o],this._multiplier[a]*=t[a],this._offset[r]=this._offset[r]*t[r]+e[r],this._offset[s]=this._offset[s]*t[s]+e[s],this._offset[o]=this._offset[o]*t[o]+e[o],this._offset[a]=this._offset[a]*t[a]+e[a],this._increment()}},_isAlphaTransform:{writable:!0,value:function(){return 1!=this._multiplier[a]&&1==this._multiplier[r]&&1==this._multiplier[s]&&1==this._multiplier[o]&&0==this._offset[r]&&0==this._offset[s]&&0==this._offset[o]&&0==this._offset[a]}},_isColorTransform:{writable:!0,value:function(){return!this._isInitialValue()&&!this._isAlphaTransform()}},_getValueArray:{writable:!0,value:function(){var t=[];return t[0]=this._multiplier[r],t[1]=this._multiplier[s],t[2]=this._multiplier[o],t[3]=this._multiplier[a],t[4]=this._offset[r]/255,t[5]=this._offset[s]/255,t[6]=this._offset[o]/255,t[7]=this._offset[a]/255,t}}}),h}),herlock.define("module/view_css/geom/geom",["./Point","./Rectangle","./Matrix","./ColorTransform"],function(t,e,i,n){var r={installTo:function(r){r.Point=t,r.Rectangle=e,r.Matrix=i,r.ColorTransform=n},initJs:function(){}};return r}),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,function(){var t=document.createElement("div").style,e={transform:"webkitTransform"in t?"webkitTransform":"MozTransform"in t?"MozTransform":"transform",transformOrigin:"webkitTransformOrigin"in t?"webkitTransformOrigin":"MozTransformOrigin"in t?"MozTransformOrigin":"transformOrigin"};if("webkitTransform"in t?window.__setTransform=function(t,e){t.webkitTransform=e}:"MozTransform"in t?window.__setTransform=function(t,e){t.MozTransform=e}:"transform"in t&&(window.__setTransform=function(t,e){t.transform=e}),!("transformOrigin"in t)){var i={};for(var n in e)(function(t,e){i[t]={get:function(){return this[e]},set:function(t){this[e]=t}}})(n,e[n]);Object.defineProperties(CSSStyleDeclaration.prototype,i)}}(),herlock.define("module/view_css/NJView",["lib/Class","module/NJModule","./window/window","./layer/Layer","./image/Image","./flash/flash","./geom/geom","./geom/Rectangle","module/view/touch/TouchEventInfo","./flash/internal/renderer/CSSRenderingSystem"],function(t,e,i,n,r,s,o,a,h,l){var c=t(e,function(t,e){t.constructor=function(t,i,n){e.constructor.apply(this,arguments),l.container=this._container=t,l.width=this._width=i,l.height=this._height=n,this._layers=[];var r=this;requestAnimationFrame(function(){r._onDrawFrame(),requestAnimationFrame(arguments.callee)});var s=!1,o=function(t){var e,i=!0;switch(t.type){case"mousedown":s=!0,e=h.DOWN;break;case"mousemove":if(!s)return;e=h.MOVE;break;case"mouseup":s=!1,e=h.UP,i=!1;break;case"mouseleave":if(!s)return;s=!1,e=h.CANCEL,i=!1}var n=new h(e);if(touchEnabled||-1===t.type.indexOf("mouse")){if(-1!==t.type.indexOf("touch")){touchEnabled=!0;for(var o=t.touches,a=t.changedTouches,l=0;o.length>l;l++){var c,u,_=o[l];if(c=_.clientX-t.currentTarget.offsetLeft,u=_.clientY-t.currentTarget.offsetTop,""!==this.style.transform){var f,d={x:c,y:u},g=this.style.transform,m=[];-1!==g.indexOf("matrix")&&g.split(",").forEach(function(t){m.push(parseFloat(t))}),-1!==g.indexOf("scale")&&(f=g.split("scale(")[1].split(","))&&(m=[parseFloat(f[0]),0,0,parseFloat(f[1]),0,0]),c=d.x*m[0]+d.y*m[2]+1*m[4],u=d.x*m[1]+d.y*m[3]+1*m[5]}n.addTouchPoint(_.identifier,c,u,!1,!0)}for(var l=0;a.length>l;l++){var c,u,_=a[l];if(c=_.clientX-t.currentTarget.offsetLeft,u=_.clientY-t.currentTarget.offsetTop,""!==this.style.transform){var f,d={x:c,y:u},g=this.style.transform,m=[];-1!==g.indexOf("matrix")&&g.split(",").forEach(function(t){m.push(parseFloat(t))}),-1!==g.indexOf("scale")&&(f=g.split("scale(")[1].split(","))&&(m=[parseFloat(f[0]),0,0,parseFloat(f[1]),0,0]),c=d.x*m[0]+d.y*m[2]+1*m[4],u=d.x*m[1]+d.y*m[3]+1*m[5]}n.addTouchPoint(_.identifier,c,u,!0,i)}}}else{var c,u;if(c=t.clientX-t.currentTarget.offsetLeft,u=t.clientY-t.currentTarget.offsetTop,""!==this.style.transform){var f,d={x:c,y:u},g=this.style.transform,m=[];-1!==g.indexOf("matrix")&&g.split(",").forEach(function(t){m.push(parseFloat(t))}),-1!==g.indexOf("scale")&&(f=g.split("scale(")[1].split(","))&&(m=[parseFloat(f[0]),0,0,parseFloat(f[1]),0,0]),c=d.x*m[0]+d.y*m[2]+1*m[4],u=d.x*m[1]+d.y*m[3]+1*m[5]}n.addTouchPoint("mouse",c,u,!0,i)}r._notifyTouch(n)};this._container.addEventListener("touchstart",o),this._container.addEventListener("touchend",o),this._container.addEventListener("touchmove",o),this._container.addEventListener("touchcancel",o),this._container.addEventListener("mousemove",o),this._container.addEventListener("mouseup",o),this._container.addEventListener("mousedown",o),this._container.addEventListener("mouseleave",o)},t.getName=function(){return"View"},t.installTo=function(t){i.installTo(t,this),t.Layer=n,t.Image=r,s.installTo(t),o.installTo(t)},t.initJs=function(t){i.initJs(t),s.initJs(t),o.initJs(t)},t.start=function(){},t.reset=function(){},t.addLayer=function(t){return this.addLayerAt(t,this._layers.length)},t.addLayerAt=function(t,e){var i=t.isInstanceOf(n)?t:new n(t);return-1!=this.getLayerIndex(i)&&this.removeLayer(i),this._layers.splice(e,0,i),i._addedTo(this),i},t.getLayerAt=function(t){return this._layers[t]},t.getLayerIndex=function(t){return this._layers.indexOf(t)},t.removeLayer=function(t){return this.removeLayerAt(this._layers.indexOf(t))},t.removeLayerAt=function(t){var e=this.getLayerAt(t);return this._layers.splice(t,1),e},t.getViewWidth=function(){return this._width},t.getViewHeight=function(){return this._height},t.getViewTop=function(){return 0},t.getViewLeft=function(){return 0},t._onDrawFrame=function(){var t=this._glPrepare();this._glRender(t),this._notifyDrawFrame()},t._glPrepare=function(){if(!(0>=this._layers.length)){for(var t=this._layers.length,e=[],i=0;t>i;i++){var n=this._layers[i]._glPrepare();n&&e.push(n)}return e}},t._glRender=function(t){if(!(0>=this._layers.length)){for(var e=t.length,i=0;e>i;i++)t[i].processData();for(var i=0;e>i;i++){var n=t[i];n.render()}}},t._notifyDrawFrame=function(){for(var t in this._layers)this._layers[t]._notifyDrawFrame()},t._notifyTouch=function(t){for(var e=this._layers.slice(),i=e.length,n=0;i>n;n++)e[n]._notifyTouch(t)}});return c}),herlock.define("module/view_canvas/window/window",[],function(){var t={installTo:function(t,e){t.addLayer=function(t){return e.addLayer(t)},t.addLayerAt=function(t,i){return e.addLayer(t,i)},t.getLayerAt=function(t){return e.getLayerAt(t)},t.getLayerIndex=function(t){return e.getLayerIndex(t)},t.removeLayer=function(t){return e.removeLayer(t)},t.removeLayerAt=function(t){return e.removeLayerAt(t)},t.innerWidth=e.getViewWidth();
try{Object.defineProperties(t,{innerWidth:{get:function(){return e.getViewWidth()}},innerHeight:{get:function(){return e.getViewHeight()}}})}catch(i){console.log("SafariはinnerWidth,innerHeightが更新できません。"),t.innerWidth=e.getViewWidth(),t.innerHeight=e.getViewHeight()}t.setOrientationType=function(){}},initJs:function(){}};return t}),herlock.define("module/view_canvas/layer/Layer",["lib/Class","module/view/touch/TouchEventInfo"],function(t){var e=t(Object,function(t,n){t.constructor=function(t){n.constructor.apply(this,arguments),this._content=null,this._renderingObject=new i,this._calcRequested=!0,this._horizontalAlign=e.Align.CENTER,this._verticalAlign=e.Align.MIDDLE,this._scaleMode=e.ScaleMode.SHOW_ALL,this._colorTransform=new ColorTransform,this._backgroundColor=16777215,this._backgroundAlpha=0,this._offsetPercentX=0,this._offsetPercentY=0,this._module=null,this._matrix=new Matrix,this._contentMatrix=new Matrix,this._contentDisplayRect=new Rectangle,t&&(this.content=t)},t.content={get:function(){return this._content},set:function(t){null!=this._content&&this._content._onRemovedFrom(this),this._calcRequested=!0,this._content=t,null!=t&&this._content._onAddedTo(this)}},t.contentScaleX={get:function(){return this._getContentMatrix()._getScaleX()}},t.contentScaleY={get:function(){return this._getContentMatrix()._getScaleY()}},t.horizontalAlign={get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign=t,this._calcRequested=!0}},t.verticalAlign={get:function(){return this._verticalAlign},set:function(t){this._verticalAlign=t,this._calcRequested=!0}},t.scaleMode={get:function(){return this._scaleMode},set:function(t){this._scaleMode=t,this._calcRequested=!0}},t.offsetX={get:function(){return this._offsetPercentX},set:function(t){this._offsetPercentX=t,this._calcRequested=!0}},t.offsetY={get:function(){return this._offsetPercentY},set:function(t){this._offsetPercentY=t,this._calcRequested=!0}},t.alpha={get:function(){return this._colorTransform.getAlphaMultiplier()},set:function(t){this._colorTransform.getAlphaMultiplier(t)}},t.backgroundColor={get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t}},t.backgroundAlpha={get:function(){return this._backgroundAlpha},set:function(t){this._backgroundAlpha=t}},t._notifyDrawFrame=function(){this._content&&this._content._notifyDrawFrame()},t._addedTo=function(t){this._module=t,calcRequested=!0},t._removedFrom=function(){this._module=null},t._notifyResizeView=function(t,e){null!=this._content&&this._content._notifyResizeView(t,e),this._calcRequested=!0},t._notifyResizeContent=function(){this._calcRequested=!0},t._notifyTouch=function(t){this._content&&this._content._dispatchTouchEvent(t)},t._calculate=function(){if(null!=this._module&&null!=this._content){this._calcRequested=!1;var t=this._module.getViewWidth(),i=this._module.getViewHeight(),n=t/i,r=this._content._getContentWidth(),s=this._content._getContentHeight(),o=r/s;if(this._scaleMode==e.ScaleMode.EXACT_FIT)this._contentMatrix._setScaleX(t/r),this._contentMatrix._setScaleY(i/s);else if(this._scaleMode==e.ScaleMode.SHOW_ALL){var a;a=o>n?t/r:i/s,this._contentMatrix._setScaleX(a),this._contentMatrix._setScaleY(a)}else if(this._scaleMode==e.ScaleMode.NO_BORDER){var a;a=n>o?t/r:i/s,this._contentMatrix._setScaleX(a),this._contentMatrix._setScaleY(a)}else this._scaleMode==e.ScaleMode.NO_SCALE&&(this._contentMatrix._setScaleX(1),this._contentMatrix._setScaleY(1));this._matrix._setX(t*this._offsetPercentX),this._matrix._setY(i*this._offsetPercentY),this._contentDisplayRect.width=this._content._getContentWidth()*this._contentMatrix._getScaleX(),this._contentDisplayRect.height=this._content._getContentHeight()*this._contentMatrix._getScaleY(),this._contentDisplayRect.x=this._matrix._getX(),this._contentDisplayRect.y=this._matrix._getY();var h=0,l=0;this._horizontalAlign==e.Align.LEFT?h+=0:this._horizontalAlign==e.Align.CENTER?h+=.5*(t-this._contentDisplayRect.width):this._horizontalAlign==e.Align.RIGHT&&(h+=1*(t-this._contentDisplayRect.width)),this._verticalAlign==e.Align.TOP?l+=0:this._verticalAlign==e.Align.MIDDLE?l+=.5*(i-this._contentDisplayRect.height):this._verticalAlign==e.Align.BOTTOM&&(l+=1*(i-this._contentDisplayRect.height)),this._contentDisplayRect.x+=h,this._contentDisplayRect.y+=l,this._contentMatrix._setX(h),this._contentMatrix._setY(l)}},t._getMatrix=function(){return this._calcRequested&&this._calculate(),this._matrix.clone()},t._getContentMatrix=function(){return this._calcRequested&&this._calculate(),this._contentMatrix.clone()},t._getContentDisplayRect=function(){return this._calcRequested&&this._calculate(),this._contentDisplayRect},t._glPrepare=function(){if(null==this._module)return null;if(null==this._content)return null;var t=new Matrix;return this._renderingObject.contentRenderingObject=this._content._glPrepare(t,this._colorTransform),this._renderingObject}});e.Align={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom",LEFT:"left",CENTER:"center",RIGHT:"right",NONE:"none"},e.ScaleMode={EXACT_FIT:"exactFit",NO_BORDER:"noBorder",NO_SCALE:"noScale",SHOW_ALL:"showAll",MODE_NONE:"none"};var i=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.viewport=null,t.contentRenderingObject=null,t.processData=function(){this.contentRenderingObject&&this.contentRenderingObject.processData()},t.renderOffscreen=function(){},t.render=function(){this.contentRenderingObject&&this.contentRenderingObject.render()}});return e}),herlock.define("module/view_canvas/image/Image",["lib/Class","module/common/event/EventDispatcher","lib/URL","module/graphics/BitmapProxy"],function(t,e,i,n){var r=t(e,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._src="",this._bitmapProxy=null,t&&(this.src=t)},t.src={get:function(){this._src},set:function(t){this._src=t;var e=new i(t);this._image=null;var r=document.createElement("img"),s=window.__herlock_ctx,o=this;r.onload=function(){o._image=r,o._bitmapProxy=new n(o._image),o._dispatchEventAndCallHandler(new Event("load"))},r.src=""===e.host?s._rootPath+e:""+e}},t.complete={get:function(){}},t.width={get:function(){return this._image?this._image.width:0}},t.height={get:function(){return this._image?this._image.height:0}},t.naturalWidth={get:function(){return this._image?this._image.width:0}},t.naturalHeight={get:function(){return this._image?this._image.height:0}},t.onload=function(){},t.onerror=function(){},t._getBitmap=function(){return this._bitmapProxy}});return r}),herlock.define("module/view_canvas/flash/internal/renderer/RenderingNode",["lib/Class","module/view/flash/display/BlendMode","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(t,e,i,n){var r=t(Object,function(t,r){t.constructor=function(){r.constructor.apply(this,arguments),this._matrix=new i,this._colorTransform=new n,this.children=[],this.concatenatedMatrix=new i,this.concatenatedColorTransform=new n,this.concatenatedBlendMode="normal"},t.mask=null,t.visible=!0,t.cacheAsBitmap=!1,t.matrixIsUpdated=!1,t.concatenatedMatrixIsUpdated=!1,t.colorTransformIsUpdated=!1,t.concatenatedColorTransformIsUpdated=!1,t.blendMode="normal",t.setMatrix=function(t){return this._matrix._getVersion()==t._getVersion()?(this.matrixIsUpdated=!1,void 0):(this._matrix=t.clone(),this.matrixIsUpdated=!0,void 0)},t.getMatrix=function(){return this._matrix.clone()},t.setColorTransform=function(t){return this._colorTransform._getVersion()==t._getVersion()?(this.colorTransformIsUpdated=!1,void 0):(this._colorTransform=t.clone(),this.colorTransformIsUpdated=!0,void 0)},t.getColorTransform=function(){return this._colorTransform},t.visit=function(t){var i=t.parent;i.concatenatedMatrixIsUpdated||this.matrixIsUpdated?(this.concatenatedMatrix=this.getMatrix(),this.concatenatedMatrix.concat(i.concatenatedMatrix),this.concatenatedMatrixIsUpdated=!0):this.concatenatedMatrixIsUpdated=!1,i.concatenatedColorTransformIsUpdated||this.colorTransformIsUpdated?(this.concatenatedColorTransform=this._colorTransform,this.concatenatedColorTransform.concat(i.concatenatedColorTransform),this.concatenatedColorTransformIsUpdated=!0):this.concatenatedColorTransformIsUpdated=!1,this.visible=this.visible&&i.visible,this.mask=i.mask?i.mask:this.mask,this.blendMode=this.blendMode==e.NORMAL?i.blendMode:this.blendMode,t.parent=this;for(var n=this.children.length,r=0;n>r;++r)this.children[r].visit(t.clone())},t.getBoundingBox=function(t){if(this.visible)for(var e=this.children.length,i=0;e>i;++i)this.children[i].getBoundingBox(t)}});return r}),herlock.define("module/view_canvas/flash/display/BlendMode",[],function(){var t={NORMAL:"normal",ADD:"add"};return t}),herlock.define("module/view_canvas/flash/geom/Transform",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.colorTransform={get:function(){return this._owner?this._owner._colorTransform.clone():new ColorTransform},set:function(t){this._owner&&!this._owner._setColorTransform(t)}},t.concatenatedColorTransform={get:function(){}},t.concatenatedMatrix={get:function(){}},t.matrix={get:function(){return this._owner?this._owner._matrix.clone():new Matrix},set:function(t){this._owner&&!this._owner._setMatrix(t)}},t._initwithOwner=function(t){this._owner=t},t._getOwner=function(){return this._owner}});return e}),herlock.define("module/view_canvas/flash/display/DisplayObject",["lib/Class","module/common/event/EventDispatcher","../internal/renderer/RenderingNode","./BlendMode","../geom/Transform","module/view/geom/Point","module/view/geom/Rectangle","module/view/geom/Matrix","module/view/geom/ColorTransform"],function(t,e,i,n,r,s,o,a,h){var l=Math.PI,c=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._colorTransform=new h,this._naturalRect=new o,this._boundsRect=new o,this._matrix=new a,this._transformationPoint=null,this._scale9Grid=new o},t._blendMode=n.NORMAL,t._cacheAsBitmap=!1,t._cacheHandle=null,t._visible=!0,t._parent=null,t._mask=null,t._containable=!1,t._interactive=!1,t._xValue=0,t._yValue=0,t._scaleXValue=1,t._scaleYValue=1,t._rotationValue=0,t._skewXValue=0,t._skewYValue=0,t._calcNaturalRectRequested=!0,t._calcBoundsRectRequested=!0,t._calcMatrixRequested=!0,t._enabledTransformationPoint=!1,t.alpha={get:function(){return this._colorTransform.alphaMultiplier},set:function(t){this._colorTransform.alphaMultiplier=t}},t.blendMode={get:function(){return this._blendMode},set:function(t){this._blendMode=t}},t.cacheAsBitmap={get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t}},t.height={get:function(){return this._getBoundsRect().height},set:function(t){this.scaleY=this.scaleY*t/this.height}},t.mask={get:function(){this._mask},set:function(t){this._mask=t}},t.name="",t.parent={get:function(){return this._parent}},t.root={get:function(){return this._parent?this._parent.root:this}},t.scale9Grid={get:function(){return this._scale9Grid.clone()},set:function(t){null===t?this._scale9Grid.setEmpty():this._scale9Grid=t}},t.rotation={get:function(){return this._rotationValue},set:function(t){if(this._enabledTransformationPoint)return this._setRotationWithTransformPoint(t,this.transformationPoint),void 0;for(;t>180;)t-=360;for(;-180>t;)t+=360;this._rotationValue=t;var e=new a;e._setSkewX(this._skewXValue),e._setSkewY(this._skewYValue),e.rotate((this._rotationValue-e._getRotation())/180*l),this._skewXValue=e._getSkewX(),this._skewYValue=e._getSkewY(),this._requestCalcNaturalRect()}},t._setRotationWithTransformPoint=function(t,e){for(var i=this._getMatrix(),n=i.transformPoint(e);t>180;)t-=360;for(;-180>t;)t+=360;this._rotationValue=t;var r=new a;r._setSkewX(this._skewXValue),r._setSkewY(this._skewYValue),r.rotate((this._rotationValue-r._getRotation())/180*l),this._skewXValue=r._getSkewX(),this._skewYValue=r._getSkewY(),this._requestCalcNaturalRect(),i=this._getMatrix();var r=i.transformPoint(e);this._xValue+=n.x-r.x,this._yValue+=n.y-r.y,this._requestCalcNaturalRect()},t.scaleX={get:function(){return this._scaleXValue},set:function(t){return this._scaleXValue!==t?this._enabledTransformationPoint?(this._setScaleXWithTransformPoint(t,this._transformationPoint),void 0):(isNaN(t)&&console.error("debug scaleX",this,t),this._scaleXValue=t,this._requestCalcNaturalRect(),void 0):void 0}},t._setScaleXWithTransformPoint=function(t,e){var i=this._getMatrix(),n=i.transformPoint(e);this._scaleXValue=t,this._requestCalcNaturalRect(),i=this._getMatrix();var r=i.transformPoint(e);this._xValue+=n.x-r.x,this._yValue+=n.y-r.y,this._requestCalcNaturalRect()},t.scaleY={get:function(){return this._scaleYValue},set:function(t){return this._scaleYValue!==t?this._enabledTransformationPoint?(this._setScaleYWithTransformPoint(t,this._transformationPoint),void 0):(this._scaleYValue=t,this._requestCalcNaturalRect(),void 0):void 0}},t._setScaleYWithTransformPoint=function(t,e){var i=this._getMatrix(),n=i.transformPoint(e);this._scaleYValue=t,this._requestCalcNaturalRect(),i=this._getMatrix();var r=i.transformPoint(e);this._xValue+=n.x-r.x,this._yValue+=n.y-r.y,this._requestCalcNaturalRect()},t.stage={get:function(){return this._parent?this._parent.stage:null}},t.transform={get:function(){var t=new r;return t._initwithOwner(this),t},set:function(t){this._setColorTransform(t.getColorTransform()),this._setMatrix(t.getMatrix()),requestCalcNaturalRect()}},t.visible={get:function(){return this._visible},set:function(t){this._visible!=t&&(this._visible=t,this._requestCalcNaturalRect())}},t.width={get:function(){return this._getBoundsRect().width},set:function(t){this.scaleX=this.scaleX*t/this.width}},t.x={get:function(){return this._xValue},set:function(t){this._xValue!==t&&(this._xValue=t,this._requestCalcNaturalRect())}},t.y={get:function(){return this._yValue},set:function(t){this._yValue!==t&&(this._yValue=t,this._requestCalcNaturalRect())}},t.getBounds=function(t){t||(t=this);var e=this._getConcatenatedMatrix(),i=t._getConcatenatedMatrix();i.invert(),e.concat(i);var n=this._getNaturalRect(),r=e._calculateBoundsRect(n);return r},t.getRect=function(t){return getBounds(t)},t.globalToLocal=function(t){var e=this._getConcatenatedMatrix();return e.invert(),e.transformPoint(t)},t.hitTestObject=function(t){var e=this._getNaturalRect(),i=this._getConcatenatedMatrix()._calculateBoundsRect(e);e=t._getNaturalRect();var n=t._getConcatenatedMatrix()._calculateBoundsRect(e),r=i.containsRect(n)||i.intersects(n);return r},t.hitTestPoint=function(t,e,i){var n=this.stage;if(!n)return!1;if(i){var r=this.getBounds(n);return r.containsPoint(new s(t,e))}var r=this.getBounds(n);return r.containsPoint(new s(t,e))},t.localToGlobal=function(t){return this._getConcatenatedMatrix().transformPoint(t)},t.transformationPoint={get:function(){return this._transformationPoint?this._transformationPoint.clone():new s(0,0)},set:function(t){this._transformationPoint=t.clone(),this._enabledTransformationPoint=!0,0==t.x&&0==t.y&&(this._enabledTransformationPoint=!1)}},t._getMatrix=function(){return this._getMatrixRef().clone()},t._getMatrixRef=function(){return this._calcMatrixRequested&&(this._calcMatrixRequested=!1,this._matrix.identity(),this._matrix.scale(this._scaleXValue,this._scaleYValue),this._skewXValue!=this._skewYValue?(this._matrix._setSkewX(this._skewXValue),this._matrix._setSkewY(this._skewYValue)):this._matrix.rotate(this._rotationValue/180*l),this._matrix.translate(this._xValue,this._yValue)),this._matrix},t._setMatrix=function(t){this._xValue=t._getX(),this._yValue=t._getY(),this._rotationValue=t._getRotation(),this._scaleXValue=t._getScaleX(),this._scaleYValue=t._getScaleY(),this._skewXValue=t._getSkewX(),this._skewYValue=t._getSkewY(),this._requestCalcNaturalRect()},t._getColorTransform=function(){return this._colorTransform.clone()},t._getColorTransformRef=function(){return this._colorTransform},t._setColorTransform=function(t){this._colorTransform=t},t._getConcatenatedMatrix=function(){for(var t=this._getMatrix(),e=this.parent;e;){var i=e._getMatrix();t.concat(i),e=e.parent}return t},t._getConcatenatedColorTransform=function(){},t._setParent=function(t){null!=this._parent&&(this._parent=null),null!=t&&(this._parent=t)},t._notifyOnAddedToStage=function(){this._hasEventListener("addedToStage")&&this.dispatchEvent(new Event("addedToStage"))},t._notifyOnRemovedFromStage=function(){this._hasEventListener("removedFromStage")&&this.dispatchEvent(new Event("removedFromStage"))},t._notifyOnEnterFrame=function(){this._hasEventListener("enterFrame")&&this.dispatchEvent(new Event("enterFrame"))},t._notifyOnFrameConstructed=function(){},t._notifyOnExecuteFrameScript=function(){},t._notifyOnExitFrame=function(){this._hasEventListener("exitFrame")&&this.dispatchEvent(new Event("exitFrame"))},t._drawVectorGraphics=function(){},t._glPrepare=function(){var t=this._getRenderingNode();return t.visible=this.visible,t.setMatrix(this._getMatrixRef()),t.setColorTransform(this._getColorTransform()),t.blendMode=this._blendMode,null!=this._mask?t.mask=this._mask._getRenderingNode():null==this._mask&&!!t.mask&&(t.mask=null),t},t._getNaturalRect=function(){return this._calcNaturalRectRequested&&(this._calcNaturalRectRequested=!1,this._calculateNaturalRect()),this._naturalRect},t._calculateNaturalRect=function(){this._naturalRect.setEmpty()},t._requestCalcNaturalRect=function(t){1!=t&&(this._calcMatrixRequested||(this._calcMatrixRequested=!0,this._calcNaturalRectRequested=!0,this._calcBoundsRectRequested=!0,null!==this._parent&&this._parent._requestCalcNaturalRect()))},t._getBoundsRect=function(){if(this._calcBoundsRectRequested){this._calcBoundsRectRequested=!1;var t=this._getNaturalRect();this._boundsRect=this._getMatrix()._calculateBoundsRect(t),isNaN(this._boundsRect.width)&&console.error("debug",this,this._boundsRect)}return this._boundsRect},t._getNodesToRoot=function(){var t=[];if(null==this._parent)return t;for(var e=this;null!=e;)t.push(e),e=e.parent;return t},t._hitTestStrictInternal=function(t){var e=this._getMatrix();e.invert();var i=e.transformPoint(t),n=this._getNaturalRect().containsPoint(i);if(n&&this.mask){var r=this.mask,s=r._getConcatenatedMatrix();s.invert(),i=this._getConcatenatedMatrix().transformPoint(i),i=s.transformPoint(i),n=r._getNaturalRect().containsPoint(i)}return n?this:null},t._renderingNode=null,t._getRenderingNode=function(){return this._renderingNode||(this._renderingNode=this._createRenderingNode()),this._renderingNode},t._createRenderingNode=function(){return new i},t.toString=function(){return'[object DisplayObject name="'+this.name+'"]'}});return c}),herlock.define("module/view_canvas/flash/display/InteractiveObject",["lib/Class","./DisplayObject"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.mouseEnabled=!0});return i}),herlock.define("module/view_canvas/flash/display/DisplayObjectContainer",["lib/Class","./InteractiveObject"],function(t,e){var i=t(e,function(t,i){t.constructor=function(){i.constructor.apply(this,arguments),this._children=[],this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},t.numChildren={get:function(){return this._children.length}},t.mouseChildren=!0,t.addChild=function(t){return this.addChildAt(t,this._children.length)},t.addChildAt=function(t,e){if(!t)return console.log("warning: "+this+".addChild child="+t);if(0>e)return console.log("warning: out of range.");if(e>this._children.length)return console.log("warning: out of range.");t._parent&&t._parent.removeChild(t),this._children.splice(e,0,t),t._setParent(this),this._requestCalcNaturalRect(),this._childrenUpdated();for(var i=[],n=t._getNodesToRoot(),r=n.length-1;r>=0;r--)i.push(n[r]);return t._propagateEvent(new Event("added"),i),t.stage&&t._notifyOnAddedToStage(),t},t.getChildIndex=function(t){return this._children.indexOf(t)},t.getChildAt=function(t){return t>=this._children.length?null:this._children[t]},t.getChildByName=function(t){for(var e=this._children.length-1;e>=0;e--)if(this._children[e].name===t)return this._children[e];return null},t.removeChild=function(t){var e=this._children.indexOf(t);return-1===e?console.log("warning: "+this+".removeChild("+t+")"):this.removeChildAt(e)},t.removeChildAt=function(t){if(0>t)return console.log("warning: out of range.");if(t>=this._children.length)return console.log("warning: out of range.");for(var e=this._children[t],i=[],n=e._getNodesToRoot(),r=n.length-1;r>=0;r--)i.push(n[r]);return this._children.splice(t,1)[0],e._setParent(null),this._requestCalcNaturalRect(),this._childrenUpdated(),e._propagateEvent(new Event("removed"),i),e.stage||e._notifyOnRemovedFromStage(),e},t.contains=function(t){if(this===t)return!0;if(-1!==this._children.indexOf(t))return!0;for(var e=this._children,i=e.length,n=0;i>n;n++)if(e[n].contains(t))return!0;return!1},t.setChildIndex=function(t,e){this.addChildAt(t,e)},t.swapChildren=function(t,e){var i=this.getChildIndex(t),n=this.getChildIndex(e);-1!=i&&-1!=n&&(this.addChildAt(t,n),this.addChildAt(e,i),this._childrenUpdated())},t.swapChildrenAt=function(t,e){var i=this.numChildren();t>=i||e>=i||0>t||0>e||this.swapChildren(this.getChildAt(t),this.getChildAt(e))},t._childrenUpdated=function(){this._updatedChildrenForWorkChildren=!0,this._updatedChildrenForRenderingNode=!0},t._notifyOnAddedToStage=function(){DisplayObject.prototype._notifyOnAddedToStage.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnAddedToStage()},t._notifyOnRemovedFromStage=function(){DisplayObject.prototype._notifyOnRemovedFromStage.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnRemovedFromStage()},t._notifyOnEnterFrame=function(){DisplayObject.prototype._notifyOnEnterFrame.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnEnterFrame()},t._notifyOnFrameConstructed=function(){DisplayObject.prototype._notifyOnFrameConstructed.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnFrameConstructed()},t._notifyOnExecuteFrameScript=function(){DisplayObject.prototype._notifyOnExecuteFrameScript.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnExecuteFrameScript()},t._notifyOnExitFrame=function(){DisplayObject.prototype._notifyOnExitFrame.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._notifyOnExitFrame()},t._drawVectorGraphics=function(){DisplayObject.prototype._drawVectorGraphics.call(this);for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i]._drawVectorGraphics()},t._glPrepare=function(t){var e=this._getRenderingNode(),i=this._children,n=i.length;if(this._updatedChildrenForRenderingNode){this._updatedChildrenForRenderingNode=!1;var r=e.children;r.length=0;for(var s=0;n>s;s++){var o=i[s]._glPrepare(t);null!=o&&r.push(o)}}else for(var s=0;n>s;s++)i[s]._glPrepare(t);return DisplayObject.prototype._glPrepare.call(this,t)},t._calculateNaturalRect=function(){this._naturalRect.setEmpty();for(var t=this._children.slice(),e=t.length,i=0;e>i;i++)t[i].visible&&(this._naturalRect=this._naturalRect.union(t[i]._getBoundsRect()))},t._hitTestStrictInternal=function(t){if(null==i._hitTestStrictInternal.call(this,t))return null;var n=null,r=this._getMatrix();r.invert(),t=r.transformPoint(t);for(var s=!1,o=this.numChildren-1;o>=0;o--)if(1==this.getChildAt(o).visible&&(n=this.getChildAt(o)._hitTestStrictInternal(t),null!=n)){if(1!=this.mouseChildren)return this;if(1==n.isInstanceOf(e)&&1==n.mouseEnabled)return n;s=!0}return s?this:null},t.toString=function(){return'[object DisplayObjectContainer name="'+this.name+'"]'}});return i}),herlock.define("module/view_canvas/flash/display/Sprite",["lib/Class","./DisplayObjectContainer"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.toString=function(){return'[object Sprite name="'+this.name+'"]'}});return i}),herlock.define("module/view_canvas/flash/internal/renderer/CanvasRenderingSystem",["lib/Class"],function(t){var e=t(Object,function(t){t._container=null,t.width=null,t.height=null,t.constructor=function(){this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._ctx.save(),this._idIncrementor=0,this._curr=[],this._prev=[],this._maskRect=null},t.container={get:function(){return this._container},set:function(t){this._container=t,this._container.appendChild(this._canvas)}},t.width={get:function(){return this._width},set:function(t){this._width=t,this._canvas.width=t}},t.height={get:function(){return this._height},set:function(t){this._height=t,this._canvas.height=t}},t.putBitmapProxy=function(){},t.render=function(t){if(t.bitmapProxy){var e=t.matrix,i=t.clippingRect,n=t.colorTransform.alphaMultiplier,r=t.maskNode,s=!r,o=null;s||(o=new Rectangle,r.getBoundingBox(o),s=o.isEmpty()),s?this._maskRect&&(this._ctx.restore(),this._ctx.save(),this._maskRect=null):this._maskRect&&this._maskRect.equals(o)===!0||(this._ctx.setTransform.apply(this._ctx,[1,0,0,1,0,0]),this._ctx.beginPath(),this._ctx.rect(o.x,o.y,o.width,o.height),this._ctx.clip(),this._maskRect=o),this._ctx.globalAlpha=n,this._ctx.setTransform.apply(this._ctx,e._values),i.isEmpty()?this._ctx.drawImage(t.bitmapProxy.getPixels(),0,0):this._ctx.drawImage(t.bitmapProxy.getPixels(),i.x,i.y,i.width,i.height,0,0,i.width,i.height)}},t.begin=function(){this._ctx.restore(),this._ctx.clearRect(0,0,this._width,this._height),this._ctx.save()},t.end=function(){if(this._curr.length===this._prev.length){for(var t=!0,e=0;this._curr.length>e;e++)t=t&&this._curr[e]===this._prev[e];if(t)return this._prev=this._curr,this._curr=[],void 0}for(var e in this._curr)this._fragment.appendChild(this._curr[e]);this.container.innerHTML="",this.container.appendChild(this._fragment),this._prev=this._curr,this._curr=[]}}),i=new e;return i}),herlock.define("module/view_canvas/flash/events/InteractiveObjectTouchEvent",["lib/Class","module/common/event/Event"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments);var t=arguments.length,i=arguments;this._touchPointID=t>3?i[3]:0,this._isPrimaryTouchPoint=t>4?i[4]:!1,this._localX=t>5?i[5]:0,this._localY=t>6?i[6]:0},t.isPrimaryTouchPoint={get:function(){return this._isPrimaryTouchPoint},set:function(t){this._isPrimaryTouchPoint=t}},t.localX={get:function(){return this._localX},set:function(t){this._localX=t}},t.localY={get:function(){return this._localY},set:function(t){this._localY=t}},t.touchPointID={get:function(){return this._touchPointID},set:function(t){this._touchPointID=t}},t.stageX={get:function(){if(this._hasStagePoint)return this._stagePoint.x;var t=this.target;return t.localToGlobal(new Point(this.localX,this.localY)).x}},t.stageY={get:function(){if(this._hasStagePoint)return this._stagePoint.y;var t=this.target;return t.localToGlobal(new Point(this.localX,this.localY)).y}},t._setStagePoint=function(t){return this._stagePoint=t,this._hasStagePoint=!0,this}});return i}),herlock.define("module/view_canvas/flash/display/Stage",["lib/Class","./Sprite","../internal/renderer/RenderingNode","../internal/renderer/CanvasRenderingSystem","module/view/touch/TouchEventInfo","../events/InteractiveObjectTouchEvent"],function(t,e,i,n,r,s){var o=t(e,function(t,e){t.constructor=function(t,i){e.constructor.apply(this,arguments),this._stageWidth=t||100,this._stageHeight=i||100,this._layer=null,this._frameRate=60,this._quality=null,this._offscreenHandle=null,this._primaryTouchId=-1,this._touchPointerStateDictionary={},this._layerContentRenderObject=null},t.frameRate={get:function(){return this._frameRate},set:function(){}},t.stageWidth={get:function(){return this._stageWidth},set:function(t){this._stageWidth=t,null!=this._layer&&this._layer._notifyResizeContent()}},t.stageHeight={get:function(){return this._stageHeight},set:function(t){this._stageHeight=t,null!=this._layer&&this._layer._notifyResizeContent()}},t.stage={get:function(){return this}},t.height={get:function(){}},t.width={get:function(){}},t.layer={get:function(){}},t._getContentWidth=function(){return this.stageWidth},t._getContentHeight=function(){return this.stageHeight},t.getLayer=function(){return this._layer},t._onAddedTo=function(t){this._layer=t},t._onRemovedFrom=function(){this._layer=NULL},t._glPrepare=function(t,e){this._layerContentRenderObject||(this._layerContentRenderObject=new h);var i={};this._layerContentRenderObject.root=DisplayObjectContainer.prototype._glPrepare.call(this,i);var n=new Matrix;return n.concat(this.getLayer()._getContentMatrix()),n.concat(this.getLayer()._getMatrix()),this._layerContentRenderObject.matrix._equal(n)||(this._layerContentRenderObject.matrix=n),this._layerContentRenderObject.colorTransform=e,this._layerContentRenderObject},t._notifyDrawFrame=function(){this._notifyOnEnterFrame(),this._drawVectorGraphics()},t._notifyResizeView=function(){},t._dispatchTouchEvent=function(t){for(var e=t,i=e.getChangedPointers(),n=i.length,r=0;n>r;r++)this._dispatchTouchEventWithChangedTouchPointer(e,i[r])},t._dispatchTouchEventWithChangedTouchPointer=function(t,e){var i=this._layer._getMatrix(),n=this._layer._getContentMatrix();n.concat(i),n.invert();var o=n.transformPoint(new Point(e.x,e.y)),a=this,h=a._hitTestStrictInternal(o);h||(h=this);var c=h,u=c.globalToLocal(o),_=[];_.push(c);for(var f=c.parent;f;)_.unshift(f),f=f.parent;var d="";switch(t.getAction()){case r.DOWN:d="touchBegin";break;case r.MOVE:d="touchMove";break;case r.UP:d="touchEnd";break;case r.CANCEL:default:d="touchEnd"}0>=Object.keys(this._touchPointerStateDictionary).length&&(this._primaryTouchId=e.id);var g=this._primaryTouchId==e.id,m=new s(d,!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var p=null,h=this._touchPointerStateDictionary[e.id];switch(h&&(p=h,delete this._touchPointerStateDictionary[e.id]),t.getAction()){case r.DOWN:var v=l.create(e.id,c,c);this._touchPointerStateDictionary[e.id]=v;var m=new s("touchOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);for(var x=_.length,w=0;x>w;w++){var m=new s("touchRollOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);_[w].dispatchEvent(m)}break;case r.MOVE:var v=l.create(e.id,p&&p.beganFrom?p.beganFrom:null,c);if(this._touchPointerStateDictionary[e.id]=v,p&&p.overNow==c)break;var m=new s("touchOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var m=new s("touchOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_);var b=-1,a=c,y=[],T=[];if(p&&p.overNow){T=p.overNow._getNodesToRoot();for(var R=T.length;-1==b;){y.push(a);for(var w=0;R>w;w++)if(T[w]==a){b=w;break}if(a=a.parent,!a)break}}if(-1==b)break;for(var w=b-1;w>=0;w--){var m=new s("touchRollOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);T[w].dispatchEvent(m)}for(var C=y.length,w=0;C>w;w++){var m=new s("touchRollOver",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);y[w].dispatchEvent(m)}break;case r.UP:case r.CANCEL:default:var m=new s("touchOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o),S=[];if(p&&p.overNow){S.push(p.overNow);for(var f=p.overNow.parent;f;)S.unshift(f),f=f.parent;m._setTarget(p.overNow)}for(var x=S.length,w=0;x>w;w++){var m=new s("touchRollOut",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);S[w].dispatchEvent(m)}if(t.getAction()!=r.CANCEL&&p&&p.beganFrom&&p.beganFrom===c){var m=new s("touchTap",!0,!0,e.id,g,u.x,u.y)._setStagePoint(o);m._setTarget(_[_.length-1]),_[_.length-1]._propagateEvent(m,_)}this._primaryTouchId==e.id&&(this._primaryTouchId=-1)}},t.toString=function(){return'[object Stage stageWidth="'+this.stageWidth+'" stageHeight="'+this.stageHeight+'"]'}}),a=function(t){t=t||{},this.parent=t.parent||new i,this.offScreenRenderingRequests=t.offScreenRenderingRequests||[],this.renderingRequests=t.renderingRequests||[]};a.prototype={clone:function(){return new a(this)}};var h=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this.visitor=new a,this.visitor.parent=new i,this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.matrix=new Matrix,this.colorTransform=new ColorTransform,this.root=null
},t.processData=function(){var t=new Matrix,e=this.matrix.clone();e.concat(t),this.visitor.parent._matrix._getVersion()!==e._getVersion()?(this.visitor.parent.setMatrix(e),this.visitor.parent.concatenatedMatrix=this.visitor.parent.getMatrix(),this.visitor.parent.concatenatedMatrixIsUpdated=!0):(this.visitor.parent.setMatrix(e),this.visitor.parent.matrixIsUpdated=!1,this.visitor.parent.concatenatedMatrixIsUpdated=!1),this.visitor.offScreenRenderingRequests=[],this.visitor.renderingRequests=[],this.root.visit(this.visitor.clone())},t.renderOffscreen=function(){},t.render=function(){n.begin();for(var t=this.visitor.renderingRequests,e=t.length,i=0;e>i;i++)n.render(t[i]);n.end()}}),l={create:function(t,e,i){return{pointerId:t,beganFrom:e,overNow:i}}};return o}),herlock.define("module/view_canvas/flash/display/BitmapData",["lib/Class","module/graphics/BitmapProxy"],function(t,e){function i(t){return"number"==typeof t}function n(t){return"boolean"==typeof t}var r=t(Object,function(t,r){t.constructor=function(){r.constructor.apply(this,arguments);var t=arguments,s=arguments.length,o=null;if(s>=2&&i(t[0])&&i(t[1])){var a=t[0],h=t[1],l=2046;if(a>=l||h>=l)throw Error("Argument Error. over limit size!! please 2046 > size.");o=e.create(a,h);var c=!0,u=4294967295;s>=3&&n(t[2])&&(c=t[2]),s>=4&&i(t[3])&&(u=t[3]);var _=o.getCanvas();_.setFillColor(u),_.fillRect(0,0,a,h)}else{if(!(s>=1&&t[0].isInstanceOf&&t[0].isInstanceOf(Image)))throw Error("Argument Error");o=t[0]._getBitmap()}this._bitmapProxy=o,this._sheetRow=null},t.width={get:function(){return this._bitmapProxy?this._bitmapProxy.width():0}},t.height={get:function(){return this._bitmapProxy?this._bitmapProxy.height():0}},t.transparent={get:function(){return!0}},t.rect={get:function(){return new Rectangle(0,0,this.width,this.height)}},t.dispose=function(){this._bitmapProxy=null},t._notifyEnterFrame=function(){},t._notifyFrameConstructed=function(){},t._notifyExecuteFrameScript=function(){},t._notifyExitFrame=function(){},t._notifyDrawVectorGraphics=function(){},t._glPrepare=function(){!this._bitmapProxy},t._notifyUpdateForBitmap=function(){},t._getCSSId=function(){return this._sheetRow.id},t.toString=function(){return'[object BitmapData width="'+this.width+'" height="'+this.height+'"]'}});return r}),herlock.define("module/view_canvas/flash/internal/renderer/CanvasRenderingObject",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._bitmapProxy=null},t.bitmapProxy={get:function(){return this._bitmapProxy},set:function(t){this._bitmapProxy!==t&&(this._bitmapProxy=t)}},t.width=null,t.height=null,t.colorTransform=null,t.blendMode=null,t.maskNode=null,t.clippingRect=null,t.getTextureId=function(){return this.textureId}});return e}),herlock.define("module/view_canvas/flash/display/Bitmap",["lib/Class","./DisplayObject","../internal/renderer/RenderingNode","../internal/renderer/CanvasRenderingObject"],function(t,e,i,n){var r=t(e,function(t,i){t.constructor=function(t,e,n,r){i.constructor.apply(this,arguments);var s=arguments.length;this._bitmapData=t,this._pixelSnapping=s>1?e:!1,this._smoothing=s>2?n:!1,this._clippingRect=s>3?r:new Rectangle},t.bitmapData={get:function(){return this._bitmapData},set:function(t){null!=this._bitmapData&&(this._bitmapData=null),null!=t&&(this._bitmapData=t),this._requestCalcNaturalRect()}},t.setClippingRect=function(t){this._clippingRect=t,this._requestCalcNaturalRect()},t._calculateNaturalRect=function(){return null==this.bitmapData?(this._naturalRect.setEmpty(),void 0):this._clippingRect.isEmpty()?(this._naturalRect.width=this.bitmapData.width,this._naturalRect.height=this.bitmapData.height,void 0):(this._naturalRect.width=this._clippingRect.width,this._naturalRect.height=this._clippingRect.height,void 0)},t._glPrepare=function(t){var i=this._getRenderingNode();return i.children=[],null==this.bitmapData?e.prototype._glPrepare.call(this,t):(this.bitmapData._glPrepare(),i.scale9Grid=this.scale9Grid,i.clippingRect=this._clippingRect,i.width=this.bitmapData.width,i.height=this.bitmapData.height,i.bitmapProxy=this.bitmapData._bitmapProxy,e.prototype._glPrepare.call(this,t))},t._createRenderingNode=function(){return new s},t.toString=function(){return'[object Bitmap name="'+this.name+'"]'}}),s=t(i,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._renderingObjects=[new n,new n,new n,new n,new n,new n,new n,new n,new n]},t.clippingRect=null,t.bitmapProxy=null,t.scale9Grid=null,t.width,t.height,t.setMatrix=function(t){e.setMatrix.call(this,t)},t.visit=function(t){if(this.bitmapProxy){if(!this.visible||!t.parent.visible)return i.prototype.visit.call(this,t),void 0;this.scale9Grid.isEmpty()&&i.prototype.visit.call(this,t);var e=this.concatenatedMatrix.clone(),n=this._renderingObjects[0];n.bitmapProxy=this.bitmapProxy,n.blendMode=this.blendMode,n.maskNode=this.mask,n.colorTransform=this.concatenatedColorTransform,n.matrix=e,n.offsetX=0,n.offsetY=0,n.width=this.width,n.height=this.height,n.clippingRect=this.clippingRect,1!=this.clippingRect.isEmpty()&&(n.offsetX+=this.clippingRect.x,n.offsetY+=this.clippingRect.y,n.width=this.clippingRect.w,n.height=this.clippingRect.h),t.renderingRequests.push(n)}},t.getBoundingBox=function(t){var e=this.concatenatedMatrix,i=new Rectangle(0,0,this.bitmapProxy.width(),this.bitmapProxy.height());this.clippingRect.isEmpty()!==!0&&(i.width=this.clippingRect.width,i.height=this.clippingRect.height),i.x=0,i.y=0;var n=e._calculateBoundsRect(i),r=t.union(n);t._set(r.x,r.y,r.width,r.height)}});return r}),herlock.define("module/view_canvas/flash/text/TextFormat",["lib/Class"],function(t){var e=t(Object,function(t,e){t.constructor=function(t,i,n,r,s,o,a,h,l,c,u,_,f){e.constructor.apply(this,arguments);var d=arguments.length;d>=1&&(this.font=t),d>=2&&(this.size=i),d>=3&&(this.color=n),d>=4&&(this.bold=r),d>=5&&(this.italic=s),d>=6&&(this.underline=o),d>=7&&(this.url=a),d>=8&&(this.target=h),d>=9&&(this.align=l),d>=10&&(this.leftMargin=c),d>=11&&(this.rightMargin=u),d>=12&&(this.indent=_),d>=13&&(this.leading=f)},t.align="left",t.blockIndent=0,t.bold=!1,t.color=0,t.font="",t.indent=0,t.italic=!1,t.kerning=!1,t.leading=0,t.leftMargin=0,t.letterSpacing=0,t.rightMargin=0,t.size=12,t.underline=!1,t.toString=function(){return"[object TextFormat]"}});return e}),herlock.define("module/view_canvas/flash/text/TextFieldAutoSize",[],function(){var t={NONE:"none",CENTER:"center",LEFT:"left",RIGHT:"right"};return t}),herlock.define("module/view_canvas/flash/text/TextFormatAlign",[],function(){var t={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"};return t}),herlock.define("module/view_canvas/flash/text/TextField",["lib/Class","../display/InteractiveObject","./TextFormat","./TextFieldAutoSize","./TextFormatAlign","module/graphics/BitmapProxy","../internal/renderer/RenderingNode","../internal/renderer/CanvasRenderingObject"],function(t,e,i,n,r,s,o,a){function h(t,e){return 16777216*parseInt(255*e)+t}var l=2,c=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments),this._text="",this._drawTextRequested=!0,this._calcTextRequested=!0,this._bitmapProxy=null,this._textureImageHandle=null,this._autoSize=n.NONE,this._background=!1,this._backgroundColor=16777215,this._border=!1,this._borderColor=0,this._defaultTextFormat=null,this._multiline=!1,this._wordWrap=!1,this._scrollH=0,this._scrollV=0,this._maxScrollH=0,this._maxScrollV=0,this._maxChars=0,this._bottomScrollV=0,this._naturalRect.height=100,this._naturalRect.width=100,this._defaultTextFormat=new i,this._bitmapProxy=s.create(10,10)},t.autoSize={get:function(){return this._autoSize},set:function(t){this._autoSize!=t&&(this._autoSize=t,this._requestCalcNaturalRect())}},t.background={get:function(){return this._background},set:function(t){this._background!=t&&(this._background=t,this._requestCalcAndDrawText())}},t.backgroundColor={get:function(){return this._backgroundColor},set:function(t){this._backgroundColor!=t&&(this._backgroundColor=t,this._requestCalcAndDrawText())}},t.border={get:function(){return this._border},set:function(t){this._border!=t&&(this._border=t,this._requestCalcAndDrawText())}},t.borderColor={get:function(){return this._borderColor},set:function(t){this._borderColor!=t&&(this._borderColor=t,this._requestCalcAndDrawText())}},t.bottomScrollV={get:function(){return this._bottomScrollV}},t.defaultTextFormat={get:function(){return this._defaultTextFormat},set:function(t){null!=this._defaultTextFormat&&(delete this._defaultTextFormat,this._defaultTextFormat=null),this._defaultTextFormat=t,this._requestCalcAndDrawText()}},t.length={get:function(){return this._text.length}},t.maxChars={get:function(){return this._maxChars},set:function(t){this._=t}},t.maxScrollH={get:function(){return this._maxScrollH}},t.maxScrollV={get:function(){return this._maxScrollV}},t.multiline={get:function(){return this._multiline},set:function(t){this._multiline!=t&&(this._multiline=t,this._requestCalcAndDrawText())}},t.numLines={get:function(){return this._calcTextRequested&&this._calcText(),this._numOfLines}},t.scrollH={get:function(){return this._scrollH},set:function(t){this._scrollH=t,this._requestCalcAndDrawText()}},t.scrollV={get:function(){return this._scrollV},set:function(t){this._scrollV=t,this._requestCalcAndDrawText()}},t.text={get:function(){return this._text},set:function(t){this._text=t,this._requestCalcAndDrawText(),this._requestCalcNaturalRect()}},t.textColor={get:function(){return this._defaultTextFormat.color},set:function(t){this._defaultTextFormat.color=t,this._requestCalcAndDrawText()}},t.textHeight={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.h}},t.textWidth={get:function(){return this._calcTextRequested&&this._calcText(),this._textRect.w}},t.type={get:function(){return this._type},set:function(t){this._type=t}},t.wordWrap={get:function(){return this._wordWrap},set:function(t){this._wordWrap=t,this._requestCalcAndDrawText()}},t.appendText=function(t){this._text+=t,this._requestCalcAndDrawText()},t.getTextFormat=function(){return this._defaultTextFormat},t.setTextFormat=function(t){this._defaultTextFormat&&(this._defaultTextFormat=null),this._defaultTextFormat=t,this._requestCalcAndDrawText()},t.height={get:function(){return this._getBoundsRect().height},set:function(t){this._naturalRect.height!=t&&(this._naturalRect.height=t,this._requestCalcNaturalRect())}},t.width={get:function(){return this._getBoundsRect().width},set:function(t){this._naturalRect.width!=t&&(this._naturalRect.width=t,this._requestCalcNaturalRect())}},t._requestCalcAndDrawText=function(){this._drawTextRequested=!0,this._calcTextRequested=!0},t._drawVectorGraphics=function(){},t._glPrepare=function(t){this._drawTextRequested&&this._drawText();var i=this._getRenderingNode();return i.bitmapProxy=this._bitmapProxy,e._glPrepare.call(this,t)},t._calculateNaturalRect=function(){switch(this._calcTextRequested&&this._calcText(),this._defaultTextFormat,this._autoSize){case n.NONE:break;case n.LEFT:var t=new Rectangle;t.width=this._textRect.width+2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*l,this._naturalRect=t;break;case n.CENTER:var e=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*l,this._naturalRect=t,this.x=this.x+(e-t.width)/2;break;case n.RIGHT:var e=this._naturalRect.width,t=new Rectangle;t.width=this._textRect.width+2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin,t.height=this._textRect.height+2*l,this._naturalRect=t,this.x=this.x+(e-t.width)}},t._requestCalcNaturalRect=function(t){t||(this._requestCalcAndDrawText(),e._requestCalcNaturalRect.call(this,t))},t._drawText=function(){var t=this._getMatrix();if(0!=t._getScaleX()&&0!=t._getScaleY()){var e=this._getNaturalRect(),i=new Rectangle(0,0,t._getScaleX()*e.width,t._getScaleY()*e.height);this._drawTextRequested=!1,this._bitmapProxy&&i.width==this._bitmapProxy.width()&&i.height==this._bitmapProxy.height()||(this._bitmapProxy=s.create(i.width,i.height));var n=this._bitmapProxy.getCanvas();this._background?(n.setFillColor(h(this._backgroundColor,1)),n.fillRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())):n.clear(),this._border&&(n.setStrokeColor(h(this._borderColor,1)),n.strokeRect(0,0,this._bitmapProxy.width(),this._bitmapProxy.height())),n.setFillColor(h(this._defaultTextFormat.color,1)),n.setFontSize(this._defaultTextFormat.size*t._getScaleY()),n.setLetterSpacing(this._defaultTextFormat.letterSpacing);for(var o=this._calcTextLinePositions(),a=n.getFontMetrics(),c=a.ascent,u=a.descent,_=this._defaultTextFormat.leading,f=l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,d=l,g=o.length,m=0;g>m;m+=2){var p=o[m],v=o[m+1];if(!(0>p)){var x=this.text.substring(p,v+1);switch(f=l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent,(0==m||o[m-1]+1!=p)&&(f+=this._defaultTextFormat.indent),this._defaultTextFormat.align){case r.LEFT:break;case r.CENTER:var w=n.measureText(x);f+=(i.width-f-this._defaultTextFormat.rightMargin-w)/2;break;case r.RIGHT:var w=n.measureText(x);f+=i.width-f-this._defaultTextFormat.rightMargin-w;break;case r.JUSTIFY:}d=m/2*(-c+u+_),n.fillText(f,d,x)}}}},t._calcText=function(){calcTextRequested=!1;var t=this._getMatrix(),e=this._calcTextLinePositions(),i=this._bitmapProxy.getCanvas();if(i.setFontSize(this._defaultTextFormat.size*t._getScaleY()),i.setLetterSpacing(this._defaultTextFormat.letterSpacing),this._textRect=new Rectangle,this._wordWrap)this._textRect.width=this._naturalRect.width-(2*l+this._defaultTextFormat.leftMargin+this._defaultTextFormat.blockIndent+this._defaultTextFormat.rightMargin);else for(var n=e.length,r=0;n>r;r+=2){var s=e[r],o=e[r+1];if(!(0>s)){var a=this._text.substring(s,o+1),h=i.measureText(a);h>this._textRect.width&&(this._textRect.width=h)}}var c=i.getFontMetrics(),u=c.ascent,_=c.descent,f=this._defaultTextFormat.leading,d=e.length/2;this._textRect.height=(-u+_)*d+f*(d-1)},t._calcTextLinePositions=function(){var t=this._text,e=[];e.push(0);var i;for(i=0;;){var n=t.indexOf("\r",i);if(-1==n)break;var r=n;t.length>r+1&&"\n"==t.charAt(r+1)?(e.push(r-1),e.push(r+2)):(e.push(r-1),e.push(r+1)),i=n+1}for(i=0;;){var n=t.indexOf("\n",i);if(-1==n)break;var r=n;r-1>=0&&"\r"!=t.charAt(r-1)&&(e.push(r-1),e.push(r+1)),i=n+1}if(e.push(t.length-1),e.sort(function(t,e){return t-e}),1!=this._wordWrap)return e;var s=this._getConcatenatedMatrix(),o=new Rectangle(l,l,2*-l+s._getScaleX()*this._naturalRect.width-this._defaultTextFormat.leftMargin-this._defaultTextFormat.blockIndent-this._defaultTextFormat.rightMargin,2*-l+s._getScaleY()*this._naturalRect.height),a=this._bitmapProxy.getCanvas();a.setFontSize(this._defaultTextFormat.size*s._getScaleY()),a.setLetterSpacing(this._defaultTextFormat.letterSpacing);for(var h=e.slice(),c=0;h.length>c;){var u=h[c];c++,-1==u&&(u=0);var _=h[c];h.length>c&&c++;for(var f=_-u+1,d=t.substring(u,_+1),g=a.breakText(d,o.width-this._defaultTextFormat.indent);f>g;){e.push(u+g-1),e.push(u+g),u+=g,f=_-u+1;var d=t.substring(u,_+1);if(g=a.breakText(d,o.width),g==f)break}}return e.sort(function(t,e){return t-e}),e},t._createRenderingNode=function(){return new u},t.toString=function(){return'[object TextField name="'+this.name+'"]'}}),u=t(o,function(t,e){t.object,t.width,t.height,t.clippingRect=null,t.bitmapProxy=null,t.scale9Grid=null,t.constructor=function(){e.constructor.call(this),this.object=new a,this.clippingRect=new Rectangle,this.scale9Grid=new Rectangle},t.visit=function(t){if(this.bitmapProxy){if(!this.visible||!t.parent.visible)return e.visit.call(this,t),void 0;this.scale9Grid.isEmpty()&&e.visit.call(this,t);var i=this.concatenatedMatrix.clone(),n=this.object;n.bitmapProxy=this.bitmapProxy,n.blendMode=this.blendMode,n.maskNode=this.mask,n.colorTransform=this.concatenatedColorTransform,n.matrix=i,n.offsetX=0,n.offsetY=0,n.width=this.width,n.height=this.height,n.clippingRect=this.clippingRect,1!=this.clippingRect.isEmpty()&&(n.offsetX+=this.clippingRect.x,n.offsetY+=this.clippingRect.y,n.width=this.clippingRect.w,n.height=this.clippingRect.h),t.renderingRequests.push(n)}}});return c}),herlock.define("module/view_canvas/flash/flash",["./display/DisplayObject","./display/InteractiveObject","./display/DisplayObjectContainer","./display/Sprite","./display/Stage","./display/BitmapData","./display/Bitmap","./text/TextField","./text/TextFieldAutoSize","./text/TextFormat","./geom/Transform","./events/InteractiveObjectTouchEvent"],function(t,e,i,n,r,s,o,a,h,l,c,u){var _={installTo:function(_){_.DisplayObject=t,_.InteractiveObject=e,_.DisplayObjectContainer=i,_.Sprite=n,_.Stage=r,_.BitmapData=s,_.Bitmap=o,_.TextField=a,_.TextFieldAutoSize=h,_.TextFormat=l,_.Transform=c,_.InteractiveObjectTouchEvent=u},initJs:function(t){t.Event.ENTER_FRAME="enterFrame",t.Event.EXIT_FRAME="exitFrame"}};return _}),herlock.define("module/view_canvas/geom/Point",["lib/Class"],function(){var t=function(t,e){this.x=0,this.y=0,arguments.length>=1&&(this.x=t),arguments.length>=2&&(this.y=e)};return t.prototype=Object.create({},{add:{value:function(e){return new t(this.x+e.x,this.y+e.y)},writable:!0},subtract:{value:function(e){return new t(this.x-e.x,this.y-e.y)},writable:!0},clone:{value:function(){return new t(this.x,this.y)},writable:!0},equals:{value:function(t){return this.x===t.x&&this.y===t.y},writable:!0},normalize:{value:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);this.x=this.x/e*t,this.y=this.y/e*t},writable:!0},offset:{value:function(t){this.x+=t.x,this.y+=t.y},writable:!0},toString:{value:function(){return'[object Point x="'+this.x+'" y="'+this.y+'"]'},writable:!0}}),t}),herlock.define("module/view_canvas/geom/Rectangle",["lib/Class","./Point"],function(t,e){var i=function(){this.x=0,this.y=0,this.width=0,this.height=0;var t=arguments.length;t>0&&(this.x=arguments[0]),t>1&&(this.y=arguments[1]),t>2&&(this.width=arguments[2]),t>3&&(this.height=arguments[3])};return i.prototype=Object.create({},{top:{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t}},right:{get:function(){return this.x+this.width},set:function(t){this.width+=t-this.right}},bottom:{get:function(){return this.y+this.height},set:function(t){this.height+=t-this.bottom}},left:{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t}},topLeft:{get:function(){return new e(this.left,this.top)},set:function(t){this.left=t.x,this.top=t.y}},bottomRight:{get:function(){return new e(this.right,this.bottom)},set:function(t){this.right=t.x,this.bottom=t.y}},size:{get:function(){return new e(this.width,this.height)},set:function(t){this.width=t.x,this.height=t.y}},clone:{value:function(){return new i(this.x,this.y,this.width,this.height)},writable:!0},contains:{value:function(t,e){return t>=this.left&&this.right>=t&&e>=this.top&&this.bottom>=e},writable:!0},containsPoint:{value:function(t){return this.contains(t.x,t.y)},writable:!0},containsRect:{value:function(t){return this.top<=t.top&&t.bottom<=this.bottom&&this.left<=t.left&&t.right<=this.right},writable:!0},equals:{value:function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height},writable:!0},inflate:{value:function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},writable:!0},inflatePoint:{value:function(t){this.inflate(t.x,t.y)},writable:!0},intersects:{value:function(t){return this.top>t.bottom||this.left>t.right||this.right<t.left||this.bottom<t.top?!1:!0},writable:!0},intersection:{value:function(t){if(1!=this.intersects(t))return new i;var e,n,r,s;return e=this.top>t.top?this.top:t.top,n=this.right<t.right?this.right:t.right,r=this.bottom<t.bottom?this.bottom:t.bottom,s=this.left>t.left?this.left:t.left,new i(s,e,n-s,r-e)},writable:!0},isEmpty:{value:function(){return 0>=this.width||0>=this.height},writable:!0},offset:{value:function(t,e){this.x+=t,this.y+=e},writable:!0},offsetPoint:{value:function(t){this.offset(t.x,t.y)},writable:!0},setEmpty:{value:function(){this.x=0,this.y=0,this.width=0,this.height=0},writable:!0},union:{value:function(t){if(this.isEmpty()&&t.isEmpty())return new i;if(t.isEmpty())return this.clone();if(this.isEmpty())return t.clone();var e,n,r,s;return e=this.top<t.top?this.top:t.top,n=this.right>t.right?this.right:t.right,r=this.bottom>t.bottom?this.bottom:t.bottom,s=this.left<t.left?this.left:t.left,new i(s,e,n-s,r-e)},writable:!0},_set:{value:function(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n},writable:!0},toString:{value:function(){return'[object Rectangle x="'+this.x+'" y="'+this.y+'" width="'+this.width+'" height="'+this.height+'"]'},writable:!0}}),i}),herlock.define("module/view_canvas/geom/Matrix",["lib/Class","./Point","./Rectangle"],function(t,e,i){var n=Math.PI,r=function(t,e,i,n,r,s){var o,a=arguments.length;0===a?(o=this._values=[1,0,0,1,0,0],this._isInitialValue=!0):(o=this._values=[a>0?t:1,a>1?e:0,a>2?i:0,a>3?n:1,a>4?r:0,a>5?s:0],this._isInitialValue=1===o[0]&&0===o[1]&&0===o[2]&&1===o[3]&&0===o[4]&&0===o[5]),this._version=1e7*Math.random()<<0};return r.prototype=Object.create({},{a:{get:function(){return this._values[0]},set:function(t){this._values[0]=t,this._increment()}},b:{get:function(){return this._values[1]},set:function(t){this._values[1]=t,this._increment()}},c:{get:function(){return this._values[2]},set:function(t){this._values[2]=t,this._increment()}},d:{get:function(){return this._values[3]},set:function(t){this._values[3]=t,this._increment()}},tx:{get:function(){return this._values[4]},set:function(t){this._values[4]=t,this._increment()}},ty:{get:function(){return this._values[5]},set:function(t){this._values[5]=t,this._increment()}},_increment:{value:function(){this._version++,this._isInitialValue=!1},writable:!0},_getVersion:{value:function(){return this._version},writable:!0},isInitialValue:{value:function(){return this._isInitialValue},writable:!0},clone:{value:function(){var t=new r;return t._values=this._values.slice(),t._version=this._version,t._isInitialValue=this._isInitialValue,t},writable:!0},concat:{value:function(t){t.isInitialValue()||this._concat(t._values)},writable:!0},_concat:{value:function(t){if(this.isInitialValue())this._values=t;else{var e=this._values,i=t;this._values=[e[0]*i[0]+e[1]*i[2],e[0]*i[1]+e[1]*i[3],e[2]*i[0]+e[3]*i[2],e[2]*i[1]+e[3]*i[3],e[4]*i[0]+e[5]*i[2]+i[4],e[4]*i[1]+e[5]*i[3]+i[5]]}this._increment()},writable:!0},createBox:{value:function(){},writable:!0},createGradientBox:{value:function(){},writable:!0},deltaTransformPoint:{value:function(){},writable:!0},identity:{value:function(){this._values=[1,0,0,1,0,0],this._increment(),this._isInitialValue=!0},writable:!0},invert:{value:function(){var t=this.a*this.d-this.c*this.b;if(0!==t){var e=1/t,i=this.tx;this.tx=(this.c*this.ty-i*this.d)*e,this.ty=(i*this.b-this.a*this.ty)*e,this.c=-this.c*e,this.b=-this.b*e,i=this.a,this.a=this.d*e,this.d=i*e,this._increment()}},writable:!0},rotate:{value:function(t){var e=Math.cos(t),i=Math.sin(t);this._concat([e,i,-i,e,0,0])},writable:!0},scale:{value:function(t,e){this._concat([t,0,0,e,0,0])},writable:!0},transformPoint:{value:function(t){var i=this._values;return new e(t.x*i[0]+t.y*i[2]+1*i[4],t.x*i[1]+t.y*i[3]+1*i[5])},writable:!0},translate:{value:function(t,e){this._concat([1,0,0,1,t,e])},writable:!0},_getScaleX:{value:function(){return Math.sqrt(this.a*this.a+this.b*this.b)},writable:!0},_setScaleX:{value:function(t){this._increment();var e=this._getScaleX();if(0!==e){var i=t/e;this.a*=i,this.b*=i}else{var n=this._getSkewY_();this.a=Math.cos(n)*t,this.b=Math.sin(n)*t}},writable:!0},_getScaleY:{value:function(){return Math.sqrt(this.c*this.c+this.d*this.d)},writable:!0},_setScaleY:{value:function(t){this._increment();var e=this._getScaleY();if(0!==e){var i=t/e;this.c*=i,this.d*=i}else{var n=this._getSkewX_();this.c=-Math.sin(n)*t,this.d=Math.cos(n)*t}},writable:!0},_getSkewX:{value:function(){return this._getSkewX_()*(180/n)},writable:!0},_setSkewX:{value:function(t){this._setSkewX_(t*(n/180))},writable:!0},_getSkewY:{value:function(){return this._getSkewY_()*(180/n)},writable:!0},_setSkewY:{value:function(t){this._setSkewY_(t*(n/180))},writable:!0},_getRotation:{value:function(){return this._getSkewY_()*(180/n)},writable:!0},_setRotation:{value:function(t){this._setRotation_(t*(n/180))},writable:!0},_getX:{value:function(){return this.tx},writable:!0},_setX:{value:function(t){this.tx=t,this._increment()},writable:!0},_getY:{value:function(){return this.ty},writable:!0},_setY:{value:function(t){this.ty=t,this._increment()},writable:!0},_setRotation_:{value:function(t){var e=this._getSkewY_(),i=this._getSkewX_();this._setSkewX_(i+t-e),this._setSkewY_(t)},writable:!0},_getSkewX_:{value:function(){return Math.atan2(-this.c,this.d)},writable:!0},_setSkewX_:{value:function(t){var e=this._getScaleY();this.c=-e*Math.sin(t),this.d=e*Math.cos(t),this._increment()},writable:!0},_getSkewY_:{value:function(){return Math.atan2(this.b,this.a)},writable:!0},_setSkewY_:{value:function(t){var e=this._getScaleX();this.a=e*Math.cos(t),this.b=e*Math.sin(t),this._increment()},writable:!0},_calculateBoundsRect:{value:function(t){for(var n=[this.transformPoint(t.topLeft),this.transformPoint(new e(t.right,t.top)),this.transformPoint(new e(t.left,t.bottom)),this.transformPoint(t.bottomRight)],r=n[0].y,s=n[0].y,o=n[0].x,a=n[0].x,h=1;4>h;h++){var l=n[h];r>l.y&&(r=l.y),l.y>s&&(s=l.y),o>l.x&&(o=l.x),l.x>a&&(a=l.x)}return new i(o,r,a-o,s-r)},writable:!0},_equal:{value:function(t){for(var e=0;6>e;e++)if(this._values[e]!=t._values[e])return!1;return!0},writable:!0}}),r}),herlock.define("module/view_canvas/geom/ColorTransform",["lib/Class"],function(){function t(t,e,i){return t<<16|e<<8|i<<0}function e(t){return 255&t>>16}function i(t){return 255&t>>8}function n(t){return 255&t>>0}var r=0,s=1,o=2,a=3,h=function(t,e,i,n,r,s,o,a){var h=arguments.length;return 0===h?(this._version=Math.floor(1e7*Math.random()),this.__isInitialValue=!0,this._multiplier=[1,1,1,1],this._offset=[0,0,0,0],void 0):(t=h>0?t:1,e=h>1?e:1,i=h>2?i:1,n=h>3?n:1,r=h>4?r:0,s=h>5?s:0,o=h>6?o:0,a=h>7?a:0,this._version=Math.floor(1e7*Math.random()),this.__isInitialValue=1==t&&1==e&&1==i&&1==n&&0==r&&0==s&&0==o&&0==a,this._multiplier=[t,e,i,n],this._offset=[r,s,o,a],void 0)};return h.prototype=Object.create({},{_increment:{writable:!0,value:function(){this._version++,this.__isInitialValue=!1}},_getVersion:{writable:!0,value:function(){return this._version}},_isInitialValue:{writable:!0,value:function(){return this.__isInitialValue}},color:{get:function(){return t(this._offset[r],this._offset[s],this._offset[o])},set:function(t){this._multiplier[r]=1,this._multiplier[s]=1,this._multiplier[o]=1,this._offset[r]=e(t),this._offset[s]=i(t),this._offset[o]=n(t),this._increment()}},alphaMultiplier:{get:function(){return this._multiplier[a]},set:function(t){this._multiplier[a]=t,this._increment()}},redMultiplier:{get:function(){return this._multiplier[r]},set:function(t){this._multiplier[r]=t,this._increment()}},greenMultiplier:{get:function(){return this._multiplier[s]},set:function(t){this._multiplier[s]=t,this._increment()}},blueMultiplier:{get:function(){return this._multiplier[o]},set:function(t){this._multiplier[o]=t,this._increment()}},alphaOffset:{get:function(){return this._offset[a]},set:function(t){this._offset[a]=t,this._increment()}},redOffset:{get:function(){return this._offset[r]},set:function(t){this._offset[r]=t,this._increment()}},greenOffset:{get:function(){return this._offset[s]},set:function(t){this._offset[s]=t,this._increment()}},blueOffset:{get:function(){return this._offset[o]},set:function(t){this._offset[o]=t,this._increment()}},clone:{writable:!0,value:function(){var t=new h(this._multiplier[r],this._multiplier[s],this._multiplier[o],this._multiplier[a],this._offset[r],this._offset[s],this._offset[o],this._offset[a]);return t._version=this._version,t}},concat:{writable:!0,value:function(t){if(!t._isInitialValue())if(t._isInitialValue()){var e=t._multiplier,i=t._offset;this._multiplier[r]=e[r],this._multiplier[s]=e[s],this._multiplier[o]=e[o],this._multiplier[a]=e[a],this._offset[r]=i[r],this._offset[s]=i[s],this._offset[o]=i[o],this._offset[a]=i[a],this._increment()}else this._concat(t._multiplier,t._offset)}},_concat:{writable:!0,value:function(t,e){this._multiplier[r]*=t[r],this._multiplier[s]*=t[s],this._multiplier[o]*=t[o],this._multiplier[a]*=t[a],this._offset[r]=this._offset[r]*t[r]+e[r],this._offset[s]=this._offset[s]*t[s]+e[s],this._offset[o]=this._offset[o]*t[o]+e[o],this._offset[a]=this._offset[a]*t[a]+e[a],this._increment()}},_isAlphaTransform:{writable:!0,value:function(){return 1!=this._multiplier[a]&&1==this._multiplier[r]&&1==this._multiplier[s]&&1==this._multiplier[o]&&0==this._offset[r]&&0==this._offset[s]&&0==this._offset[o]&&0==this._offset[a]}},_isColorTransform:{writable:!0,value:function(){return!this._isInitialValue()&&!this._isAlphaTransform()}},_getValueArray:{writable:!0,value:function(){var t=[];return t[0]=this._multiplier[r],t[1]=this._multiplier[s],t[2]=this._multiplier[o],t[3]=this._multiplier[a],t[4]=this._offset[r]/255,t[5]=this._offset[s]/255,t[6]=this._offset[o]/255,t[7]=this._offset[a]/255,t}}}),h}),herlock.define("module/view_canvas/geom/geom",["./Point","./Rectangle","./Matrix","./ColorTransform"],function(t,e,i,n){var r={installTo:function(r){r.Point=t,r.Rectangle=e,r.Matrix=i,r.ColorTransform=n},initJs:function(){}};return r}),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame,function(){var t=document.createElement("div").style,e={transform:"webkitTransform"in t?"webkitTransform":"MozTransform"in t?"MozTransform":"transform",transformOrigin:"webkitTransformOrigin"in t?"webkitTransformOrigin":"MozTransformOrigin"in t?"MozTransformOrigin":"transformOrigin"};if("webkitTransform"in t?window.__setTransform=function(t,e){t.webkitTransform=e}:"MozTransform"in t?window.__setTransform=function(t,e){t.MozTransform=e}:"transform"in t&&(window.__setTransform=function(t,e){t.transform=e}),!("transformOrigin"in t)){var i={};for(var n in e)(function(t,e){i[t]={get:function(){return this[e]},set:function(t){this[e]=t}}})(n,e[n]);Object.defineProperties(CSSStyleDeclaration.prototype,i)}}(),herlock.define("module/view_canvas/NJView",["lib/Class","module/NJModule","./window/window","./layer/Layer","./image/Image","./flash/flash","./geom/geom","./geom/Rectangle","module/view/touch/TouchEventInfo","./flash/internal/renderer/CanvasRenderingSystem"],function(t,e,i,n,r,s,o,a,h,l){var c=t(e,function(t,e){t.constructor=function(t,i,n){e.constructor.apply(this,arguments),l.container=this._container=t,l.width=this._width=i,l.height=this._height=n,this._layers=[];var r=this;requestAnimationFrame(function(){r._onDrawFrame(),requestAnimationFrame(arguments.callee)});var s=!1,o=function(t){var e,i=!0;switch(t.type){case"mousedown":s=!0,e=h.DOWN;break;case"mousemove":if(!s)return;e=h.MOVE;break;case"mouseup":s=!1,e=h.UP,i=!1;break;case"mouseleave":if(!s)return;s=!1,e=h.CANCEL,i=!1}var n=new h(e);if(touchEnabled||-1===t.type.indexOf("mouse")){if(-1!==t.type.indexOf("touch")){touchEnabled=!0;for(var o=t.touches,a=t.changedTouches,l=0;o.length>l;l++){var c,u,_=o[l];if(c=_.clientX-t.currentTarget.offsetLeft,u=_.clientY-t.currentTarget.offsetTop,""!==this.style.transform){var f,d={x:c,y:u},g=this.style.transform,m=[];-1!==g.indexOf("matrix")&&g.split(",").forEach(function(t){m.push(parseFloat(t))}),-1!==g.indexOf("scale")&&(f=g.split("scale(")[1].split(","))&&(m=[parseFloat(f[0]),0,0,parseFloat(f[1]),0,0]),c=d.x*m[0]+d.y*m[2]+1*m[4],u=d.x*m[1]+d.y*m[3]+1*m[5]}n.addTouchPoint(_.identifier,c,u,!1,!0)}for(var l=0;a.length>l;l++){var c,u,_=a[l];if(c=_.clientX-t.currentTarget.offsetLeft,u=_.clientY-t.currentTarget.offsetTop,""!==this.style.transform){var f,d={x:c,y:u},g=this.style.transform,m=[];
-1!==g.indexOf("matrix")&&g.split(",").forEach(function(t){m.push(parseFloat(t))}),-1!==g.indexOf("scale")&&(f=g.split("scale(")[1].split(","))&&(m=[parseFloat(f[0]),0,0,parseFloat(f[1]),0,0]),c=d.x*m[0]+d.y*m[2]+1*m[4],u=d.x*m[1]+d.y*m[3]+1*m[5]}n.addTouchPoint(_.identifier,c,u,!0,i)}}}else{var c,u;if(c=t.clientX-t.currentTarget.offsetLeft,u=t.clientY-t.currentTarget.offsetTop,""!==this.style.transform){var f,d={x:c,y:u},g=this.style.transform,m=[];-1!==g.indexOf("matrix")&&g.split(",").forEach(function(t){m.push(parseFloat(t))}),-1!==g.indexOf("scale")&&(f=g.split("scale(")[1].split(","))&&(m=[parseFloat(f[0]),0,0,parseFloat(f[1]),0,0]),c=d.x*m[0]+d.y*m[2]+1*m[4],u=d.x*m[1]+d.y*m[3]+1*m[5]}n.addTouchPoint("mouse",c,u,!0,i)}r._notifyTouch(n)};this._container.addEventListener("touchstart",o),this._container.addEventListener("touchend",o),this._container.addEventListener("touchmove",o),this._container.addEventListener("touchcancel",o),this._container.addEventListener("mousemove",o),this._container.addEventListener("mouseup",o),this._container.addEventListener("mousedown",o),this._container.addEventListener("mouseleave",o)},t.getName=function(){return"View"},t.installTo=function(t){i.installTo(t,this),t.Layer=n,t.Image=r,s.installTo(t),o.installTo(t)},t.initJs=function(t){i.initJs(t),s.initJs(t),o.initJs(t)},t.start=function(){},t.reset=function(){},t.addLayer=function(t){return this.addLayerAt(t,this._layers.length)},t.addLayerAt=function(t,e){var i=t.isInstanceOf(n)?t:new n(t);return-1!=this.getLayerIndex(i)&&this.removeLayer(i),this._layers.splice(e,0,i),i._addedTo(this),i},t.getLayerAt=function(t){return this._layers[t]},t.getLayerIndex=function(t){return this._layers.indexOf(t)},t.removeLayer=function(t){return this.removeLayerAt(this._layers.indexOf(t))},t.removeLayerAt=function(t){var e=this.getLayerAt(t);return this._layers.splice(t,1),e},t.getViewWidth=function(){return this._width},t.getViewHeight=function(){return this._height},t.getViewTop=function(){return 0},t.getViewLeft=function(){return 0},t._onDrawFrame=function(){var t=this._glPrepare();this._glRender(t),this._notifyDrawFrame()},t._glPrepare=function(){if(!(0>=this._layers.length)){for(var t=this._layers.length,e=[],i=0;t>i;i++){var n=this._layers[i]._glPrepare();n&&e.push(n)}return e}},t._glRender=function(t){if(!(0>=this._layers.length)){for(var e=t.length,i=0;e>i;i++)t[i].processData();for(var i=0;e>i;i++){var n=t[i];n.render()}}},t._notifyDrawFrame=function(){for(var t in this._layers)this._layers[t]._notifyDrawFrame()},t._notifyTouch=function(t){for(var e=this._layers.slice(),i=e.length,n=0;i>n;n++)e[n]._notifyTouch(t)}});return c}),herlock.define("module/google_analytics/NJGoogleAnalytics",["lib/Class","module/NJModule"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.installTo=function(){},t.initJs=function(t){t.googleAnalytics=new n}}),n=t(Object,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.init=function(){},t.screen=function(){},t.event=function(){}});return i}),herlock.define("module/webview/NJWebView",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(t,e,i){var n=t(e,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._container=t},t.installTo=function(){},t.initJs=function(t){t.webview=new r(this)}}),r=t(i,function(t,e){t.constructor=function(t){e.constructor.apply(this,arguments),this._module=t,this._iframe=null,this._layout=new Rectangle,this._iframe=this._createIframe(),document.head.appendChild(this._iframe)},t._createIframe=function(){var t=document.createElement("iframe");return t.setAttribute("seamless",!0),t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width=this._layout.width+"px",t.style.height=this._layout.height+"px",t.style.border="0",t},t.load=function(t){this._iframe&&this._iframe.parentNode||(this._iframe=this._createIframe(),document.head.appendChild(this._iframe));var e=this;if(this._iframe.src===t)return setTimeout(function(){e._dispatchEventAndCallHandler(new Event("load"))},10),void 0;var i=function(){e._iframe.removeEventListener("load",i),e._dispatchEventAndCallHandler(new Event("load"))};this._iframe.addEventListener("load",i),this._iframe.src=t},t.show=function(){this._module._container.appendChild(this._iframe)},t.hide=function(){this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe)},t.goForward=function(){},t.goBack=function(){},t.reload=function(){},t.getLayout=function(){return this._layout},t.setLayout=function(t){this._iframe.style.transform="matrix3d( 1, 0, 0, 0,  0, 1, 0, 0,  0, 0, 1, 0,  "+t.x+","+t.y+", 0, 1)",this._layout.width!=t.width&&(this._iframe.style.width=t.width+"px"),this._layout.height!=t.height&&(this._iframe.style.height=t.height+"px"),this._layout=t},t.sendMessage=function(){},t.evalJS=function(){}});return n}),herlock.define("module/xhr/NJXhr",["lib/Class","module/NJModule","lib/URL"],function(t,e,i){var n=XMLHttpRequest.prototype.open,r=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.installTo=function(){XMLHttpRequest.prototype.open=function(t,e){var r=new i(e),s=window.__herlock_ctx;e=""===r.host?s._rootPath+r:""+r,arguments[1]=e,n.apply(this,arguments)}},t.initJs=function(){}});return r}),herlock.define("module/sound/audio/Audio",["lib/Class","module/common/event/EventDispatcher","lib/URL"],function(t,e,i){var n=t(e,function(t,e){t.constructor=function(t,i){e.constructor.apply(this,arguments),this._src="",this._type=i||n.MUSIC,this._volume=1,this._playing=!1,this._loop=!1,t&&(this.src=t)},t.src={get:function(){return this._src},set:function(t){this._src=t;var e=new i(t);this._audio=null;var n=document.createElement("audio"),r=window.__herlock_ctx,s=this;n.oncanplaythrough=function(){s._audio=n,s._dispatchEventAndCallHandler(new Event("load")),s._audio.volume=s._volume,s._audio.loop=s._loop,s._playing&&s.play()},n.src=""===e.host?r._rootPath+e:""+e}},t.type={get:function(){return this._type}},t.complete={get:function(){return!!this._audio}},t.volume={get:function(){return this._volume},set:function(t){this._volume=t,this._audio&&(this._audio.volume=t)}},t.loop={get:function(){return this._loop},set:function(t){this._loop=t,this._audio&&(this._audio.loop=t)}},t.play=function(){this._playing=!0,this._audio&&(this._audio.pause(),this._audio.currentTime=0,this._audio.play())},t.pause=function(){this._playing=!1,this._audio&&this._audio.pause()},t.resume=function(){this._playing=!0,this._audio&&(this._audio.pause(),this._audio.play())},t.stop=function(){this._playing=!1,this._audio&&(this._audio.pause(),this._audio.currentTime=0)},t.clone=function(){return new n(this.src,this.type)}});return n.MUSIC="music",n.SE="se",n}),herlock.define("module/sound/NJSound",["lib/Class","module/NJModule","lib/URL","./audio/Audio"],function(t,e,i,n){var r=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.installTo=function(t){t.Audio=n},t.initJs=function(){}});return r}),herlock.define("module/nativeui/NJNativeUI",["lib/Class","module/NJModule"],function(t,e){var i=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.getName=function(){return"NativeUI"},t.installTo=function(){},t.initJs=function(t){var e=window.alert;t.alert=function(t,i){if(!i)throw Error("ArgumentError! alert( String, Function() );");setTimeout(function(){e(t),i()},10)};var i=window.confirm;t.confirm=function(t,e){if(!e)throw Error("ArgumentError! confirm( String, Function( boolean ) );");setTimeout(function(){e(i(t))},10)};var n=window.prompt;t.prompt=function(t,e,i){if(!i)throw Error("ArgumentError! prompt( String, String, Function( String ) );");setTimeout(function(){i(n(t,e))},10)},t.picker=function(t,e,i){if(!i)throw Error("ArgumentError! picker( Array, Number, Function( String ) );");setTimeout(function(){console.log("NJNativeUI.picker ... TODO picker UI"),i(t[e])},10)}},t.start=function(){e.start.call(this)},t.reset=function(){}});return i}),herlock.define("module/local_notification/NJLocalNotification",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(t,e,i){var n=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.getName=function(){return"LocalNotification"},t.installTo=function(t){t.LocalNotification=r},t.initJs=function(t){t.localNotification=new r(this)},t.reset=function(){}}),r=t(i,function(t,e){t.constructor=function(t){e.constructor.call(this),this._module=t},t.enable=function(){},t.cancelAll=function(){},t.schedule=function(){}});return n}),herlock.define("module/push/NJPush",["lib/Class","module/NJModule","module/common/event/EventDispatcher"],function(t,e,i){var n=t(e,function(t,e){t.constructor=function(){e.constructor.apply(this,arguments)},t.getName=function(){return"Push"},t.installTo=function(t){t.PushNotification=r},t.initJs=function(t){t.pushNotification=new r(this)},t.reset=function(){}}),r=t(i,function(t,e){t.constructor=function(t){e.constructor.call(this),this._module=t},t.generateDeviceToken=function(){return console.log("PushNotification.generateDeviceToken ... dummy"),null}});return n}),herlock.define("Player",["lib/Class","NativeJS","module/script/NJScript","module/app/NJApp","module/location/NJLocation","module/view/NJView","module/view_css/NJView","module/view_canvas/NJView","module/google_analytics/NJGoogleAnalytics","module/webview/NJWebView","module/xhr/NJXhr","module/sound/NJSound","module/nativeui/NJNativeUI","module/local_notification/NJLocalNotification","module/push/NJPush"],function(t,e,i,n,r,s,o,a,h,l,c,u,_,f,d){var g=t(Object,function(t){t.constructor=function(t,g){if(g=g||{},!t&&window.parent)try{var m=window.parent.herlock.getParams(),p=window.parent.location.href.split("?")[0].split("#")[0];t=p.substr(0,p.lastIndexOf("/")+1)+m.mainJsURL;for(var v in m.options)g[v]=m.options[v]}catch(x){}this._container=g.container,this._container?(g.width=g.width||this._container.width,g.height=g.height||this._container.height):(this._container=document.createElement("div"),this._container.id="herlock_player",this._container.width=g.width,this._container.height=g.height,this._container.style.overflow="hidden",document.body.appendChild(this._container));var w=this._njs=new e,b=null;w.registerModule(new i),w.registerModule(b=new n),w.registerModule(new r),g.useViewCSS?w.registerModule(new o(this._container,g.width||innerWidth,g.height||innerHeight)):g.useViewCanvas?w.registerModule(new a(this._container,g.width||innerWidth,g.height||innerHeight)):w.registerModule(new s(this._container,g.width||innerWidth,g.height||innerHeight)),w.registerModule(new h),w.registerModule(new l(this._container)),w.registerModule(new c),w.registerModule(new u),w.registerModule(new _),w.registerModule(new f),w.registerModule(new d),t&&w.loadURL(t)}});return g}),herlock.require.config({baseUrl:"../"}),herlock.require(["Player"],function(){console.log("required")}),herlock.define("grunt/compile_config",function(){});